<!--
Copyright (c) 2020 Nekokatt
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<!--
Copyright (c) 2020 Nekokatt
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>hikari.impl.entity_factory API documentation</title>
<meta name="description" content="Basic implementation of an entity factory for general bots and HTTP apps." />
<meta property="og:title" content="hikari.impl.entity_factory module documentation" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://hikari-py.github.io/hikari/logo.png" />
<meta property="og:description" content="A Discord Bot framework for modern Python and asyncio built on good intentions" />
<meta property="theme-color" content="#ff029a" />
<link rel="shortcut icon" type="image/png" href="https://hikari-py.github.io/hikari/logo.png"/>
<!--<script async src="https://cse.google.com/cse.js?cx=017837193012385208679:pey8ky8gdqw"></script>
<style>.gsc-control-cse {padding:0 !important;margin-top:1em}</style>-->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css" rel="stylesheet"/>
<style>
* {
scrollbar-color: #202324 #454a4d;
scroll-behavior: smooth;
}
img#logo {
border-radius: 15px;
width: 30px;
height: 30px;
margin-right: 0.5em;
}
small.smaller {
font-size: 0.75em;
}
body {
background-color: #181A1B;
color: #C9C5C0;
}
h1 {
margin-top: 3rem;
}
h2 {
margin-top: 1.75rem;
margin-bottom: 1em;
}
h3 {
margin-top: 1.25rem;
}
h4 {
margin-top: 1rem;
}
.nav-section {
margin-top: 2em;
}
.monospaced {
font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
a.sidebar-nav-pill,
a.sidebar-nav-pill:active,
a.sidebar-nav-pill:hover {
color: #BDB7AF;
}
.module-source > details > pre {
display: block;
overflow-x: auto;
overflow-y: auto;
max-height: 600px;
font-size: 0.8em;
}
a {
color: #DE4F91;
}
a:hover {
color: #64B1F2;
}
.jumbotron {
background-color: #232627;
}
.breadcrumb-item.inactive > a {
color: #d264d0 !important;
}
.breadcrumb-item.active > a {
color: #de4f91 !important;
}
.breadcrumb-item+.breadcrumb-item::before {
content: ".";
}
.module-breadcrumb {
padding-left: 0 !important;
background-color: #232627;
}
ul.nested {
margin-left: 1em;
}
h2#parameters::after {
margin-left: 2em;
}
dt {
margin-left: 2em;
}
dd {
margin-left: 4em;
}
dl.no-nest > dt {
margin-left: 0em;
}
dl.no-nest > dd {
margin-left: 2em;
}
dl.root {
margin-bottom: 2em;
}
.definition {
display: block;
margin-bottom: 8em !important;
}
.definition .row {
display: block;
margin-bottom: 4em !important;
}
.definition h2 {
font-size: 1em;
font-weight: bolder;
}
.sep {
height: 2em;
}
code {
color: #DB61D9;
}
code .active {
color: #e83e8c;
}
code a {
color: #E94A93;
}
a.dotted:hover, abbr:hover {
text-decoration: underline #9E9689 dotted !important;
}
a.dotted, abbr {
text-decoration: none !important;
}
.gsc-search-box, .gsc-search-box-tools, .gsc-control-cse {
background: none !important;
border: none !important;
}
.gsc-search-button-v2, .gsc-search-button-v2:hover, .gsc-search-button-v2:focus {
color: var(--success) !important;
border-color: var(--success) !important;
background: none !important;
padding: 6px 32px !important;
font-size: inherit !important;
}
.gsc-search-button-v2 > svg {
fill: var(--success) !important;
}
.gsc-input-box {
border-radius: 3px;
}
.gsc-control-cse {
width: 300px !important;
margin-top: 0 !important;
}
.gsc-control-cse .gsc-control-cse-en {
margin-top: 0 !important;
}
.bg-dark {
background-color: #2C2F31 !important;
}
.text-muted {
color: #9E9689 !important;
}
.alert-primary {
color: #7CC3FF;
background-color: #262A2B;
border-color: #003B7B;
}
.alert-secondary {
color: #C2BCB4;
background-color: #282B2C;
border-color: #3B4042;
}
.alert-success {
color: #99E6AB;
background-color: #1A3E29;
border-color: #255A32;
}
.alert-info {
color: #8EE3F1;
background-color: #143B43;
border-color: #1E5961;
}
.alert-warning {
color: #FBD770;
background-color: #513E00;
border-color: #7B5C00;
}
.alert-danger {
color: rgb(225, 134, 143);
background-color: rgb(67, 12, 17);
border-color: rgb(104, 18, 27);
}
mark {
background-color: #333333;
border-radius: 0.1em;
color: #DB61D9;
}
</style>
<script async src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_CHTML'></script>
</head>
<body>
<!-- body.mako -->
<nav id="main-nav" class="navbar navbar-dark navbar-expand-lg bg-dark">
<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"/>
</button>
<a class="navbar-brand" href="https://github.com/hikari-py/hikari"><img class="d-inline-block align-top" src="https://hikari-py.github.io/hikari/logo.png" id="logo" alt="hikari logo" loading="lazy"/>Hikari <small>v2.0.0.dev92</small></a>
<div class="collapse navbar-collapse" id="navbarNavDropdown">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="/hikari/index.html">Home</a></li>
<li class="nav-item active"><a class="nav-link" href="/hikari/hikari/index.html">Documentation</a></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/hikari-py/hikari">GitHub</a></li>
<li class="nav-item"><a class="nav-link" href="https://pypi.org/project/hikari">PyPI</a></li>
<li class="nav-item"><a class="nav-link" href="https://discord.gg/Jx4cNGG">Discord Server</a></li>
</ul>
<form class="form-inline" >
<input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" id="lunr-search"/>
<button class="btn btn-outline-success my-2 my-sm-0" type="submit">&gt;</button>
</form>
</div>
</nav>
<div class="jumbotron jumbotron-fluid">
<div class="container">
<h1 class="display-4"><code>
<nav aria-label="breadcrumb">
<ol class="breadcrumb module-breadcrumb">
<li class="breadcrumb-item inactive"><a title="hikari -- A sane Python framework for writing modern Discord bots …" href="../index.html"
>hikari</a></li>
<li class="breadcrumb-item inactive"><a title="hikari.impl -- Basic implementations of application components …" href="index.html"
>impl</a></li>
<li class="breadcrumb-item active"><a href="#">entity_factory</a></li>
</ol>
</nav>
</code></h1>
<p class="lead"><p>Basic implementation of an entity factory for general bots and HTTP apps.</p></p>
</div>
</div>
<div class="container-xl">
<div class="row">
<div class="d-md-none d-lg-block col-lg-5 col-xl-4">
<!--<nav class="nav" id="content-nav">-->
<h3>This module</h3>
<ul class="list-unstyled text-truncate">
<li class="monospaced">
<small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="EntityFactoryImpl -- Standard implementation for a serializer/deserializer …" href="#hikari.impl.entity_factory.EntityFactoryImpl"
>EntityFactoryImpl</a>
<ul class="list-unstyled nested text-truncate">
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_application -- Parse a raw payload from Discord into an application object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application"
>deserialize_application</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_audit_log -- Parse a raw payload from Discord into an audit log object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_audit_log"
>deserialize_audit_log</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_channel -- Parse a raw payload from Discord into a channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel"
>deserialize_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_channel_follow -- Parse a raw payload from Discord into a channel follow object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follow"
>deserialize_channel_follow</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_custom_emoji -- Parse a raw payload from Discord into a custom emoji object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_custom_emoji"
>deserialize_custom_emoji</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_dm -- Parse a raw payload from Discord into a DM channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_dm"
>deserialize_dm</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_embed -- Parse a raw payload from Discord into an embed object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_embed"
>deserialize_embed</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_emoji -- Parse a raw payload from Discord into an emoji object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_emoji"
>deserialize_emoji</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_gateway_bot -- Parse a raw payload from Discord into a gateway bot object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_bot"
>deserialize_gateway_bot</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_gateway_guild -- Parse a raw payload from Discord into a guild object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_guild"
>deserialize_gateway_guild</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_group_dm -- Parse a raw payload from Discord into a group DM channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_group_dm"
>deserialize_group_dm</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_category -- Parse a raw payload from Discord into a guild category object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_category"
>deserialize_guild_category</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_member_ban -- Parse a raw payload from Discord into a guild member ban object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_member_ban"
>deserialize_guild_member_ban</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_news_channel -- Parse a raw payload from Discord into a guild news channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_news_channel"
>deserialize_guild_news_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_preview -- Parse a raw payload from Discord into a guild preview object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_preview"
>deserialize_guild_preview</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_store_channel -- Parse a raw payload from Discord into a guild store channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_store_channel"
>deserialize_guild_store_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_text_channel -- Parse a raw payload from Discord into a guild text channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_text_channel"
>deserialize_guild_text_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_voice_channel -- Parse a raw payload from Discord into a guild voice channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_voice_channel"
>deserialize_guild_voice_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_widget -- Parse a raw payload from Discord into a guild widget object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_widget"
>deserialize_guild_widget</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_integration -- Parse a raw payload from Discord into an integration object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_integration"
>deserialize_integration</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_invite -- Parse a raw payload from Discord into an invite object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite"
>deserialize_invite</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_invite_with_metadata -- Parse a raw payload from Discord into a invite with metadata object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite_with_metadata"
>deserialize_invite_with_metadata</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_known_custom_emoji -- Parse a raw payload from Discord into a known custom emoji object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_known_custom_emoji"
>deserialize_known_custom_emoji</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_member -- Parse a raw payload from Discord into a member object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member"
>deserialize_member</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_member_presence -- Parse a raw payload from Discord into a member presence object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member_presence"
>deserialize_member_presence</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_message -- Parse a raw payload from Discord into a message object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_message"
>deserialize_message</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_my_user -- Parse a raw payload from Discord into a user object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_my_user"
>deserialize_my_user</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_own_connection -- Parse a raw payload from Discord into an own connection object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_connection"
>deserialize_own_connection</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_own_guild -- Parse a raw payload from Discord into an own guild object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_guild"
>deserialize_own_guild</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_channel -- Parse a raw payload from Discord into a partial channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_channel"
>deserialize_partial_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_integration -- Parse a raw payload from Discord into a partial integration object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_integration"
>deserialize_partial_integration</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_message -- Parse a raw payload from Discord into a partial message object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_message"
>deserialize_partial_message</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_permission_overwrite -- Parse a raw payload from Discord into a permission overwrite object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_permission_overwrite"
>deserialize_permission_overwrite</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_rest_guild -- Parse a raw payload from Discord into a guild object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_rest_guild"
>deserialize_rest_guild</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_role -- Parse a raw payload from Discord into a role object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_role"
>deserialize_role</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_unicode_emoji -- Parse a raw payload from Discord into a unicode emoji object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_unicode_emoji"
>deserialize_unicode_emoji</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_user -- Parse a raw payload from Discord into a user object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_user"
>deserialize_user</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_vanity_url -- Parse a raw payload from Discord into a vanity url object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_vanity_url"
>deserialize_vanity_url</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_voice_region -- Parse a raw payload from Discord into a voice region object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_region"
>deserialize_voice_region</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_voice_state -- Parse a raw payload from Discord into a voice state object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_state"
>deserialize_voice_state</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_webhook -- Parse a raw payload from Discord into a webhook object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_webhook"
>deserialize_webhook</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="serialize_embed -- Serialize an embed object to a json serializable dict …" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_embed"
>serialize_embed</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="serialize_permission_overwrite -- Serialize a permission overwrite object to a json serializable dict …" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_permission_overwrite"
>serialize_permission_overwrite</a>
</li>
<br />
</ul>
</li>
</ul>
<!--</nav>-->
</div>
<div class="col-xs-12 col-lg-7 col-xl-8">
<div class="row">
<div class="col module-source">
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L0-L1850" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
# cython: language_level=3
# Copyright (c) 2020 Nekokatt
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the &#34;Software&#34;), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED &#34;AS IS&#34;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
&#34;&#34;&#34;Basic implementation of an entity factory for general bots and HTTP apps.&#34;&#34;&#34;

from __future__ import annotations

__all__: typing.List[str] = [&#34;EntityFactoryImpl&#34;]

import datetime
import typing

import attr

from hikari import applications as application_models
from hikari import audit_logs as audit_log_models
from hikari import channels as channel_models
from hikari import colors as color_models
from hikari import embeds as embed_models
from hikari import emojis as emoji_models
from hikari import files
from hikari import guilds as guild_models
from hikari import invites as invite_models
from hikari import messages as message_models
from hikari import permissions as permission_models
from hikari import presences as presence_models
from hikari import sessions as gateway_models
from hikari import snowflakes
from hikari import traits
from hikari import undefined
from hikari import users as user_models
from hikari import voices as voice_models
from hikari import webhooks as webhook_models
from hikari.api import entity_factory
from hikari.internal import attr_extensions
from hikari.internal import data_binding
from hikari.internal import time

_DEFAULT_MAX_PRESENCES: typing.Final[int] = 25000


def _deserialize_seconds_timedelta(seconds: typing.Union[str, int]) -&gt; datetime.timedelta:
    return datetime.timedelta(seconds=int(seconds))


def _deserialize_day_timedelta(days: typing.Union[str, int]) -&gt; datetime.timedelta:
    return datetime.timedelta(days=int(days))


def _deserialize_max_uses(age: int) -&gt; typing.Optional[int]:
    return age if age &gt; 0 else None


def _deserialize_max_age(seconds: int) -&gt; typing.Optional[datetime.timedelta]:
    return datetime.timedelta(seconds=seconds) if seconds &gt; 0 else None


@attr_extensions.with_copy
@attr.s(init=True, kw_only=True, repr=False, slots=True, weakref_slot=False)
class _PartialGuildFields:
    id: snowflakes.Snowflake = attr.ib()
    name: str = attr.ib()
    icon_hash: str = attr.ib()
    features: typing.Sequence[guild_models.GuildFeatureish] = attr.ib()


@attr_extensions.with_copy
@attr.s(init=True, kw_only=True, repr=False, slots=True, weakref_slot=False)
class _GuildChannelFields:
    id: snowflakes.Snowflake = attr.ib()
    name: typing.Optional[str] = attr.ib()
    type: typing.Union[channel_models.ChannelType, int] = attr.ib()
    guild_id: snowflakes.Snowflake = attr.ib()
    position: int = attr.ib()
    permission_overwrites: typing.Mapping[snowflakes.Snowflake, channel_models.PermissionOverwrite] = attr.ib()
    is_nsfw: typing.Optional[bool] = attr.ib()
    parent_id: typing.Optional[snowflakes.Snowflake] = attr.ib()


@attr_extensions.with_copy
@attr.s(init=True, kw_only=True, repr=False, slots=True, weakref_slot=False)
class _IntegrationFields:
    id: snowflakes.Snowflake = attr.ib()
    name: str = attr.ib()
    type: str = attr.ib()
    account: guild_models.IntegrationAccount = attr.ib()


@attr_extensions.with_copy
@attr.s(init=True, kw_only=True, repr=False, slots=True, weakref_slot=False)
class _GuildFields(_PartialGuildFields):
    splash_hash: typing.Optional[str] = attr.ib()
    discovery_splash_hash: typing.Optional[str] = attr.ib()
    owner_id: snowflakes.Snowflake = attr.ib()
    region: str = attr.ib()
    afk_channel_id: typing.Optional[snowflakes.Snowflake] = attr.ib()
    afk_timeout: datetime.timedelta = attr.ib()
    verification_level: typing.Union[guild_models.GuildVerificationLevel, int] = attr.ib()
    default_message_notifications: typing.Union[guild_models.GuildMessageNotificationsLevel, int] = attr.ib()
    explicit_content_filter: typing.Union[guild_models.GuildVerificationLevel, int] = attr.ib()
    mfa_level: typing.Union[guild_models.GuildMFALevel, int] = attr.ib()
    application_id: typing.Optional[snowflakes.Snowflake] = attr.ib()
    widget_channel_id: typing.Optional[snowflakes.Snowflake] = attr.ib()
    system_channel_id: typing.Optional[snowflakes.Snowflake] = attr.ib()
    is_widget_enabled: typing.Optional[bool] = attr.ib()
    system_channel_flags: guild_models.GuildSystemChannelFlag = attr.ib()
    rules_channel_id: typing.Optional[snowflakes.Snowflake] = attr.ib()
    max_video_channel_users: typing.Optional[int] = attr.ib()
    vanity_url_code: typing.Optional[str] = attr.ib()
    description: typing.Optional[str] = attr.ib()
    banner_hash: typing.Optional[str] = attr.ib()
    premium_tier: typing.Union[guild_models.GuildPremiumTier, int] = attr.ib()
    premium_subscription_count: typing.Optional[int] = attr.ib()
    preferred_locale: str = attr.ib()
    public_updates_channel_id: typing.Optional[snowflakes.Snowflake] = attr.ib()


@attr_extensions.with_copy
@attr.s(init=True, kw_only=True, repr=False, slots=True, weakref_slot=False)
class _InviteFields:
    code: str = attr.ib()
    guild: typing.Optional[invite_models.InviteGuild] = attr.ib()
    guild_id: typing.Optional[snowflakes.Snowflake] = attr.ib()
    channel: typing.Optional[channel_models.PartialChannel] = attr.ib()
    channel_id: snowflakes.Snowflake = attr.ib()
    inviter: typing.Optional[user_models.User] = attr.ib()
    target_user: typing.Optional[user_models.User] = attr.ib()
    target_user_type: typing.Union[invite_models.TargetUserType, int, None] = attr.ib()
    approximate_active_member_count: typing.Optional[int] = attr.ib()
    approximate_member_count: typing.Optional[int] = attr.ib()


@attr_extensions.with_copy
@attr.s(init=True, kw_only=True, repr=False, slots=True, weakref_slot=False)
class _UserFields:
    id: snowflakes.Snowflake = attr.ib()
    discriminator: str = attr.ib()
    username: str = attr.ib()
    avatar_hash: str = attr.ib()
    is_bot: bool = attr.ib()
    is_system: bool = attr.ib()


class EntityFactoryImpl(entity_factory.EntityFactory):
    &#34;&#34;&#34;Standard implementation for a serializer/deserializer.

    This will convert objects to/from JSON compatible representations.
    &#34;&#34;&#34;

    __slots__: typing.Sequence[str] = (
        &#34;_app&#34;,
        &#34;_audit_log_entry_converters&#34;,
        &#34;_audit_log_event_mapping&#34;,
        &#34;_dm_channel_type_mapping&#34;,
        &#34;_guild_channel_type_mapping&#34;,
    )

    def __init__(self, app: traits.RESTAware) -&gt; None:
        self._app = app
        self._audit_log_entry_converters: typing.Mapping[str, typing.Callable[[typing.Any], typing.Any]] = {
            audit_log_models.AuditLogChangeKey.OWNER_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.AFK_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.AFK_TIMEOUT: _deserialize_seconds_timedelta,
            audit_log_models.AuditLogChangeKey.MFA_LEVEL: guild_models.GuildMFALevel,
            audit_log_models.AuditLogChangeKey.VERIFICATION_LEVEL: guild_models.GuildVerificationLevel,
            audit_log_models.AuditLogChangeKey.EXPLICIT_CONTENT_FILTER: guild_models.GuildExplicitContentFilterLevel,
            audit_log_models.AuditLogChangeKey.DEFAULT_MESSAGE_NOTIFICATIONS: guild_models.GuildMessageNotificationsLevel,
            # noqa: E501 - Line too long
            audit_log_models.AuditLogChangeKey.PRUNE_DELETE_DAYS: _deserialize_day_timedelta,
            audit_log_models.AuditLogChangeKey.WIDGET_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.POSITION: int,
            audit_log_models.AuditLogChangeKey.BITRATE: int,
            audit_log_models.AuditLogChangeKey.APPLICATION_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.PERMISSIONS: permission_models.Permissions,
            audit_log_models.AuditLogChangeKey.COLOR: color_models.Color,
            audit_log_models.AuditLogChangeKey.ALLOW: permission_models.Permissions,
            audit_log_models.AuditLogChangeKey.DENY: permission_models.Permissions,
            audit_log_models.AuditLogChangeKey.CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.INVITER_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.MAX_USES: _deserialize_max_uses,
            audit_log_models.AuditLogChangeKey.USES: int,
            audit_log_models.AuditLogChangeKey.MAX_AGE: _deserialize_max_age,
            audit_log_models.AuditLogChangeKey.ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.TYPE: str,
            audit_log_models.AuditLogChangeKey.ENABLE_EMOTICONS: bool,
            audit_log_models.AuditLogChangeKey.EXPIRE_BEHAVIOR: guild_models.IntegrationExpireBehaviour,
            audit_log_models.AuditLogChangeKey.EXPIRE_GRACE_PERIOD: _deserialize_day_timedelta,
            audit_log_models.AuditLogChangeKey.RATE_LIMIT_PER_USER: _deserialize_seconds_timedelta,
            audit_log_models.AuditLogChangeKey.SYSTEM_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.ADD_ROLE_TO_MEMBER: self._deserialize_audit_log_change_roles,
            audit_log_models.AuditLogChangeKey.REMOVE_ROLE_FROM_MEMBER: self._deserialize_audit_log_change_roles,
            audit_log_models.AuditLogChangeKey.PERMISSION_OVERWRITES: self._deserialize_audit_log_overwrites,
        }
        self._audit_log_event_mapping: typing.Mapping[
            typing.Union[int, audit_log_models.AuditLogEventType],
            typing.Callable[[data_binding.JSONObject], audit_log_models.BaseAuditLogEntryInfo],
        ] = {
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_CREATE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_UPDATE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_DELETE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_PIN: self._deserialize_message_pin_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_UNPIN: self._deserialize_message_pin_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_PRUNE: self._deserialize_member_prune_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_BULK_DELETE: self._deserialize_message_bulk_delete_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_DELETE: self._deserialize_message_delete_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_DISCONNECT: self._deserialize_member_disconnect_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_MOVE: self._deserialize_member_move_entry_info,
        }
        self._dm_channel_type_mapping = {
            channel_models.ChannelType.DM: self.deserialize_dm,
            channel_models.ChannelType.GROUP_DM: self.deserialize_group_dm,
        }
        self._guild_channel_type_mapping = {
            channel_models.ChannelType.GUILD_CATEGORY: self.deserialize_guild_category,
            channel_models.ChannelType.GUILD_TEXT: self.deserialize_guild_text_channel,
            channel_models.ChannelType.GUILD_NEWS: self.deserialize_guild_news_channel,
            channel_models.ChannelType.GUILD_STORE: self.deserialize_guild_store_channel,
            channel_models.ChannelType.GUILD_VOICE: self.deserialize_guild_voice_channel,
        }

    ######################
    # APPLICATION MODELS #
    ######################

    def deserialize_own_connection(self, payload: data_binding.JSONObject) -&gt; application_models.OwnConnection:
        if (integration_payloads := payload.get(&#34;integrations&#34;)) is not None:
            integrations = [self.deserialize_partial_integration(integration) for integration in integration_payloads]
        else:
            integrations = []

        return application_models.OwnConnection(
            id=payload[&#34;id&#34;],
            name=payload[&#34;name&#34;],
            type=payload[&#34;type&#34;],
            is_revoked=payload[&#34;revoked&#34;],
            integrations=integrations,
            is_verified=payload[&#34;verified&#34;],
            is_friend_sync_enabled=payload[&#34;friend_sync&#34;],
            is_activity_visible=payload[&#34;show_activity&#34;],
            visibility=application_models.ConnectionVisibility(payload[&#34;visibility&#34;]),
        )

    def deserialize_own_guild(self, payload: data_binding.JSONObject) -&gt; application_models.OwnGuild:
        guild_fields = self._set_partial_guild_attributes(payload)
        return application_models.OwnGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            is_owner=bool(payload[&#34;owner&#34;]),
            my_permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
        )

    def deserialize_application(self, payload: data_binding.JSONObject) -&gt; application_models.Application:
        team: typing.Optional[application_models.Team] = None
        if (team_payload := payload.get(&#34;team&#34;)) is not None:
            members = {}
            for member_payload in team_payload[&#34;members&#34;]:
                team_member = application_models.TeamMember(
                    app=self._app,
                    membership_state=application_models.TeamMembershipState(member_payload[&#34;membership_state&#34;]),
                    permissions=member_payload[&#34;permissions&#34;],
                    team_id=snowflakes.Snowflake(member_payload[&#34;team_id&#34;]),
                    user=self.deserialize_user(member_payload[&#34;user&#34;]),
                )
                members[team_member.user.id] = team_member

            team = application_models.Team(
                app=self._app,
                id=snowflakes.Snowflake(team_payload[&#34;id&#34;]),
                icon_hash=team_payload[&#34;icon&#34;],
                members=members,
                owner_id=snowflakes.Snowflake(team_payload[&#34;owner_user_id&#34;]),
            )

        primary_sku_id = snowflakes.Snowflake(payload[&#34;primary_sku_id&#34;]) if &#34;primary_sku_id&#34; in payload else None

        return application_models.Application(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            is_bot_public=payload.get(&#34;bot_public&#34;),
            is_bot_code_grant_required=payload.get(&#34;bot_require_code_grant&#34;),
            owner=self.deserialize_user(payload[&#34;owner&#34;]) if &#34;owner&#34; in payload else None,
            rpc_origins=payload[&#34;rpc_origins&#34;] if &#34;rpc_origins&#34; in payload else None,
            summary=payload[&#34;summary&#34;],
            verify_key=bytes(payload[&#34;verify_key&#34;], &#34;utf-8&#34;) if &#34;verify_key&#34; in payload else None,
            icon_hash=payload.get(&#34;icon&#34;),
            team=team,
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
            primary_sku_id=primary_sku_id,
            slug=payload.get(&#34;slug&#34;),
            cover_image_hash=payload.get(&#34;cover_image&#34;),
        )

    #####################
    # AUDIT LOGS MODELS #
    #####################

    def _deserialize_audit_log_change_roles(
        self, payload: data_binding.JSONArray
    ) -&gt; typing.Mapping[snowflakes.Snowflake, guild_models.PartialRole]:
        roles = {}
        for role_payload in payload:
            role = guild_models.PartialRole(
                app=self._app, id=snowflakes.Snowflake(role_payload[&#34;id&#34;]), name=role_payload[&#34;name&#34;]
            )
            roles[role.id] = role

        return roles

    def _deserialize_audit_log_overwrites(
        self, payload: data_binding.JSONArray
    ) -&gt; typing.Mapping[snowflakes.Snowflake, channel_models.PermissionOverwrite]:
        return {
            snowflakes.Snowflake(overwrite[&#34;id&#34;]): self.deserialize_permission_overwrite(overwrite)
            for overwrite in payload
        }

    @staticmethod
    def _deserialize_channel_overwrite_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.ChannelOverwriteEntryInfo:
        return audit_log_models.ChannelOverwriteEntryInfo(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=channel_models.PermissionOverwriteType(payload[&#34;type&#34;]),
            role_name=payload.get(&#34;role_name&#34;),
        )

    @staticmethod
    def _deserialize_message_pin_entry_info(payload: data_binding.JSONObject) -&gt; audit_log_models.MessagePinEntryInfo:
        return audit_log_models.MessagePinEntryInfo(
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            message_id=snowflakes.Snowflake(payload[&#34;message_id&#34;]),
        )

    @staticmethod
    def _deserialize_member_prune_entry_info(payload: data_binding.JSONObject) -&gt; audit_log_models.MemberPruneEntryInfo:
        return audit_log_models.MemberPruneEntryInfo(
            delete_member_days=datetime.timedelta(days=int(payload[&#34;delete_member_days&#34;])),
            members_removed=int(payload[&#34;members_removed&#34;]),
        )

    @staticmethod
    def _deserialize_message_bulk_delete_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.MessageBulkDeleteEntryInfo:
        return audit_log_models.MessageBulkDeleteEntryInfo(count=int(payload[&#34;count&#34;]))

    @staticmethod
    def _deserialize_message_delete_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.MessageDeleteEntryInfo:
        return audit_log_models.MessageDeleteEntryInfo(
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]), count=int(payload[&#34;count&#34;])
        )

    @staticmethod
    def _deserialize_member_disconnect_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.MemberDisconnectEntryInfo:
        return audit_log_models.MemberDisconnectEntryInfo(count=int(payload[&#34;count&#34;]))

    @staticmethod
    def _deserialize_member_move_entry_info(payload: data_binding.JSONObject) -&gt; audit_log_models.MemberMoveEntryInfo:
        return audit_log_models.MemberMoveEntryInfo(
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]), count=int(payload[&#34;count&#34;])
        )

    @staticmethod
    def _deserialize_unrecognised_audit_log_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.UnrecognisedAuditLogEntryInfo:
        return audit_log_models.UnrecognisedAuditLogEntryInfo(payload)

    def deserialize_audit_log(self, payload: data_binding.JSONObject) -&gt; audit_log_models.AuditLog:
        entries = {}
        for entry_payload in payload[&#34;audit_log_entries&#34;]:
            entry_id = snowflakes.Snowflake(entry_payload[&#34;id&#34;])

            changes = []
            if (change_payloads := entry_payload.get(&#34;changes&#34;)) is not None:
                for change_payload in change_payloads:
                    key: typing.Union[audit_log_models.AuditLogChangeKey, str]
                    key = audit_log_models.AuditLogChangeKey(change_payload[&#34;key&#34;])

                    new_value: typing.Any = change_payload.get(&#34;new_value&#34;)
                    old_value: typing.Any = change_payload.get(&#34;old_value&#34;)
                    if value_converter := self._audit_log_entry_converters.get(key):
                        new_value = value_converter(new_value) if new_value is not None else None
                        old_value = value_converter(old_value) if old_value is not None else None

                    changes.append(audit_log_models.AuditLogChange(key=key, new_value=new_value, old_value=old_value))

            target_id: typing.Optional[snowflakes.Snowflake] = None
            if (raw_target_id := entry_payload[&#34;target_id&#34;]) is not None:
                target_id = snowflakes.Snowflake(raw_target_id)

            user_id: typing.Optional[snowflakes.Snowflake] = None
            if (raw_user_id := entry_payload[&#34;user_id&#34;]) is not None:
                user_id = snowflakes.Snowflake(raw_user_id)

            action_type: typing.Union[audit_log_models.AuditLogEventType, int]
            action_type = audit_log_models.AuditLogEventType(entry_payload[&#34;action_type&#34;])

            options: typing.Optional[audit_log_models.BaseAuditLogEntryInfo] = None
            if (raw_option := entry_payload.get(&#34;options&#34;)) is not None:
                option_converter = (
                    self._audit_log_event_mapping.get(action_type)
                    or self._deserialize_unrecognised_audit_log_entry_info  # noqa: W503
                )
                options = option_converter(raw_option)

            entries[entry_id] = audit_log_models.AuditLogEntry(
                app=self._app,
                id=entry_id,
                target_id=target_id,
                changes=changes,
                user_id=user_id,
                action_type=action_type,
                options=options,
                reason=entry_payload.get(&#34;reason&#34;),
            )

        integrations = {
            snowflakes.Snowflake(integration[&#34;id&#34;]): self.deserialize_partial_integration(integration)
            for integration in payload[&#34;integrations&#34;]
        }
        users = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;users&#34;]}
        webhooks = {
            snowflakes.Snowflake(webhook[&#34;id&#34;]): self.deserialize_webhook(webhook) for webhook in payload[&#34;webhooks&#34;]
        }
        return audit_log_models.AuditLog(entries=entries, integrations=integrations, users=users, webhooks=webhooks)

    ##################
    # CHANNEL MODELS #
    ##################

    def deserialize_channel_follow(self, payload: data_binding.JSONObject) -&gt; channel_models.ChannelFollow:
        return channel_models.ChannelFollow(
            app=self._app,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]),
        )

    def deserialize_permission_overwrite(self, payload: data_binding.JSONObject) -&gt; channel_models.PermissionOverwrite:
        return channel_models.PermissionOverwrite(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=channel_models.PermissionOverwriteType(payload[&#34;type&#34;]),
            allow=permission_models.Permissions(int(payload[&#34;allow&#34;])),
            deny=permission_models.Permissions(int(payload[&#34;deny&#34;])),
        )

    def serialize_permission_overwrite(self, overwrite: channel_models.PermissionOverwrite) -&gt; data_binding.JSONObject:
        # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
        # allow and deny can be strings instead now.
        return {
            &#34;id&#34;: str(overwrite.id),
            &#34;type&#34;: overwrite.type,
            &#34;allow&#34;: str(int(overwrite.allow)),
            &#34;deny&#34;: str(int(overwrite.deny)),
        }

    def deserialize_partial_channel(self, payload: data_binding.JSONObject) -&gt; channel_models.PartialChannel:
        return channel_models.PartialChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
        )

    def deserialize_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.DMChannel:
        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        return channel_models.DMChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            last_message_id=last_message_id,
            recipient=self.deserialize_user(payload[&#34;recipients&#34;][0]),
        )

    def deserialize_group_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.GroupDMChannel:
        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        if (raw_nicks := payload.get(&#34;nicks&#34;)) is not None:
            nicknames = {snowflakes.Snowflake(entry[&#34;id&#34;]): entry[&#34;nick&#34;] for entry in raw_nicks}
        else:
            nicknames = {}

        recipients = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;recipients&#34;]}

        return channel_models.GroupDMChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            last_message_id=last_message_id,
            owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
            icon_hash=payload[&#34;icon&#34;],
            nicknames=nicknames,
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
            recipients=recipients,
        )

    def _set_guild_channel_attributes(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake],
    ) -&gt; _GuildChannelFields:
        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        permission_overwrites = {
            snowflakes.Snowflake(overwrite[&#34;id&#34;]): self.deserialize_permission_overwrite(overwrite)
            for overwrite in payload[&#34;permission_overwrites&#34;]
        }  # TODO: while snowflakes are guaranteed to be unique within their own resource, there is no guarantee for
        # across between resources (user and role in this case); while in practice we will not get overlap there is a
        # chance that this may happen in the future, would it be more sensible to use a Sequence here?

        parent_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_parent_id := payload.get(&#34;parent_id&#34;)) is not None:
            parent_id = snowflakes.Snowflake(raw_parent_id)

        return _GuildChannelFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            guild_id=guild_id,
            position=int(payload[&#34;position&#34;]),
            permission_overwrites=permission_overwrites,
            is_nsfw=payload.get(&#34;nsfw&#34;),
            parent_id=parent_id,
        )

    def deserialize_guild_category(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildCategory:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildCategory(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
        )

    def deserialize_guild_text_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildTextChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        last_pin_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
            last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

        return channel_models.GuildTextChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            topic=payload[&#34;topic&#34;],
            last_message_id=last_message_id,
            # Usually this is 0 if unset, but some old channels made before the
            # rate_limit_per_user field was implemented will not have this field
            # at all if they have never had the rate limit changed...
            rate_limit_per_user=datetime.timedelta(seconds=payload.get(&#34;rate_limit_per_user&#34;, 0)),
            last_pin_timestamp=last_pin_timestamp,
        )

    def deserialize_guild_news_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildNewsChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        last_pin_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
            last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

        return channel_models.GuildNewsChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            topic=payload[&#34;topic&#34;],
            last_message_id=last_message_id,
            last_pin_timestamp=last_pin_timestamp,
        )

    def deserialize_guild_store_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildStoreChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildStoreChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
        )

    def deserialize_guild_voice_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildVoiceChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildVoiceChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            bitrate=int(payload[&#34;bitrate&#34;]),
            user_limit=int(payload[&#34;user_limit&#34;]),
        )

    def deserialize_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.PartialChannel:
        channel_type = payload[&#34;type&#34;]
        if channel_model := self._guild_channel_type_mapping.get(channel_type):
            return channel_model(payload, guild_id=guild_id)

        return self._dm_channel_type_mapping[channel_type](payload)

    ################
    # EMBED MODELS #
    ################

    def deserialize_embed(self, payload: data_binding.JSONObject) -&gt; embed_models.Embed:
        # Keep these separate to aid debugging later.
        title = payload.get(&#34;title&#34;)
        description = payload.get(&#34;description&#34;)
        url = payload.get(&#34;url&#34;)
        color = color_models.Color(payload[&#34;color&#34;]) if &#34;color&#34; in payload else None
        timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]) if &#34;timestamp&#34; in payload else None
        fields: typing.Optional[typing.MutableSequence[embed_models.EmbedField]] = None

        image: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
        if image_payload := payload.get(&#34;image&#34;):
            image = embed_models.EmbedImage(
                resource=files.ensure_resource(image_payload.get(&#34;url&#34;)),
                proxy_resource=files.ensure_resource(image_payload.get(&#34;proxy_url&#34;)),
                height=image_payload.get(&#34;height&#34;),
                width=image_payload.get(&#34;width&#34;),
            )

        thumbnail: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
        if thumbnail_payload := payload.get(&#34;thumbnail&#34;):
            thumbnail = embed_models.EmbedImage(
                resource=files.ensure_resource(thumbnail_payload.get(&#34;url&#34;)),
                proxy_resource=files.ensure_resource(thumbnail_payload.get(&#34;proxy_url&#34;)),
                height=thumbnail_payload.get(&#34;height&#34;),
                width=thumbnail_payload.get(&#34;width&#34;),
            )

        video: typing.Optional[embed_models.EmbedVideo[files.AsyncReader]] = None
        if video_payload := payload.get(&#34;video&#34;):
            video = embed_models.EmbedVideo(
                resource=files.ensure_resource(video_payload.get(&#34;url&#34;)),
                height=video_payload.get(&#34;height&#34;),
                width=video_payload.get(&#34;width&#34;),
            )

        provider: typing.Optional[embed_models.EmbedProvider] = None
        if provider_payload := payload.get(&#34;provider&#34;):
            provider = embed_models.EmbedProvider(name=provider_payload.get(&#34;name&#34;), url=provider_payload.get(&#34;url&#34;))

        icon: typing.Optional[embed_models.EmbedResourceWithProxy[files.AsyncReader]]
        author: typing.Optional[embed_models.EmbedAuthor] = None
        if author_payload := payload.get(&#34;author&#34;):
            icon = None
            if &#34;icon_url&#34; in author_payload:
                icon = embed_models.EmbedResourceWithProxy(
                    resource=files.ensure_resource(author_payload.get(&#34;icon_url&#34;)),
                    proxy_resource=files.ensure_resource(author_payload.get(&#34;proxy_icon_url&#34;)),
                )

            author = embed_models.EmbedAuthor(
                name=author_payload.get(&#34;name&#34;),
                url=author_payload.get(&#34;url&#34;),
                icon=icon,
            )

        footer: typing.Optional[embed_models.EmbedFooter] = None
        if footer_payload := payload.get(&#34;footer&#34;):
            icon = None
            if &#34;icon_url&#34; in footer_payload:
                icon = embed_models.EmbedResourceWithProxy(
                    resource=files.ensure_resource(footer_payload.get(&#34;icon_url&#34;)),
                    proxy_resource=files.ensure_resource(footer_payload.get(&#34;proxy_icon_url&#34;)),
                )

            footer = embed_models.EmbedFooter(text=footer_payload.get(&#34;text&#34;), icon=icon)

        if fields_array := payload.get(&#34;fields&#34;):
            fields = []
            for field_payload in fields_array:
                field = embed_models.EmbedField(
                    name=field_payload[&#34;name&#34;],
                    value=field_payload[&#34;value&#34;],
                    inline=field_payload.get(&#34;inline&#34;, False),
                )
                fields.append(field)

        return embed_models.Embed.from_received_embed(
            title=title,
            description=description,
            url=url,
            color=color,
            timestamp=timestamp,
            image=image,
            thumbnail=thumbnail,
            video=video,
            provider=provider,
            author=author,
            footer=footer,
            fields=fields,
        )

    def serialize_embed(  # noqa: C901
        self,
        embed: embed_models.Embed,
    ) -&gt; typing.Tuple[data_binding.JSONObject, typing.List[files.Resource[files.AsyncReader]]]:

        payload: data_binding.JSONObject = {}
        uploads: typing.List[files.Resource[files.AsyncReader]] = []

        if embed.title is not None:
            payload[&#34;title&#34;] = embed.title

        if embed.description is not None:
            payload[&#34;description&#34;] = embed.description

        if embed.url is not None:
            payload[&#34;url&#34;] = embed.url

        if embed.timestamp is not None:
            payload[&#34;timestamp&#34;] = embed.timestamp.isoformat()

        if embed.color is not None:
            payload[&#34;color&#34;] = int(embed.color)

        if embed.footer is not None:
            footer_payload: data_binding.JSONObject = {}

            if embed.footer.text is not None:
                footer_payload[&#34;text&#34;] = embed.footer.text

            if embed.footer.icon is not None:
                if not isinstance(embed.footer.icon.resource, files.WebResource):
                    uploads.append(embed.footer.icon.resource)

                footer_payload[&#34;icon_url&#34;] = embed.footer.icon.url

            payload[&#34;footer&#34;] = footer_payload

        if embed.image is not None:
            image_payload: data_binding.JSONObject = {}

            if not isinstance(embed.image.resource, files.WebResource):
                uploads.append(embed.image.resource)

            image_payload[&#34;url&#34;] = embed.image.url
            payload[&#34;image&#34;] = image_payload

        if embed.thumbnail is not None:
            thumbnail_payload: data_binding.JSONObject = {}

            if not isinstance(embed.thumbnail.resource, files.WebResource):
                uploads.append(embed.thumbnail.resource)

            thumbnail_payload[&#34;url&#34;] = embed.thumbnail.url
            payload[&#34;thumbnail&#34;] = thumbnail_payload

        if embed.author is not None:
            author_payload: data_binding.JSONObject = {}

            if embed.author.name is not None:
                author_payload[&#34;name&#34;] = embed.author.name

            if embed.author.url is not None:
                author_payload[&#34;url&#34;] = embed.author.url

            if embed.author.icon is not None:
                if not isinstance(embed.author.icon.resource, files.WebResource):
                    uploads.append(embed.author.icon.resource)
                author_payload[&#34;icon_url&#34;] = embed.author.icon.url

            payload[&#34;author&#34;] = author_payload

        if embed.fields:
            field_payloads: data_binding.JSONArray = []
            for i, field in enumerate(embed.fields):

                # Yep, this is technically two unreachable branches. However, this is an incredibly
                # common mistake to make when working with embeds and not using a static type
                # checker, so I have added these as additional safeguards for UX and ease
                # of debugging. The case that there are `None` should be detected immediately by
                # static type checkers, regardless.

                name = str(field.name) if field.name is not None else None  # type: ignore[unreachable]
                value = str(field.value) if field.value is not None else None  # type: ignore[unreachable]

                if name is None:
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have `None`&#34;)
                if not name:
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have empty string&#34;)
                if not name.strip():
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have only whitespace&#34;)

                if value is None:
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have `None`&#34;)
                if not value:
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have empty string&#34;)
                if not value.strip():
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have only whitespace&#34;)

                # Name and value always have to be specified; we can always
                # send a default `inline` value also just to keep this simpler.
                field_payloads.append({&#34;name&#34;: name, &#34;value&#34;: value, &#34;inline&#34;: field.is_inline})
            payload[&#34;fields&#34;] = field_payloads

        return payload, uploads

    ################
    # EMOJI MODELS #
    ################

    def deserialize_unicode_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.UnicodeEmoji:
        return emoji_models.UnicodeEmoji(name=payload[&#34;name&#34;])

    def deserialize_custom_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.CustomEmoji:
        return emoji_models.CustomEmoji(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            is_animated=payload.get(&#34;animated&#34;, False),
        )

    def deserialize_known_custom_emoji(
        self, payload: data_binding.JSONObject, *, guild_id: snowflakes.Snowflake
    ) -&gt; emoji_models.KnownCustomEmoji:
        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]] if &#34;roles&#34; in payload else []

        user: typing.Optional[user_models.User] = None
        if (raw_user := payload.get(&#34;user&#34;)) is not None:
            user = self.deserialize_user(raw_user)

        return emoji_models.KnownCustomEmoji(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            is_animated=payload.get(&#34;animated&#34;, False),
            guild_id=guild_id,
            role_ids=role_ids,
            user=user,
            is_colons_required=payload[&#34;require_colons&#34;],
            is_managed=payload[&#34;managed&#34;],
            is_available=payload[&#34;available&#34;],
        )

    def deserialize_emoji(
        self, payload: data_binding.JSONObject
    ) -&gt; typing.Union[emoji_models.UnicodeEmoji, emoji_models.CustomEmoji]:
        if payload.get(&#34;id&#34;) is not None:
            return self.deserialize_custom_emoji(payload)

        return self.deserialize_unicode_emoji(payload)

    ##################
    # GATEWAY MODELS #
    ##################

    def deserialize_gateway_bot(self, payload: data_binding.JSONObject) -&gt; gateway_models.GatewayBot:
        session_start_limit_payload = payload[&#34;session_start_limit&#34;]
        session_start_limit = gateway_models.SessionStartLimit(
            total=int(session_start_limit_payload[&#34;total&#34;]),
            remaining=int(session_start_limit_payload[&#34;remaining&#34;]),
            reset_after=datetime.timedelta(milliseconds=session_start_limit_payload[&#34;reset_after&#34;]),
            # I do not trust that this may never be zero for some unknown reason. If it was 0, it
            # would hang the application on start up, so I enforce it is at least 1.
            max_concurrency=max(session_start_limit_payload.get(&#34;max_concurrency&#34;, 0), 1),
        )
        return gateway_models.GatewayBot(
            url=payload[&#34;url&#34;],
            shard_count=int(payload[&#34;shards&#34;]),
            session_start_limit=session_start_limit,
        )

    ################
    # GUILD MODELS #
    ################

    def deserialize_guild_widget(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildWidget:
        channel_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
            channel_id = snowflakes.Snowflake(raw_channel_id)

        return guild_models.GuildWidget(app=self._app, channel_id=channel_id, is_enabled=payload[&#34;enabled&#34;])

    def deserialize_member(
        self,
        payload: data_binding.JSONObject,
        *,
        user: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; guild_models.Member:
        if user is undefined.UNDEFINED:
            user = self.deserialize_user(payload[&#34;user&#34;])

        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]]
        # If Discord ever does start including this here without warning we don&#39;t want to duplicate the entry.
        if guild_id not in role_ids:
            role_ids.append(guild_id)

        joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;])

        raw_premium_since = payload.get(&#34;premium_since&#34;)
        premium_since = (
            time.iso8601_datetime_string_to_datetime(raw_premium_since) if raw_premium_since is not None else None
        )

        return guild_models.Member(
            user=user,
            guild_id=guild_id,
            role_ids=role_ids,
            joined_at=joined_at,
            nickname=payload[&#34;nick&#34;] if &#34;nick&#34; in payload else undefined.UNDEFINED,
            premium_since=premium_since,
            is_deaf=payload[&#34;deaf&#34;] if &#34;deaf&#34; in payload else undefined.UNDEFINED,
            is_mute=payload[&#34;mute&#34;] if &#34;mute&#34; in payload else undefined.UNDEFINED,
        )

    def deserialize_role(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: snowflakes.Snowflake,
    ) -&gt; guild_models.Role:
        return guild_models.Role(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            guild_id=guild_id,
            name=payload[&#34;name&#34;],
            color=color_models.Color(payload[&#34;color&#34;]),
            is_hoisted=payload[&#34;hoist&#34;],
            position=int(payload[&#34;position&#34;]),
            # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
            permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
            is_managed=payload[&#34;managed&#34;],
            is_mentionable=payload[&#34;mentionable&#34;],
        )

    @staticmethod
    def _set_partial_integration_attributes(payload: data_binding.JSONObject) -&gt; _IntegrationFields:
        account_payload = payload[&#34;account&#34;]
        account = guild_models.IntegrationAccount(id=account_payload[&#34;id&#34;], name=account_payload[&#34;name&#34;])
        return _IntegrationFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            type=payload[&#34;type&#34;],
            account=account,
        )

    def deserialize_partial_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.PartialIntegration:
        integration_fields = self._set_partial_integration_attributes(payload)
        return guild_models.PartialIntegration(
            id=integration_fields.id,
            name=integration_fields.name,
            type=integration_fields.type,
            account=integration_fields.account,
        )

    def deserialize_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.Integration:
        integration_fields = self._set_partial_integration_attributes(payload)

        role_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_role_id := payload.get(&#34;role_id&#34;)) is not None:
            role_id = snowflakes.Snowflake(raw_role_id)

        last_synced_at: typing.Optional[datetime.datetime] = None
        if (raw_last_synced_at := payload.get(&#34;synced_at&#34;)) is not None:
            last_synced_at = time.iso8601_datetime_string_to_datetime(raw_last_synced_at)

        return guild_models.Integration(
            id=integration_fields.id,
            name=integration_fields.name,
            type=integration_fields.type,
            account=integration_fields.account,
            is_enabled=payload[&#34;enabled&#34;],
            is_syncing=payload[&#34;syncing&#34;],
            role_id=role_id,
            is_emojis_enabled=payload.get(&#34;enable_emoticons&#34;),
            expire_behavior=guild_models.IntegrationExpireBehaviour(payload[&#34;expire_behavior&#34;]),
            expire_grace_period=datetime.timedelta(days=payload[&#34;expire_grace_period&#34;]),
            user=self.deserialize_user(payload[&#34;user&#34;]),
            last_synced_at=last_synced_at,
        )

    def deserialize_guild_member_ban(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildMemberBan:
        return guild_models.GuildMemberBan(reason=payload[&#34;reason&#34;], user=self.deserialize_user(payload[&#34;user&#34;]))

    @staticmethod
    def _set_partial_guild_attributes(payload: data_binding.JSONObject) -&gt; _PartialGuildFields:
        features = []
        for feature in payload[&#34;features&#34;]:
            features.append(guild_models.GuildFeature(feature))

        return _PartialGuildFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            icon_hash=payload[&#34;icon&#34;],
            features=features,
        )

    def deserialize_guild_preview(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildPreview:
        guild_fields = self._set_partial_guild_attributes(payload)
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
            for emoji in payload[&#34;emojis&#34;]
        }
        return guild_models.GuildPreview(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=payload[&#34;splash&#34;],
            discovery_splash_hash=payload[&#34;discovery_splash&#34;],
            emojis=emojis,
            approximate_active_member_count=int(payload[&#34;approximate_presence_count&#34;]),
            approximate_member_count=int(payload[&#34;approximate_member_count&#34;]),
            description=payload[&#34;description&#34;],
        )

    def _set_guild_attributes(self, payload: data_binding.JSONObject) -&gt; _GuildFields:
        guild_fields = self._set_partial_guild_attributes(payload)
        afk_channel_id = payload[&#34;afk_channel_id&#34;]
        default_message_notifications = guild_models.GuildMessageNotificationsLevel(
            payload[&#34;default_message_notifications&#34;]
        )
        application_id = payload[&#34;application_id&#34;]
        widget_channel_id = payload.get(&#34;widget_channel_id&#34;)
        system_channel_id = payload[&#34;system_channel_id&#34;]
        rules_channel_id = payload[&#34;rules_channel_id&#34;]
        max_video_channel_users = (
            int(payload[&#34;max_video_channel_users&#34;]) if &#34;max_video_channel_users&#34; in payload else None
        )
        public_updates_channel_id = payload[&#34;public_updates_channel_id&#34;]
        public_updates_channel_id = (
            snowflakes.Snowflake(public_updates_channel_id) if public_updates_channel_id is not None else None
        )
        return _GuildFields(
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=payload[&#34;splash&#34;],
            # This is documented as always being present, but we have found old guilds where this is
            # not present. Quicker to just assume the documentation is wrong at this point than try
            # to contest whether this is right or not with Discord.
            discovery_splash_hash=payload.get(&#34;discovery_splash&#34;),
            owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
            region=payload[&#34;region&#34;],
            afk_channel_id=snowflakes.Snowflake(afk_channel_id) if afk_channel_id is not None else None,
            afk_timeout=datetime.timedelta(seconds=payload[&#34;afk_timeout&#34;]),
            verification_level=guild_models.GuildVerificationLevel(payload[&#34;verification_level&#34;]),
            default_message_notifications=default_message_notifications,
            explicit_content_filter=guild_models.GuildExplicitContentFilterLevel(payload[&#34;explicit_content_filter&#34;]),
            mfa_level=guild_models.GuildMFALevel(payload[&#34;mfa_level&#34;]),
            application_id=snowflakes.Snowflake(application_id) if application_id is not None else None,
            widget_channel_id=snowflakes.Snowflake(widget_channel_id) if widget_channel_id is not None else None,
            system_channel_id=snowflakes.Snowflake(system_channel_id) if system_channel_id is not None else None,
            is_widget_enabled=payload[&#34;widget_enabled&#34;] if &#34;widget_enabled&#34; in payload else None,
            system_channel_flags=guild_models.GuildSystemChannelFlag(payload[&#34;system_channel_flags&#34;]),
            rules_channel_id=snowflakes.Snowflake(rules_channel_id) if rules_channel_id is not None else None,
            max_video_channel_users=max_video_channel_users,
            vanity_url_code=payload[&#34;vanity_url_code&#34;],
            description=payload[&#34;description&#34;],
            banner_hash=payload[&#34;banner&#34;],
            premium_tier=guild_models.GuildPremiumTier(payload[&#34;premium_tier&#34;]),
            premium_subscription_count=payload.get(&#34;premium_subscription_count&#34;),
            preferred_locale=payload[&#34;preferred_locale&#34;],
            public_updates_channel_id=public_updates_channel_id,
        )

    def deserialize_rest_guild(self, payload: data_binding.JSONObject) -&gt; guild_models.RESTGuild:
        guild_fields = self._set_guild_attributes(payload)
        approximate_member_count = int(payload[&#34;approximate_member_count&#34;])
        approximate_active_member_count = int(payload[&#34;approximate_presence_count&#34;])
        max_members = int(payload[&#34;max_members&#34;])

        raw_max_presences = payload[&#34;max_presences&#34;]
        if raw_max_presences is None:
            max_presences = _DEFAULT_MAX_PRESENCES
        else:
            max_presences = int(raw_max_presences)

        roles = {
            snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild_fields.id)
            for role in payload[&#34;roles&#34;]
        }
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
            for emoji in payload[&#34;emojis&#34;]
        }
        guild = guild_models.RESTGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=guild_fields.splash_hash,
            discovery_splash_hash=guild_fields.discovery_splash_hash,
            owner_id=guild_fields.owner_id,
            region=guild_fields.region,
            afk_channel_id=guild_fields.afk_channel_id,
            afk_timeout=guild_fields.afk_timeout,
            verification_level=guild_fields.verification_level,
            default_message_notifications=guild_fields.default_message_notifications,
            explicit_content_filter=guild_fields.explicit_content_filter,
            mfa_level=guild_fields.mfa_level,
            application_id=guild_fields.application_id,
            widget_channel_id=guild_fields.widget_channel_id,
            system_channel_id=guild_fields.system_channel_id,
            is_widget_enabled=guild_fields.is_widget_enabled,
            system_channel_flags=guild_fields.system_channel_flags,
            rules_channel_id=guild_fields.rules_channel_id,
            max_presences=max_presences,
            max_members=max_members,
            max_video_channel_users=guild_fields.max_video_channel_users,
            vanity_url_code=guild_fields.vanity_url_code,
            description=guild_fields.description,
            banner_hash=guild_fields.banner_hash,
            premium_tier=guild_fields.premium_tier,
            premium_subscription_count=guild_fields.premium_subscription_count,
            preferred_locale=guild_fields.preferred_locale,
            public_updates_channel_id=guild_fields.public_updates_channel_id,
            approximate_member_count=approximate_member_count,
            approximate_active_member_count=approximate_active_member_count,
            roles=roles,
            emojis=emojis,
        )
        return guild

    def deserialize_gateway_guild(self, payload: data_binding.JSONObject) -&gt; entity_factory.GatewayGuildDefinition:
        guild_fields = self._set_guild_attributes(payload)
        is_large = payload[&#34;large&#34;] if &#34;large&#34; in payload else None
        joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;]) if &#34;joined_at&#34; in payload else None
        member_count = int(payload[&#34;member_count&#34;]) if &#34;member_count&#34; in payload else None

        guild = guild_models.GatewayGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=guild_fields.splash_hash,
            discovery_splash_hash=guild_fields.discovery_splash_hash,
            owner_id=guild_fields.owner_id,
            region=guild_fields.region,
            afk_channel_id=guild_fields.afk_channel_id,
            afk_timeout=guild_fields.afk_timeout,
            verification_level=guild_fields.verification_level,
            default_message_notifications=guild_fields.default_message_notifications,
            explicit_content_filter=guild_fields.explicit_content_filter,
            mfa_level=guild_fields.mfa_level,
            application_id=guild_fields.application_id,
            widget_channel_id=guild_fields.widget_channel_id,
            system_channel_id=guild_fields.system_channel_id,
            is_widget_enabled=guild_fields.is_widget_enabled,
            system_channel_flags=guild_fields.system_channel_flags,
            rules_channel_id=guild_fields.rules_channel_id,
            max_video_channel_users=guild_fields.max_video_channel_users,
            vanity_url_code=guild_fields.vanity_url_code,
            description=guild_fields.description,
            banner_hash=guild_fields.banner_hash,
            premium_tier=guild_fields.premium_tier,
            premium_subscription_count=guild_fields.premium_subscription_count,
            preferred_locale=guild_fields.preferred_locale,
            public_updates_channel_id=guild_fields.public_updates_channel_id,
            is_large=is_large,
            joined_at=joined_at,
            member_count=member_count,
        )

        members: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, guild_models.Member]] = None
        if &#34;members&#34; in payload:
            members = {}

            for member_payload in payload[&#34;members&#34;]:
                member = self.deserialize_member(member_payload, guild_id=guild.id)
                members[member.user.id] = member

        channels: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, channel_models.GuildChannel]] = None
        if &#34;channels&#34; in payload:
            channels = {}

            for channel_payload in payload[&#34;channels&#34;]:
                channel = typing.cast(
                    &#34;channel_models.GuildChannel&#34;, self.deserialize_channel(channel_payload, guild_id=guild.id)
                )
                channels[channel.id] = channel

        presences: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, presence_models.MemberPresence]] = None
        if &#34;presences&#34; in payload:
            presences = {}

            for presence_payload in payload[&#34;presences&#34;]:
                presence = self.deserialize_member_presence(presence_payload, guild_id=guild.id)
                presences[presence.user_id] = presence

        voice_states: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, voice_models.VoiceState]] = None
        if &#34;voice_states&#34; in payload:
            voice_states = {}
            assert members is not None

            for voice_state_payload in payload[&#34;voice_states&#34;]:
                member = members[snowflakes.Snowflake(voice_state_payload[&#34;user_id&#34;])]
                voice_state = self.deserialize_voice_state(voice_state_payload, guild_id=guild.id, member=member)
                voice_states[voice_state.user_id] = voice_state

        roles = {
            snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild.id)
            for role in payload[&#34;roles&#34;]
        }
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild.id)
            for emoji in payload[&#34;emojis&#34;]
        }

        return entity_factory.GatewayGuildDefinition(guild, channels, members, presences, roles, emojis, voice_states)

    #################
    # INVITE MODELS #
    #################

    def deserialize_vanity_url(self, payload: data_binding.JSONObject) -&gt; invite_models.VanityURL:
        return invite_models.VanityURL(app=self._app, code=payload[&#34;code&#34;], uses=int(payload[&#34;uses&#34;]))

    def _set_invite_attributes(self, payload: data_binding.JSONObject) -&gt; _InviteFields:
        guild: typing.Optional[invite_models.InviteGuild] = None
        guild_id: typing.Optional[snowflakes.Snowflake] = None
        if &#34;guild&#34; in payload:
            guild_payload = payload[&#34;guild&#34;]
            guild_fields = self._set_partial_guild_attributes(guild_payload)
            guild = invite_models.InviteGuild(
                app=self._app,
                id=guild_fields.id,
                name=guild_fields.name,
                features=guild_fields.features,
                icon_hash=guild_fields.icon_hash,
                splash_hash=guild_payload[&#34;splash&#34;],
                banner_hash=guild_payload[&#34;banner&#34;],
                description=guild_payload[&#34;description&#34;],
                verification_level=guild_models.GuildVerificationLevel(guild_payload[&#34;verification_level&#34;]),
                vanity_url_code=guild_payload[&#34;vanity_url_code&#34;],
            )
            guild_id = guild.id
        elif &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        channel: typing.Optional[channel_models.PartialChannel] = None
        if (raw_channel := payload.get(&#34;channel&#34;)) is not None:
            channel = self.deserialize_partial_channel(raw_channel)
            channel_id = channel.id
        else:
            channel_id = snowflakes.Snowflake(payload[&#34;channel_id&#34;])

        target_user_type = (
            invite_models.TargetUserType(payload[&#34;target_user_type&#34;]) if &#34;target_user_type&#34; in payload else None
        )
        approximate_active_member_count = (
            int(payload[&#34;approximate_presence_count&#34;]) if &#34;approximate_presence_count&#34; in payload else None
        )
        approximate_member_count = (
            int(payload[&#34;approximate_member_count&#34;]) if &#34;approximate_member_count&#34; in payload else None
        )
        return _InviteFields(
            code=payload[&#34;code&#34;],
            guild=guild,
            guild_id=guild_id,
            channel=channel,
            channel_id=channel_id,
            inviter=self.deserialize_user(payload[&#34;inviter&#34;]) if &#34;inviter&#34; in payload else None,
            target_user=self.deserialize_user(payload[&#34;target_user&#34;]) if &#34;target_user&#34; in payload else None,
            target_user_type=target_user_type,
            approximate_active_member_count=approximate_active_member_count,
            approximate_member_count=approximate_member_count,
        )

    def deserialize_invite(self, payload: data_binding.JSONObject) -&gt; invite_models.Invite:
        invite_fields = self._set_invite_attributes(payload)
        return invite_models.Invite(
            app=self._app,
            code=invite_fields.code,
            guild=invite_fields.guild,
            guild_id=invite_fields.guild_id,
            channel=invite_fields.channel,
            channel_id=invite_fields.channel_id,
            inviter=invite_fields.inviter,
            target_user=invite_fields.target_user,
            target_user_type=invite_fields.target_user_type,
            approximate_member_count=invite_fields.approximate_member_count,
            approximate_active_member_count=invite_fields.approximate_active_member_count,
        )

    def deserialize_invite_with_metadata(self, payload: data_binding.JSONObject) -&gt; invite_models.InviteWithMetadata:
        invite_fields = self._set_invite_attributes(payload)
        max_age = payload[&#34;max_age&#34;]
        return invite_models.InviteWithMetadata(
            app=self._app,
            code=invite_fields.code,
            guild=invite_fields.guild,
            guild_id=invite_fields.guild_id,
            channel=invite_fields.channel,
            channel_id=invite_fields.channel_id,
            inviter=invite_fields.inviter,
            target_user=invite_fields.target_user,
            target_user_type=invite_fields.target_user_type,
            approximate_member_count=invite_fields.approximate_member_count,
            approximate_active_member_count=invite_fields.approximate_active_member_count,
            uses=int(payload[&#34;uses&#34;]),
            max_uses=int(payload[&#34;max_uses&#34;]),
            max_age=datetime.timedelta(seconds=max_age) if max_age &gt; 0 else None,
            is_temporary=payload[&#34;temporary&#34;],
            created_at=time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;]),
        )

    ##################
    # MESSAGE MODELS #
    ##################

    def deserialize_partial_message(self, payload: data_binding.JSONObject) -&gt; message_models.PartialMessage:
        author: typing.Optional[user_models.User] = None
        if author_pl := payload.get(&#34;author&#34;):
            author = self.deserialize_user(author_pl)

        guild_id: typing.Optional[snowflakes.Snowflake] = None
        member: typing.Optional[guild_models.Member] = None
        if &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

            if author is not None and (member_pl := payload.get(&#34;member&#34;)):
                member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)

        timestamp: undefined.UndefinedOr[datetime.datetime] = undefined.UNDEFINED
        if &#34;timestamp&#34; in payload:
            timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;])

        edited_timestamp: undefined.UndefinedNoneOr[datetime.datetime] = undefined.UNDEFINED
        if &#34;edited_timestamp&#34; in payload:
            if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
                edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)
            else:
                edited_timestamp = None

        is_mentioning_everyone = payload[&#34;mention_everyone&#34;] if &#34;mention_everyone&#34; in payload else undefined.UNDEFINED

        user_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
        if &#34;mentions&#34; in payload:
            user_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mentions&#34;]]

        role_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
        if &#34;mention_roles&#34; in payload:
            role_mentions = [snowflakes.Snowflake(mention) for mention in payload[&#34;mention_roles&#34;]]

        channel_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
        if &#34;mention_channels&#34; in payload:
            channel_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mention_channels&#34;]]

        attachments: undefined.UndefinedOr[typing.MutableSequence[message_models.Attachment]] = undefined.UNDEFINED
        if &#34;attachments&#34; in payload:
            attachments = []
            for attachment_payload in payload[&#34;attachments&#34;]:
                attachment = message_models.Attachment(
                    id=snowflakes.Snowflake(attachment_payload[&#34;id&#34;]),
                    filename=attachment_payload[&#34;filename&#34;],
                    size=int(attachment_payload[&#34;size&#34;]),
                    url=attachment_payload[&#34;url&#34;],
                    proxy_url=attachment_payload[&#34;proxy_url&#34;],
                    height=attachment_payload.get(&#34;height&#34;),
                    width=attachment_payload.get(&#34;width&#34;),
                )
                attachments.append(attachment)

        embeds: undefined.UndefinedOr[typing.Sequence[embed_models.Embed]] = undefined.UNDEFINED
        if &#34;embeds&#34; in payload:
            embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

        reactions: undefined.UndefinedOr[typing.MutableSequence[message_models.Reaction]] = undefined.UNDEFINED
        if &#34;reactions&#34; in payload:
            reactions = []
            for reaction_payload in payload[&#34;reactions&#34;]:
                reaction = message_models.Reaction(
                    count=int(reaction_payload[&#34;count&#34;]),
                    emoji=self.deserialize_emoji(reaction_payload[&#34;emoji&#34;]),
                    is_me=reaction_payload[&#34;me&#34;],
                )
                reactions.append(reaction)

        activity: undefined.UndefinedOr[message_models.MessageActivity] = undefined.UNDEFINED
        if &#34;activity&#34; in payload:
            activity_payload = payload[&#34;activity&#34;]
            activity = message_models.MessageActivity(
                type=message_models.MessageActivityType(activity_payload[&#34;type&#34;]),
                party_id=activity_payload.get(&#34;party_id&#34;),
            )

        application: undefined.UndefinedOr[application_models.Application] = undefined.UNDEFINED
        if &#34;application&#34; in payload:
            application = self.deserialize_application(payload[&#34;application&#34;])

        message_reference: undefined.UndefinedOr[message_models.MessageCrosspost] = undefined.UNDEFINED
        if &#34;message_reference&#34; in payload:
            crosspost_payload = payload[&#34;message_reference&#34;]
            message_reference = message_models.MessageCrosspost(
                app=self._app,
                id=snowflakes.Snowflake(crosspost_payload[&#34;message_id&#34;]) if &#34;message_id&#34; in crosspost_payload else None,
                channel_id=snowflakes.Snowflake(crosspost_payload[&#34;channel_id&#34;]),
                guild_id=snowflakes.Snowflake(crosspost_payload[&#34;guild_id&#34;])
                if &#34;guild_id&#34; in crosspost_payload
                else None,
            )

        return message_models.PartialMessage(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=guild_id,
            author=author,
            member=member,
            content=payload[&#34;content&#34;] if &#34;content&#34; in payload else undefined.UNDEFINED,
            timestamp=timestamp,
            edited_timestamp=edited_timestamp,
            is_tts=payload[&#34;tts&#34;] if &#34;tts&#34; in payload else undefined.UNDEFINED,
            is_mentioning_everyone=is_mentioning_everyone,
            user_mentions=user_mentions,
            role_mentions=role_mentions,
            channel_mentions=channel_mentions,
            attachments=attachments,
            embeds=embeds,
            reactions=reactions,
            is_pinned=payload[&#34;pinned&#34;] if &#34;pinned&#34; in payload else undefined.UNDEFINED,
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else undefined.UNDEFINED,
            type=message_models.MessageType(payload[&#34;type&#34;]) if &#34;type&#34; in payload else undefined.UNDEFINED,
            activity=activity,
            application=application,
            message_reference=message_reference,
            flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else undefined.UNDEFINED,
            nonce=payload[&#34;nonce&#34;] if &#34;nonce&#34; in payload else undefined.UNDEFINED,
        )

    def deserialize_message(self, payload: data_binding.JSONObject) -&gt; message_models.Message:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None
        author = self.deserialize_user(payload[&#34;author&#34;])

        member: typing.Optional[guild_models.Member] = None
        if &#34;member&#34; in payload:
            assert guild_id is not None
            member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id, user=author)

        edited_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
            edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)

        user_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mentions&#34;]]
        role_mentions = [snowflakes.Snowflake(mention) for mention in payload[&#34;mention_roles&#34;]]
        channel_mentions = (
            [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mention_channels&#34;]]
            if &#34;mention_channels&#34; in payload
            else []
        )

        attachments = []
        for attachment_payload in payload[&#34;attachments&#34;]:
            attachment = message_models.Attachment(
                id=snowflakes.Snowflake(attachment_payload[&#34;id&#34;]),
                filename=attachment_payload[&#34;filename&#34;],
                size=int(attachment_payload[&#34;size&#34;]),
                url=attachment_payload[&#34;url&#34;],
                proxy_url=attachment_payload[&#34;proxy_url&#34;],
                height=attachment_payload.get(&#34;height&#34;),
                width=attachment_payload.get(&#34;width&#34;),
            )
            attachments.append(attachment)

        embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

        reactions = []
        if &#34;reactions&#34; in payload:
            for reaction_payload in payload[&#34;reactions&#34;]:
                reaction = message_models.Reaction(
                    count=int(reaction_payload[&#34;count&#34;]),
                    emoji=self.deserialize_emoji(reaction_payload[&#34;emoji&#34;]),
                    is_me=reaction_payload[&#34;me&#34;],
                )
                reactions.append(reaction)

        activity: typing.Optional[message_models.MessageActivity] = None
        if &#34;activity&#34; in payload:
            activity_payload = payload[&#34;activity&#34;]
            activity = message_models.MessageActivity(
                type=message_models.MessageActivityType(activity_payload[&#34;type&#34;]),
                party_id=activity_payload.get(&#34;party_id&#34;),
            )

        crosspost: typing.Optional[message_models.MessageCrosspost] = None
        if &#34;message_reference&#34; in payload:
            crosspost_payload = payload[&#34;message_reference&#34;]
            crosspost_id = (
                snowflakes.Snowflake(crosspost_payload[&#34;message_id&#34;]) if &#34;message_id&#34; in crosspost_payload else None
            )
            crosspost = message_models.MessageCrosspost(
                app=self._app,
                id=crosspost_id,
                channel_id=snowflakes.Snowflake(crosspost_payload[&#34;channel_id&#34;]),
                guild_id=snowflakes.Snowflake(crosspost_payload[&#34;guild_id&#34;])
                if &#34;guild_id&#34; in crosspost_payload
                else None,
            )

        return message_models.Message(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=guild_id,
            author=author,
            member=member,
            content=payload[&#34;content&#34;],
            timestamp=time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]),
            edited_timestamp=edited_timestamp,
            is_tts=payload[&#34;tts&#34;],
            is_mentioning_everyone=payload[&#34;mention_everyone&#34;],
            user_mentions=user_mentions,
            role_mentions=role_mentions,
            channel_mentions=channel_mentions,
            attachments=attachments,
            embeds=embeds,
            reactions=reactions,
            is_pinned=payload[&#34;pinned&#34;],
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else None,
            type=message_models.MessageType(payload[&#34;type&#34;]),
            activity=activity,
            application=self.deserialize_application(payload[&#34;application&#34;]) if &#34;application&#34; in payload else None,
            message_reference=crosspost,
            flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else None,
            nonce=payload.get(&#34;nonce&#34;),
        )

    ###################
    # PRESENCE MODELS #
    ###################

    def deserialize_member_presence(  # noqa: CFQ001  # TODO: what&#39;s CFQ001?
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; presence_models.MemberPresence:
        activities = []
        for activity_payload in payload[&#34;activities&#34;]:
            timestamps: typing.Optional[presence_models.ActivityTimestamps] = None
            if &#34;timestamps&#34; in activity_payload:
                timestamps_payload = activity_payload[&#34;timestamps&#34;]
                start = (
                    time.unix_epoch_to_datetime(timestamps_payload[&#34;start&#34;]) if &#34;start&#34; in timestamps_payload else None
                )
                end = time.unix_epoch_to_datetime(timestamps_payload[&#34;end&#34;]) if &#34;end&#34; in timestamps_payload else None
                timestamps = presence_models.ActivityTimestamps(start=start, end=end)

            application_id = (
                snowflakes.Snowflake(activity_payload[&#34;application_id&#34;])
                if &#34;application_id&#34; in activity_payload
                else None
            )

            party: typing.Optional[presence_models.ActivityParty] = None
            if &#34;party&#34; in activity_payload:
                party_payload = activity_payload[&#34;party&#34;]

                current_size: typing.Optional[int]
                max_size: typing.Optional[int]
                if &#34;size&#34; in party_payload:
                    raw_current_size, raw_max_size = party_payload[&#34;size&#34;]
                    current_size = int(raw_current_size)
                    max_size = int(raw_max_size)
                else:
                    current_size = max_size = None

                party = presence_models.ActivityParty(
                    id=party_payload.get(&#34;id&#34;), current_size=current_size, max_size=max_size
                )

            assets: typing.Optional[presence_models.ActivityAssets] = None
            if &#34;assets&#34; in activity_payload:
                assets_payload = activity_payload[&#34;assets&#34;]
                assets = presence_models.ActivityAssets(
                    large_image=assets_payload.get(&#34;large_image&#34;),
                    large_text=assets_payload.get(&#34;large_text&#34;),
                    small_image=assets_payload.get(&#34;small_image&#34;),
                    small_text=assets_payload.get(&#34;small_text&#34;),
                )

            secrets: typing.Optional[presence_models.ActivitySecret] = None
            if &#34;secrets&#34; in activity_payload:
                secrets_payload = activity_payload[&#34;secrets&#34;]
                secrets = presence_models.ActivitySecret(
                    join=secrets_payload.get(&#34;join&#34;),
                    spectate=secrets_payload.get(&#34;spectate&#34;),
                    match=secrets_payload.get(&#34;match&#34;),
                )

            emoji: typing.Optional[emoji_models.Emoji] = None
            raw_emoji = activity_payload.get(&#34;emoji&#34;)
            if raw_emoji is not None:
                emoji = self.deserialize_emoji(raw_emoji)

            activity = presence_models.RichActivity(
                name=activity_payload[&#34;name&#34;],
                type=presence_models.ActivityType(activity_payload[&#34;type&#34;]),
                url=activity_payload.get(&#34;url&#34;),
                created_at=time.unix_epoch_to_datetime(activity_payload[&#34;created_at&#34;]),
                timestamps=timestamps,
                application_id=application_id,
                details=activity_payload.get(&#34;details&#34;),
                state=activity_payload.get(&#34;state&#34;),
                emoji=emoji,
                party=party,
                assets=assets,
                secrets=secrets,
                is_instance=activity_payload.get(&#34;instance&#34;),  # TODO: can we safely default this to False?
                flags=presence_models.ActivityFlag(activity_payload[&#34;flags&#34;]) if &#34;flags&#34; in activity_payload else None,
            )
            activities.append(activity)

        client_status_payload = payload[&#34;client_status&#34;]
        desktop = (
            presence_models.Status(client_status_payload[&#34;desktop&#34;])
            if &#34;desktop&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        mobile = (
            presence_models.Status(client_status_payload[&#34;mobile&#34;])
            if &#34;mobile&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        web = (
            presence_models.Status(client_status_payload[&#34;web&#34;])
            if &#34;web&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        client_status = presence_models.ClientStatus(desktop=desktop, mobile=mobile, web=web)

        return presence_models.MemberPresence(
            app=self._app,
            user_id=snowflakes.Snowflake(payload[&#34;user&#34;][&#34;id&#34;]),
            guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            visible_status=presence_models.Status(payload[&#34;status&#34;]),
            activities=activities,
            client_status=client_status,
        )

    ###############
    # USER MODELS #
    ###############

    @staticmethod
    def _set_user_attributes(payload: data_binding.JSONObject) -&gt; _UserFields:
        return _UserFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            discriminator=payload[&#34;discriminator&#34;],
            username=payload[&#34;username&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            is_bot=payload.get(&#34;bot&#34;, False),
            is_system=payload.get(&#34;system&#34;, False),
        )

    def deserialize_user(self, payload: data_binding.JSONObject) -&gt; user_models.User:
        user_fields = self._set_user_attributes(payload)
        flags = (
            user_models.UserFlag(payload[&#34;public_flags&#34;]) if &#34;public_flags&#34; in payload else user_models.UserFlag.NONE
        )
        return user_models.UserImpl(
            app=self._app,
            id=user_fields.id,
            discriminator=user_fields.discriminator,
            username=user_fields.username,
            avatar_hash=user_fields.avatar_hash,
            is_bot=user_fields.is_bot,
            is_system=user_fields.is_system,
            flags=flags,
        )

    def deserialize_my_user(self, payload: data_binding.JSONObject) -&gt; user_models.OwnUser:
        user_fields = self._set_user_attributes(payload)
        return user_models.OwnUser(
            app=self._app,
            id=user_fields.id,
            discriminator=user_fields.discriminator,
            username=user_fields.username,
            avatar_hash=user_fields.avatar_hash,
            is_bot=user_fields.is_bot,
            is_system=user_fields.is_system,
            is_mfa_enabled=payload[&#34;mfa_enabled&#34;],
            locale=payload.get(&#34;locale&#34;),
            is_verified=payload.get(&#34;verified&#34;),
            email=payload.get(&#34;email&#34;),
            flags=user_models.UserFlag(payload[&#34;flags&#34;]),
            premium_type=user_models.PremiumType(payload[&#34;premium_type&#34;]) if &#34;premium_type&#34; in payload else None,
        )

    ################
    # VOICE MODELS #
    ################

    def deserialize_voice_state(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
        member: undefined.UndefinedOr[guild_models.Member] = undefined.UNDEFINED,
    ) -&gt; voice_models.VoiceState:
        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        channel_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
            channel_id = snowflakes.Snowflake(raw_channel_id)

        if member is undefined.UNDEFINED:
            member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id)

        return voice_models.VoiceState(
            app=self._app,
            guild_id=guild_id,
            channel_id=channel_id,
            user_id=snowflakes.Snowflake(payload[&#34;user_id&#34;]),
            member=member,
            session_id=payload[&#34;session_id&#34;],
            is_guild_deafened=payload[&#34;deaf&#34;],
            is_guild_muted=payload[&#34;mute&#34;],
            is_self_deafened=payload[&#34;self_deaf&#34;],
            is_self_muted=payload[&#34;self_mute&#34;],
            is_streaming=payload.get(&#34;self_stream&#34;, False),
            is_video_enabled=payload[&#34;self_video&#34;],
            is_suppressed=payload[&#34;suppress&#34;],
        )

    def deserialize_voice_region(self, payload: data_binding.JSONObject) -&gt; voice_models.VoiceRegion:
        return voice_models.VoiceRegion(
            id=payload[&#34;id&#34;],
            name=payload[&#34;name&#34;],
            is_vip=payload[&#34;vip&#34;],
            is_optimal_location=payload[&#34;optimal&#34;],
            is_deprecated=payload[&#34;deprecated&#34;],
            is_custom=payload[&#34;custom&#34;],
        )

    ##################
    # WEBHOOK MODELS #
    ##################

    def deserialize_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.Webhook:
        return webhook_models.Webhook(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=webhook_models.WebhookType(payload[&#34;type&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
            name=payload[&#34;name&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            token=payload.get(&#34;token&#34;),
        )</code></pre>
</details>
</div>
</div>
<h2 id="class-heading">Classes</h2>
<section class="definition">
<dl class="no-nest root">
<dt>
<h4><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="EntityFactoryImpl -- Standard implementation for a serializer/deserializer …" href="#hikari.impl.entity_factory.EntityFactoryImpl"
>EntityFactoryImpl</a></h4>
</dt>
<dd>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl" class="hljs python"><abbr title='A standard Python type.'>class</abbr> EntityFactoryImpl (
    app: <a href='../traits.html#hikari.traits.RESTAware'>traits.RESTAware</a>,
): ...</code></pre>
<p>Standard implementation for a serializer/deserializer.</p>
<p>This will convert objects to/from JSON compatible representations.</p>
<div class="sep"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L162-L1851" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">class EntityFactoryImpl(entity_factory.EntityFactory):
    &#34;&#34;&#34;Standard implementation for a serializer/deserializer.

    This will convert objects to/from JSON compatible representations.
    &#34;&#34;&#34;

    __slots__: typing.Sequence[str] = (
        &#34;_app&#34;,
        &#34;_audit_log_entry_converters&#34;,
        &#34;_audit_log_event_mapping&#34;,
        &#34;_dm_channel_type_mapping&#34;,
        &#34;_guild_channel_type_mapping&#34;,
    )

    def __init__(self, app: traits.RESTAware) -&gt; None:
        self._app = app
        self._audit_log_entry_converters: typing.Mapping[str, typing.Callable[[typing.Any], typing.Any]] = {
            audit_log_models.AuditLogChangeKey.OWNER_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.AFK_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.AFK_TIMEOUT: _deserialize_seconds_timedelta,
            audit_log_models.AuditLogChangeKey.MFA_LEVEL: guild_models.GuildMFALevel,
            audit_log_models.AuditLogChangeKey.VERIFICATION_LEVEL: guild_models.GuildVerificationLevel,
            audit_log_models.AuditLogChangeKey.EXPLICIT_CONTENT_FILTER: guild_models.GuildExplicitContentFilterLevel,
            audit_log_models.AuditLogChangeKey.DEFAULT_MESSAGE_NOTIFICATIONS: guild_models.GuildMessageNotificationsLevel,
            # noqa: E501 - Line too long
            audit_log_models.AuditLogChangeKey.PRUNE_DELETE_DAYS: _deserialize_day_timedelta,
            audit_log_models.AuditLogChangeKey.WIDGET_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.POSITION: int,
            audit_log_models.AuditLogChangeKey.BITRATE: int,
            audit_log_models.AuditLogChangeKey.APPLICATION_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.PERMISSIONS: permission_models.Permissions,
            audit_log_models.AuditLogChangeKey.COLOR: color_models.Color,
            audit_log_models.AuditLogChangeKey.ALLOW: permission_models.Permissions,
            audit_log_models.AuditLogChangeKey.DENY: permission_models.Permissions,
            audit_log_models.AuditLogChangeKey.CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.INVITER_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.MAX_USES: _deserialize_max_uses,
            audit_log_models.AuditLogChangeKey.USES: int,
            audit_log_models.AuditLogChangeKey.MAX_AGE: _deserialize_max_age,
            audit_log_models.AuditLogChangeKey.ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.TYPE: str,
            audit_log_models.AuditLogChangeKey.ENABLE_EMOTICONS: bool,
            audit_log_models.AuditLogChangeKey.EXPIRE_BEHAVIOR: guild_models.IntegrationExpireBehaviour,
            audit_log_models.AuditLogChangeKey.EXPIRE_GRACE_PERIOD: _deserialize_day_timedelta,
            audit_log_models.AuditLogChangeKey.RATE_LIMIT_PER_USER: _deserialize_seconds_timedelta,
            audit_log_models.AuditLogChangeKey.SYSTEM_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.ADD_ROLE_TO_MEMBER: self._deserialize_audit_log_change_roles,
            audit_log_models.AuditLogChangeKey.REMOVE_ROLE_FROM_MEMBER: self._deserialize_audit_log_change_roles,
            audit_log_models.AuditLogChangeKey.PERMISSION_OVERWRITES: self._deserialize_audit_log_overwrites,
        }
        self._audit_log_event_mapping: typing.Mapping[
            typing.Union[int, audit_log_models.AuditLogEventType],
            typing.Callable[[data_binding.JSONObject], audit_log_models.BaseAuditLogEntryInfo],
        ] = {
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_CREATE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_UPDATE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_DELETE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_PIN: self._deserialize_message_pin_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_UNPIN: self._deserialize_message_pin_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_PRUNE: self._deserialize_member_prune_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_BULK_DELETE: self._deserialize_message_bulk_delete_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_DELETE: self._deserialize_message_delete_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_DISCONNECT: self._deserialize_member_disconnect_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_MOVE: self._deserialize_member_move_entry_info,
        }
        self._dm_channel_type_mapping = {
            channel_models.ChannelType.DM: self.deserialize_dm,
            channel_models.ChannelType.GROUP_DM: self.deserialize_group_dm,
        }
        self._guild_channel_type_mapping = {
            channel_models.ChannelType.GUILD_CATEGORY: self.deserialize_guild_category,
            channel_models.ChannelType.GUILD_TEXT: self.deserialize_guild_text_channel,
            channel_models.ChannelType.GUILD_NEWS: self.deserialize_guild_news_channel,
            channel_models.ChannelType.GUILD_STORE: self.deserialize_guild_store_channel,
            channel_models.ChannelType.GUILD_VOICE: self.deserialize_guild_voice_channel,
        }

    ######################
    # APPLICATION MODELS #
    ######################

    def deserialize_own_connection(self, payload: data_binding.JSONObject) -&gt; application_models.OwnConnection:
        if (integration_payloads := payload.get(&#34;integrations&#34;)) is not None:
            integrations = [self.deserialize_partial_integration(integration) for integration in integration_payloads]
        else:
            integrations = []

        return application_models.OwnConnection(
            id=payload[&#34;id&#34;],
            name=payload[&#34;name&#34;],
            type=payload[&#34;type&#34;],
            is_revoked=payload[&#34;revoked&#34;],
            integrations=integrations,
            is_verified=payload[&#34;verified&#34;],
            is_friend_sync_enabled=payload[&#34;friend_sync&#34;],
            is_activity_visible=payload[&#34;show_activity&#34;],
            visibility=application_models.ConnectionVisibility(payload[&#34;visibility&#34;]),
        )

    def deserialize_own_guild(self, payload: data_binding.JSONObject) -&gt; application_models.OwnGuild:
        guild_fields = self._set_partial_guild_attributes(payload)
        return application_models.OwnGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            is_owner=bool(payload[&#34;owner&#34;]),
            my_permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
        )

    def deserialize_application(self, payload: data_binding.JSONObject) -&gt; application_models.Application:
        team: typing.Optional[application_models.Team] = None
        if (team_payload := payload.get(&#34;team&#34;)) is not None:
            members = {}
            for member_payload in team_payload[&#34;members&#34;]:
                team_member = application_models.TeamMember(
                    app=self._app,
                    membership_state=application_models.TeamMembershipState(member_payload[&#34;membership_state&#34;]),
                    permissions=member_payload[&#34;permissions&#34;],
                    team_id=snowflakes.Snowflake(member_payload[&#34;team_id&#34;]),
                    user=self.deserialize_user(member_payload[&#34;user&#34;]),
                )
                members[team_member.user.id] = team_member

            team = application_models.Team(
                app=self._app,
                id=snowflakes.Snowflake(team_payload[&#34;id&#34;]),
                icon_hash=team_payload[&#34;icon&#34;],
                members=members,
                owner_id=snowflakes.Snowflake(team_payload[&#34;owner_user_id&#34;]),
            )

        primary_sku_id = snowflakes.Snowflake(payload[&#34;primary_sku_id&#34;]) if &#34;primary_sku_id&#34; in payload else None

        return application_models.Application(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            is_bot_public=payload.get(&#34;bot_public&#34;),
            is_bot_code_grant_required=payload.get(&#34;bot_require_code_grant&#34;),
            owner=self.deserialize_user(payload[&#34;owner&#34;]) if &#34;owner&#34; in payload else None,
            rpc_origins=payload[&#34;rpc_origins&#34;] if &#34;rpc_origins&#34; in payload else None,
            summary=payload[&#34;summary&#34;],
            verify_key=bytes(payload[&#34;verify_key&#34;], &#34;utf-8&#34;) if &#34;verify_key&#34; in payload else None,
            icon_hash=payload.get(&#34;icon&#34;),
            team=team,
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
            primary_sku_id=primary_sku_id,
            slug=payload.get(&#34;slug&#34;),
            cover_image_hash=payload.get(&#34;cover_image&#34;),
        )

    #####################
    # AUDIT LOGS MODELS #
    #####################

    def _deserialize_audit_log_change_roles(
        self, payload: data_binding.JSONArray
    ) -&gt; typing.Mapping[snowflakes.Snowflake, guild_models.PartialRole]:
        roles = {}
        for role_payload in payload:
            role = guild_models.PartialRole(
                app=self._app, id=snowflakes.Snowflake(role_payload[&#34;id&#34;]), name=role_payload[&#34;name&#34;]
            )
            roles[role.id] = role

        return roles

    def _deserialize_audit_log_overwrites(
        self, payload: data_binding.JSONArray
    ) -&gt; typing.Mapping[snowflakes.Snowflake, channel_models.PermissionOverwrite]:
        return {
            snowflakes.Snowflake(overwrite[&#34;id&#34;]): self.deserialize_permission_overwrite(overwrite)
            for overwrite in payload
        }

    @staticmethod
    def _deserialize_channel_overwrite_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.ChannelOverwriteEntryInfo:
        return audit_log_models.ChannelOverwriteEntryInfo(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=channel_models.PermissionOverwriteType(payload[&#34;type&#34;]),
            role_name=payload.get(&#34;role_name&#34;),
        )

    @staticmethod
    def _deserialize_message_pin_entry_info(payload: data_binding.JSONObject) -&gt; audit_log_models.MessagePinEntryInfo:
        return audit_log_models.MessagePinEntryInfo(
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            message_id=snowflakes.Snowflake(payload[&#34;message_id&#34;]),
        )

    @staticmethod
    def _deserialize_member_prune_entry_info(payload: data_binding.JSONObject) -&gt; audit_log_models.MemberPruneEntryInfo:
        return audit_log_models.MemberPruneEntryInfo(
            delete_member_days=datetime.timedelta(days=int(payload[&#34;delete_member_days&#34;])),
            members_removed=int(payload[&#34;members_removed&#34;]),
        )

    @staticmethod
    def _deserialize_message_bulk_delete_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.MessageBulkDeleteEntryInfo:
        return audit_log_models.MessageBulkDeleteEntryInfo(count=int(payload[&#34;count&#34;]))

    @staticmethod
    def _deserialize_message_delete_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.MessageDeleteEntryInfo:
        return audit_log_models.MessageDeleteEntryInfo(
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]), count=int(payload[&#34;count&#34;])
        )

    @staticmethod
    def _deserialize_member_disconnect_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.MemberDisconnectEntryInfo:
        return audit_log_models.MemberDisconnectEntryInfo(count=int(payload[&#34;count&#34;]))

    @staticmethod
    def _deserialize_member_move_entry_info(payload: data_binding.JSONObject) -&gt; audit_log_models.MemberMoveEntryInfo:
        return audit_log_models.MemberMoveEntryInfo(
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]), count=int(payload[&#34;count&#34;])
        )

    @staticmethod
    def _deserialize_unrecognised_audit_log_entry_info(
        payload: data_binding.JSONObject,
    ) -&gt; audit_log_models.UnrecognisedAuditLogEntryInfo:
        return audit_log_models.UnrecognisedAuditLogEntryInfo(payload)

    def deserialize_audit_log(self, payload: data_binding.JSONObject) -&gt; audit_log_models.AuditLog:
        entries = {}
        for entry_payload in payload[&#34;audit_log_entries&#34;]:
            entry_id = snowflakes.Snowflake(entry_payload[&#34;id&#34;])

            changes = []
            if (change_payloads := entry_payload.get(&#34;changes&#34;)) is not None:
                for change_payload in change_payloads:
                    key: typing.Union[audit_log_models.AuditLogChangeKey, str]
                    key = audit_log_models.AuditLogChangeKey(change_payload[&#34;key&#34;])

                    new_value: typing.Any = change_payload.get(&#34;new_value&#34;)
                    old_value: typing.Any = change_payload.get(&#34;old_value&#34;)
                    if value_converter := self._audit_log_entry_converters.get(key):
                        new_value = value_converter(new_value) if new_value is not None else None
                        old_value = value_converter(old_value) if old_value is not None else None

                    changes.append(audit_log_models.AuditLogChange(key=key, new_value=new_value, old_value=old_value))

            target_id: typing.Optional[snowflakes.Snowflake] = None
            if (raw_target_id := entry_payload[&#34;target_id&#34;]) is not None:
                target_id = snowflakes.Snowflake(raw_target_id)

            user_id: typing.Optional[snowflakes.Snowflake] = None
            if (raw_user_id := entry_payload[&#34;user_id&#34;]) is not None:
                user_id = snowflakes.Snowflake(raw_user_id)

            action_type: typing.Union[audit_log_models.AuditLogEventType, int]
            action_type = audit_log_models.AuditLogEventType(entry_payload[&#34;action_type&#34;])

            options: typing.Optional[audit_log_models.BaseAuditLogEntryInfo] = None
            if (raw_option := entry_payload.get(&#34;options&#34;)) is not None:
                option_converter = (
                    self._audit_log_event_mapping.get(action_type)
                    or self._deserialize_unrecognised_audit_log_entry_info  # noqa: W503
                )
                options = option_converter(raw_option)

            entries[entry_id] = audit_log_models.AuditLogEntry(
                app=self._app,
                id=entry_id,
                target_id=target_id,
                changes=changes,
                user_id=user_id,
                action_type=action_type,
                options=options,
                reason=entry_payload.get(&#34;reason&#34;),
            )

        integrations = {
            snowflakes.Snowflake(integration[&#34;id&#34;]): self.deserialize_partial_integration(integration)
            for integration in payload[&#34;integrations&#34;]
        }
        users = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;users&#34;]}
        webhooks = {
            snowflakes.Snowflake(webhook[&#34;id&#34;]): self.deserialize_webhook(webhook) for webhook in payload[&#34;webhooks&#34;]
        }
        return audit_log_models.AuditLog(entries=entries, integrations=integrations, users=users, webhooks=webhooks)

    ##################
    # CHANNEL MODELS #
    ##################

    def deserialize_channel_follow(self, payload: data_binding.JSONObject) -&gt; channel_models.ChannelFollow:
        return channel_models.ChannelFollow(
            app=self._app,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]),
        )

    def deserialize_permission_overwrite(self, payload: data_binding.JSONObject) -&gt; channel_models.PermissionOverwrite:
        return channel_models.PermissionOverwrite(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=channel_models.PermissionOverwriteType(payload[&#34;type&#34;]),
            allow=permission_models.Permissions(int(payload[&#34;allow&#34;])),
            deny=permission_models.Permissions(int(payload[&#34;deny&#34;])),
        )

    def serialize_permission_overwrite(self, overwrite: channel_models.PermissionOverwrite) -&gt; data_binding.JSONObject:
        # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
        # allow and deny can be strings instead now.
        return {
            &#34;id&#34;: str(overwrite.id),
            &#34;type&#34;: overwrite.type,
            &#34;allow&#34;: str(int(overwrite.allow)),
            &#34;deny&#34;: str(int(overwrite.deny)),
        }

    def deserialize_partial_channel(self, payload: data_binding.JSONObject) -&gt; channel_models.PartialChannel:
        return channel_models.PartialChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
        )

    def deserialize_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.DMChannel:
        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        return channel_models.DMChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            last_message_id=last_message_id,
            recipient=self.deserialize_user(payload[&#34;recipients&#34;][0]),
        )

    def deserialize_group_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.GroupDMChannel:
        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        if (raw_nicks := payload.get(&#34;nicks&#34;)) is not None:
            nicknames = {snowflakes.Snowflake(entry[&#34;id&#34;]): entry[&#34;nick&#34;] for entry in raw_nicks}
        else:
            nicknames = {}

        recipients = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;recipients&#34;]}

        return channel_models.GroupDMChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            last_message_id=last_message_id,
            owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
            icon_hash=payload[&#34;icon&#34;],
            nicknames=nicknames,
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
            recipients=recipients,
        )

    def _set_guild_channel_attributes(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake],
    ) -&gt; _GuildChannelFields:
        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        permission_overwrites = {
            snowflakes.Snowflake(overwrite[&#34;id&#34;]): self.deserialize_permission_overwrite(overwrite)
            for overwrite in payload[&#34;permission_overwrites&#34;]
        }  # TODO: while snowflakes are guaranteed to be unique within their own resource, there is no guarantee for
        # across between resources (user and role in this case); while in practice we will not get overlap there is a
        # chance that this may happen in the future, would it be more sensible to use a Sequence here?

        parent_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_parent_id := payload.get(&#34;parent_id&#34;)) is not None:
            parent_id = snowflakes.Snowflake(raw_parent_id)

        return _GuildChannelFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            guild_id=guild_id,
            position=int(payload[&#34;position&#34;]),
            permission_overwrites=permission_overwrites,
            is_nsfw=payload.get(&#34;nsfw&#34;),
            parent_id=parent_id,
        )

    def deserialize_guild_category(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildCategory:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildCategory(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
        )

    def deserialize_guild_text_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildTextChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        last_pin_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
            last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

        return channel_models.GuildTextChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            topic=payload[&#34;topic&#34;],
            last_message_id=last_message_id,
            # Usually this is 0 if unset, but some old channels made before the
            # rate_limit_per_user field was implemented will not have this field
            # at all if they have never had the rate limit changed...
            rate_limit_per_user=datetime.timedelta(seconds=payload.get(&#34;rate_limit_per_user&#34;, 0)),
            last_pin_timestamp=last_pin_timestamp,
        )

    def deserialize_guild_news_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildNewsChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        last_pin_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
            last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

        return channel_models.GuildNewsChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            topic=payload[&#34;topic&#34;],
            last_message_id=last_message_id,
            last_pin_timestamp=last_pin_timestamp,
        )

    def deserialize_guild_store_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildStoreChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildStoreChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
        )

    def deserialize_guild_voice_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildVoiceChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildVoiceChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            bitrate=int(payload[&#34;bitrate&#34;]),
            user_limit=int(payload[&#34;user_limit&#34;]),
        )

    def deserialize_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.PartialChannel:
        channel_type = payload[&#34;type&#34;]
        if channel_model := self._guild_channel_type_mapping.get(channel_type):
            return channel_model(payload, guild_id=guild_id)

        return self._dm_channel_type_mapping[channel_type](payload)

    ################
    # EMBED MODELS #
    ################

    def deserialize_embed(self, payload: data_binding.JSONObject) -&gt; embed_models.Embed:
        # Keep these separate to aid debugging later.
        title = payload.get(&#34;title&#34;)
        description = payload.get(&#34;description&#34;)
        url = payload.get(&#34;url&#34;)
        color = color_models.Color(payload[&#34;color&#34;]) if &#34;color&#34; in payload else None
        timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]) if &#34;timestamp&#34; in payload else None
        fields: typing.Optional[typing.MutableSequence[embed_models.EmbedField]] = None

        image: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
        if image_payload := payload.get(&#34;image&#34;):
            image = embed_models.EmbedImage(
                resource=files.ensure_resource(image_payload.get(&#34;url&#34;)),
                proxy_resource=files.ensure_resource(image_payload.get(&#34;proxy_url&#34;)),
                height=image_payload.get(&#34;height&#34;),
                width=image_payload.get(&#34;width&#34;),
            )

        thumbnail: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
        if thumbnail_payload := payload.get(&#34;thumbnail&#34;):
            thumbnail = embed_models.EmbedImage(
                resource=files.ensure_resource(thumbnail_payload.get(&#34;url&#34;)),
                proxy_resource=files.ensure_resource(thumbnail_payload.get(&#34;proxy_url&#34;)),
                height=thumbnail_payload.get(&#34;height&#34;),
                width=thumbnail_payload.get(&#34;width&#34;),
            )

        video: typing.Optional[embed_models.EmbedVideo[files.AsyncReader]] = None
        if video_payload := payload.get(&#34;video&#34;):
            video = embed_models.EmbedVideo(
                resource=files.ensure_resource(video_payload.get(&#34;url&#34;)),
                height=video_payload.get(&#34;height&#34;),
                width=video_payload.get(&#34;width&#34;),
            )

        provider: typing.Optional[embed_models.EmbedProvider] = None
        if provider_payload := payload.get(&#34;provider&#34;):
            provider = embed_models.EmbedProvider(name=provider_payload.get(&#34;name&#34;), url=provider_payload.get(&#34;url&#34;))

        icon: typing.Optional[embed_models.EmbedResourceWithProxy[files.AsyncReader]]
        author: typing.Optional[embed_models.EmbedAuthor] = None
        if author_payload := payload.get(&#34;author&#34;):
            icon = None
            if &#34;icon_url&#34; in author_payload:
                icon = embed_models.EmbedResourceWithProxy(
                    resource=files.ensure_resource(author_payload.get(&#34;icon_url&#34;)),
                    proxy_resource=files.ensure_resource(author_payload.get(&#34;proxy_icon_url&#34;)),
                )

            author = embed_models.EmbedAuthor(
                name=author_payload.get(&#34;name&#34;),
                url=author_payload.get(&#34;url&#34;),
                icon=icon,
            )

        footer: typing.Optional[embed_models.EmbedFooter] = None
        if footer_payload := payload.get(&#34;footer&#34;):
            icon = None
            if &#34;icon_url&#34; in footer_payload:
                icon = embed_models.EmbedResourceWithProxy(
                    resource=files.ensure_resource(footer_payload.get(&#34;icon_url&#34;)),
                    proxy_resource=files.ensure_resource(footer_payload.get(&#34;proxy_icon_url&#34;)),
                )

            footer = embed_models.EmbedFooter(text=footer_payload.get(&#34;text&#34;), icon=icon)

        if fields_array := payload.get(&#34;fields&#34;):
            fields = []
            for field_payload in fields_array:
                field = embed_models.EmbedField(
                    name=field_payload[&#34;name&#34;],
                    value=field_payload[&#34;value&#34;],
                    inline=field_payload.get(&#34;inline&#34;, False),
                )
                fields.append(field)

        return embed_models.Embed.from_received_embed(
            title=title,
            description=description,
            url=url,
            color=color,
            timestamp=timestamp,
            image=image,
            thumbnail=thumbnail,
            video=video,
            provider=provider,
            author=author,
            footer=footer,
            fields=fields,
        )

    def serialize_embed(  # noqa: C901
        self,
        embed: embed_models.Embed,
    ) -&gt; typing.Tuple[data_binding.JSONObject, typing.List[files.Resource[files.AsyncReader]]]:

        payload: data_binding.JSONObject = {}
        uploads: typing.List[files.Resource[files.AsyncReader]] = []

        if embed.title is not None:
            payload[&#34;title&#34;] = embed.title

        if embed.description is not None:
            payload[&#34;description&#34;] = embed.description

        if embed.url is not None:
            payload[&#34;url&#34;] = embed.url

        if embed.timestamp is not None:
            payload[&#34;timestamp&#34;] = embed.timestamp.isoformat()

        if embed.color is not None:
            payload[&#34;color&#34;] = int(embed.color)

        if embed.footer is not None:
            footer_payload: data_binding.JSONObject = {}

            if embed.footer.text is not None:
                footer_payload[&#34;text&#34;] = embed.footer.text

            if embed.footer.icon is not None:
                if not isinstance(embed.footer.icon.resource, files.WebResource):
                    uploads.append(embed.footer.icon.resource)

                footer_payload[&#34;icon_url&#34;] = embed.footer.icon.url

            payload[&#34;footer&#34;] = footer_payload

        if embed.image is not None:
            image_payload: data_binding.JSONObject = {}

            if not isinstance(embed.image.resource, files.WebResource):
                uploads.append(embed.image.resource)

            image_payload[&#34;url&#34;] = embed.image.url
            payload[&#34;image&#34;] = image_payload

        if embed.thumbnail is not None:
            thumbnail_payload: data_binding.JSONObject = {}

            if not isinstance(embed.thumbnail.resource, files.WebResource):
                uploads.append(embed.thumbnail.resource)

            thumbnail_payload[&#34;url&#34;] = embed.thumbnail.url
            payload[&#34;thumbnail&#34;] = thumbnail_payload

        if embed.author is not None:
            author_payload: data_binding.JSONObject = {}

            if embed.author.name is not None:
                author_payload[&#34;name&#34;] = embed.author.name

            if embed.author.url is not None:
                author_payload[&#34;url&#34;] = embed.author.url

            if embed.author.icon is not None:
                if not isinstance(embed.author.icon.resource, files.WebResource):
                    uploads.append(embed.author.icon.resource)
                author_payload[&#34;icon_url&#34;] = embed.author.icon.url

            payload[&#34;author&#34;] = author_payload

        if embed.fields:
            field_payloads: data_binding.JSONArray = []
            for i, field in enumerate(embed.fields):

                # Yep, this is technically two unreachable branches. However, this is an incredibly
                # common mistake to make when working with embeds and not using a static type
                # checker, so I have added these as additional safeguards for UX and ease
                # of debugging. The case that there are `None` should be detected immediately by
                # static type checkers, regardless.

                name = str(field.name) if field.name is not None else None  # type: ignore[unreachable]
                value = str(field.value) if field.value is not None else None  # type: ignore[unreachable]

                if name is None:
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have `None`&#34;)
                if not name:
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have empty string&#34;)
                if not name.strip():
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have only whitespace&#34;)

                if value is None:
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have `None`&#34;)
                if not value:
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have empty string&#34;)
                if not value.strip():
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have only whitespace&#34;)

                # Name and value always have to be specified; we can always
                # send a default `inline` value also just to keep this simpler.
                field_payloads.append({&#34;name&#34;: name, &#34;value&#34;: value, &#34;inline&#34;: field.is_inline})
            payload[&#34;fields&#34;] = field_payloads

        return payload, uploads

    ################
    # EMOJI MODELS #
    ################

    def deserialize_unicode_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.UnicodeEmoji:
        return emoji_models.UnicodeEmoji(name=payload[&#34;name&#34;])

    def deserialize_custom_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.CustomEmoji:
        return emoji_models.CustomEmoji(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            is_animated=payload.get(&#34;animated&#34;, False),
        )

    def deserialize_known_custom_emoji(
        self, payload: data_binding.JSONObject, *, guild_id: snowflakes.Snowflake
    ) -&gt; emoji_models.KnownCustomEmoji:
        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]] if &#34;roles&#34; in payload else []

        user: typing.Optional[user_models.User] = None
        if (raw_user := payload.get(&#34;user&#34;)) is not None:
            user = self.deserialize_user(raw_user)

        return emoji_models.KnownCustomEmoji(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            is_animated=payload.get(&#34;animated&#34;, False),
            guild_id=guild_id,
            role_ids=role_ids,
            user=user,
            is_colons_required=payload[&#34;require_colons&#34;],
            is_managed=payload[&#34;managed&#34;],
            is_available=payload[&#34;available&#34;],
        )

    def deserialize_emoji(
        self, payload: data_binding.JSONObject
    ) -&gt; typing.Union[emoji_models.UnicodeEmoji, emoji_models.CustomEmoji]:
        if payload.get(&#34;id&#34;) is not None:
            return self.deserialize_custom_emoji(payload)

        return self.deserialize_unicode_emoji(payload)

    ##################
    # GATEWAY MODELS #
    ##################

    def deserialize_gateway_bot(self, payload: data_binding.JSONObject) -&gt; gateway_models.GatewayBot:
        session_start_limit_payload = payload[&#34;session_start_limit&#34;]
        session_start_limit = gateway_models.SessionStartLimit(
            total=int(session_start_limit_payload[&#34;total&#34;]),
            remaining=int(session_start_limit_payload[&#34;remaining&#34;]),
            reset_after=datetime.timedelta(milliseconds=session_start_limit_payload[&#34;reset_after&#34;]),
            # I do not trust that this may never be zero for some unknown reason. If it was 0, it
            # would hang the application on start up, so I enforce it is at least 1.
            max_concurrency=max(session_start_limit_payload.get(&#34;max_concurrency&#34;, 0), 1),
        )
        return gateway_models.GatewayBot(
            url=payload[&#34;url&#34;],
            shard_count=int(payload[&#34;shards&#34;]),
            session_start_limit=session_start_limit,
        )

    ################
    # GUILD MODELS #
    ################

    def deserialize_guild_widget(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildWidget:
        channel_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
            channel_id = snowflakes.Snowflake(raw_channel_id)

        return guild_models.GuildWidget(app=self._app, channel_id=channel_id, is_enabled=payload[&#34;enabled&#34;])

    def deserialize_member(
        self,
        payload: data_binding.JSONObject,
        *,
        user: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; guild_models.Member:
        if user is undefined.UNDEFINED:
            user = self.deserialize_user(payload[&#34;user&#34;])

        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]]
        # If Discord ever does start including this here without warning we don&#39;t want to duplicate the entry.
        if guild_id not in role_ids:
            role_ids.append(guild_id)

        joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;])

        raw_premium_since = payload.get(&#34;premium_since&#34;)
        premium_since = (
            time.iso8601_datetime_string_to_datetime(raw_premium_since) if raw_premium_since is not None else None
        )

        return guild_models.Member(
            user=user,
            guild_id=guild_id,
            role_ids=role_ids,
            joined_at=joined_at,
            nickname=payload[&#34;nick&#34;] if &#34;nick&#34; in payload else undefined.UNDEFINED,
            premium_since=premium_since,
            is_deaf=payload[&#34;deaf&#34;] if &#34;deaf&#34; in payload else undefined.UNDEFINED,
            is_mute=payload[&#34;mute&#34;] if &#34;mute&#34; in payload else undefined.UNDEFINED,
        )

    def deserialize_role(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: snowflakes.Snowflake,
    ) -&gt; guild_models.Role:
        return guild_models.Role(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            guild_id=guild_id,
            name=payload[&#34;name&#34;],
            color=color_models.Color(payload[&#34;color&#34;]),
            is_hoisted=payload[&#34;hoist&#34;],
            position=int(payload[&#34;position&#34;]),
            # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
            permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
            is_managed=payload[&#34;managed&#34;],
            is_mentionable=payload[&#34;mentionable&#34;],
        )

    @staticmethod
    def _set_partial_integration_attributes(payload: data_binding.JSONObject) -&gt; _IntegrationFields:
        account_payload = payload[&#34;account&#34;]
        account = guild_models.IntegrationAccount(id=account_payload[&#34;id&#34;], name=account_payload[&#34;name&#34;])
        return _IntegrationFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            type=payload[&#34;type&#34;],
            account=account,
        )

    def deserialize_partial_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.PartialIntegration:
        integration_fields = self._set_partial_integration_attributes(payload)
        return guild_models.PartialIntegration(
            id=integration_fields.id,
            name=integration_fields.name,
            type=integration_fields.type,
            account=integration_fields.account,
        )

    def deserialize_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.Integration:
        integration_fields = self._set_partial_integration_attributes(payload)

        role_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_role_id := payload.get(&#34;role_id&#34;)) is not None:
            role_id = snowflakes.Snowflake(raw_role_id)

        last_synced_at: typing.Optional[datetime.datetime] = None
        if (raw_last_synced_at := payload.get(&#34;synced_at&#34;)) is not None:
            last_synced_at = time.iso8601_datetime_string_to_datetime(raw_last_synced_at)

        return guild_models.Integration(
            id=integration_fields.id,
            name=integration_fields.name,
            type=integration_fields.type,
            account=integration_fields.account,
            is_enabled=payload[&#34;enabled&#34;],
            is_syncing=payload[&#34;syncing&#34;],
            role_id=role_id,
            is_emojis_enabled=payload.get(&#34;enable_emoticons&#34;),
            expire_behavior=guild_models.IntegrationExpireBehaviour(payload[&#34;expire_behavior&#34;]),
            expire_grace_period=datetime.timedelta(days=payload[&#34;expire_grace_period&#34;]),
            user=self.deserialize_user(payload[&#34;user&#34;]),
            last_synced_at=last_synced_at,
        )

    def deserialize_guild_member_ban(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildMemberBan:
        return guild_models.GuildMemberBan(reason=payload[&#34;reason&#34;], user=self.deserialize_user(payload[&#34;user&#34;]))

    @staticmethod
    def _set_partial_guild_attributes(payload: data_binding.JSONObject) -&gt; _PartialGuildFields:
        features = []
        for feature in payload[&#34;features&#34;]:
            features.append(guild_models.GuildFeature(feature))

        return _PartialGuildFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            icon_hash=payload[&#34;icon&#34;],
            features=features,
        )

    def deserialize_guild_preview(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildPreview:
        guild_fields = self._set_partial_guild_attributes(payload)
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
            for emoji in payload[&#34;emojis&#34;]
        }
        return guild_models.GuildPreview(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=payload[&#34;splash&#34;],
            discovery_splash_hash=payload[&#34;discovery_splash&#34;],
            emojis=emojis,
            approximate_active_member_count=int(payload[&#34;approximate_presence_count&#34;]),
            approximate_member_count=int(payload[&#34;approximate_member_count&#34;]),
            description=payload[&#34;description&#34;],
        )

    def _set_guild_attributes(self, payload: data_binding.JSONObject) -&gt; _GuildFields:
        guild_fields = self._set_partial_guild_attributes(payload)
        afk_channel_id = payload[&#34;afk_channel_id&#34;]
        default_message_notifications = guild_models.GuildMessageNotificationsLevel(
            payload[&#34;default_message_notifications&#34;]
        )
        application_id = payload[&#34;application_id&#34;]
        widget_channel_id = payload.get(&#34;widget_channel_id&#34;)
        system_channel_id = payload[&#34;system_channel_id&#34;]
        rules_channel_id = payload[&#34;rules_channel_id&#34;]
        max_video_channel_users = (
            int(payload[&#34;max_video_channel_users&#34;]) if &#34;max_video_channel_users&#34; in payload else None
        )
        public_updates_channel_id = payload[&#34;public_updates_channel_id&#34;]
        public_updates_channel_id = (
            snowflakes.Snowflake(public_updates_channel_id) if public_updates_channel_id is not None else None
        )
        return _GuildFields(
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=payload[&#34;splash&#34;],
            # This is documented as always being present, but we have found old guilds where this is
            # not present. Quicker to just assume the documentation is wrong at this point than try
            # to contest whether this is right or not with Discord.
            discovery_splash_hash=payload.get(&#34;discovery_splash&#34;),
            owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
            region=payload[&#34;region&#34;],
            afk_channel_id=snowflakes.Snowflake(afk_channel_id) if afk_channel_id is not None else None,
            afk_timeout=datetime.timedelta(seconds=payload[&#34;afk_timeout&#34;]),
            verification_level=guild_models.GuildVerificationLevel(payload[&#34;verification_level&#34;]),
            default_message_notifications=default_message_notifications,
            explicit_content_filter=guild_models.GuildExplicitContentFilterLevel(payload[&#34;explicit_content_filter&#34;]),
            mfa_level=guild_models.GuildMFALevel(payload[&#34;mfa_level&#34;]),
            application_id=snowflakes.Snowflake(application_id) if application_id is not None else None,
            widget_channel_id=snowflakes.Snowflake(widget_channel_id) if widget_channel_id is not None else None,
            system_channel_id=snowflakes.Snowflake(system_channel_id) if system_channel_id is not None else None,
            is_widget_enabled=payload[&#34;widget_enabled&#34;] if &#34;widget_enabled&#34; in payload else None,
            system_channel_flags=guild_models.GuildSystemChannelFlag(payload[&#34;system_channel_flags&#34;]),
            rules_channel_id=snowflakes.Snowflake(rules_channel_id) if rules_channel_id is not None else None,
            max_video_channel_users=max_video_channel_users,
            vanity_url_code=payload[&#34;vanity_url_code&#34;],
            description=payload[&#34;description&#34;],
            banner_hash=payload[&#34;banner&#34;],
            premium_tier=guild_models.GuildPremiumTier(payload[&#34;premium_tier&#34;]),
            premium_subscription_count=payload.get(&#34;premium_subscription_count&#34;),
            preferred_locale=payload[&#34;preferred_locale&#34;],
            public_updates_channel_id=public_updates_channel_id,
        )

    def deserialize_rest_guild(self, payload: data_binding.JSONObject) -&gt; guild_models.RESTGuild:
        guild_fields = self._set_guild_attributes(payload)
        approximate_member_count = int(payload[&#34;approximate_member_count&#34;])
        approximate_active_member_count = int(payload[&#34;approximate_presence_count&#34;])
        max_members = int(payload[&#34;max_members&#34;])

        raw_max_presences = payload[&#34;max_presences&#34;]
        if raw_max_presences is None:
            max_presences = _DEFAULT_MAX_PRESENCES
        else:
            max_presences = int(raw_max_presences)

        roles = {
            snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild_fields.id)
            for role in payload[&#34;roles&#34;]
        }
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
            for emoji in payload[&#34;emojis&#34;]
        }
        guild = guild_models.RESTGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=guild_fields.splash_hash,
            discovery_splash_hash=guild_fields.discovery_splash_hash,
            owner_id=guild_fields.owner_id,
            region=guild_fields.region,
            afk_channel_id=guild_fields.afk_channel_id,
            afk_timeout=guild_fields.afk_timeout,
            verification_level=guild_fields.verification_level,
            default_message_notifications=guild_fields.default_message_notifications,
            explicit_content_filter=guild_fields.explicit_content_filter,
            mfa_level=guild_fields.mfa_level,
            application_id=guild_fields.application_id,
            widget_channel_id=guild_fields.widget_channel_id,
            system_channel_id=guild_fields.system_channel_id,
            is_widget_enabled=guild_fields.is_widget_enabled,
            system_channel_flags=guild_fields.system_channel_flags,
            rules_channel_id=guild_fields.rules_channel_id,
            max_presences=max_presences,
            max_members=max_members,
            max_video_channel_users=guild_fields.max_video_channel_users,
            vanity_url_code=guild_fields.vanity_url_code,
            description=guild_fields.description,
            banner_hash=guild_fields.banner_hash,
            premium_tier=guild_fields.premium_tier,
            premium_subscription_count=guild_fields.premium_subscription_count,
            preferred_locale=guild_fields.preferred_locale,
            public_updates_channel_id=guild_fields.public_updates_channel_id,
            approximate_member_count=approximate_member_count,
            approximate_active_member_count=approximate_active_member_count,
            roles=roles,
            emojis=emojis,
        )
        return guild

    def deserialize_gateway_guild(self, payload: data_binding.JSONObject) -&gt; entity_factory.GatewayGuildDefinition:
        guild_fields = self._set_guild_attributes(payload)
        is_large = payload[&#34;large&#34;] if &#34;large&#34; in payload else None
        joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;]) if &#34;joined_at&#34; in payload else None
        member_count = int(payload[&#34;member_count&#34;]) if &#34;member_count&#34; in payload else None

        guild = guild_models.GatewayGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=guild_fields.splash_hash,
            discovery_splash_hash=guild_fields.discovery_splash_hash,
            owner_id=guild_fields.owner_id,
            region=guild_fields.region,
            afk_channel_id=guild_fields.afk_channel_id,
            afk_timeout=guild_fields.afk_timeout,
            verification_level=guild_fields.verification_level,
            default_message_notifications=guild_fields.default_message_notifications,
            explicit_content_filter=guild_fields.explicit_content_filter,
            mfa_level=guild_fields.mfa_level,
            application_id=guild_fields.application_id,
            widget_channel_id=guild_fields.widget_channel_id,
            system_channel_id=guild_fields.system_channel_id,
            is_widget_enabled=guild_fields.is_widget_enabled,
            system_channel_flags=guild_fields.system_channel_flags,
            rules_channel_id=guild_fields.rules_channel_id,
            max_video_channel_users=guild_fields.max_video_channel_users,
            vanity_url_code=guild_fields.vanity_url_code,
            description=guild_fields.description,
            banner_hash=guild_fields.banner_hash,
            premium_tier=guild_fields.premium_tier,
            premium_subscription_count=guild_fields.premium_subscription_count,
            preferred_locale=guild_fields.preferred_locale,
            public_updates_channel_id=guild_fields.public_updates_channel_id,
            is_large=is_large,
            joined_at=joined_at,
            member_count=member_count,
        )

        members: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, guild_models.Member]] = None
        if &#34;members&#34; in payload:
            members = {}

            for member_payload in payload[&#34;members&#34;]:
                member = self.deserialize_member(member_payload, guild_id=guild.id)
                members[member.user.id] = member

        channels: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, channel_models.GuildChannel]] = None
        if &#34;channels&#34; in payload:
            channels = {}

            for channel_payload in payload[&#34;channels&#34;]:
                channel = typing.cast(
                    &#34;channel_models.GuildChannel&#34;, self.deserialize_channel(channel_payload, guild_id=guild.id)
                )
                channels[channel.id] = channel

        presences: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, presence_models.MemberPresence]] = None
        if &#34;presences&#34; in payload:
            presences = {}

            for presence_payload in payload[&#34;presences&#34;]:
                presence = self.deserialize_member_presence(presence_payload, guild_id=guild.id)
                presences[presence.user_id] = presence

        voice_states: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, voice_models.VoiceState]] = None
        if &#34;voice_states&#34; in payload:
            voice_states = {}
            assert members is not None

            for voice_state_payload in payload[&#34;voice_states&#34;]:
                member = members[snowflakes.Snowflake(voice_state_payload[&#34;user_id&#34;])]
                voice_state = self.deserialize_voice_state(voice_state_payload, guild_id=guild.id, member=member)
                voice_states[voice_state.user_id] = voice_state

        roles = {
            snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild.id)
            for role in payload[&#34;roles&#34;]
        }
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild.id)
            for emoji in payload[&#34;emojis&#34;]
        }

        return entity_factory.GatewayGuildDefinition(guild, channels, members, presences, roles, emojis, voice_states)

    #################
    # INVITE MODELS #
    #################

    def deserialize_vanity_url(self, payload: data_binding.JSONObject) -&gt; invite_models.VanityURL:
        return invite_models.VanityURL(app=self._app, code=payload[&#34;code&#34;], uses=int(payload[&#34;uses&#34;]))

    def _set_invite_attributes(self, payload: data_binding.JSONObject) -&gt; _InviteFields:
        guild: typing.Optional[invite_models.InviteGuild] = None
        guild_id: typing.Optional[snowflakes.Snowflake] = None
        if &#34;guild&#34; in payload:
            guild_payload = payload[&#34;guild&#34;]
            guild_fields = self._set_partial_guild_attributes(guild_payload)
            guild = invite_models.InviteGuild(
                app=self._app,
                id=guild_fields.id,
                name=guild_fields.name,
                features=guild_fields.features,
                icon_hash=guild_fields.icon_hash,
                splash_hash=guild_payload[&#34;splash&#34;],
                banner_hash=guild_payload[&#34;banner&#34;],
                description=guild_payload[&#34;description&#34;],
                verification_level=guild_models.GuildVerificationLevel(guild_payload[&#34;verification_level&#34;]),
                vanity_url_code=guild_payload[&#34;vanity_url_code&#34;],
            )
            guild_id = guild.id
        elif &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        channel: typing.Optional[channel_models.PartialChannel] = None
        if (raw_channel := payload.get(&#34;channel&#34;)) is not None:
            channel = self.deserialize_partial_channel(raw_channel)
            channel_id = channel.id
        else:
            channel_id = snowflakes.Snowflake(payload[&#34;channel_id&#34;])

        target_user_type = (
            invite_models.TargetUserType(payload[&#34;target_user_type&#34;]) if &#34;target_user_type&#34; in payload else None
        )
        approximate_active_member_count = (
            int(payload[&#34;approximate_presence_count&#34;]) if &#34;approximate_presence_count&#34; in payload else None
        )
        approximate_member_count = (
            int(payload[&#34;approximate_member_count&#34;]) if &#34;approximate_member_count&#34; in payload else None
        )
        return _InviteFields(
            code=payload[&#34;code&#34;],
            guild=guild,
            guild_id=guild_id,
            channel=channel,
            channel_id=channel_id,
            inviter=self.deserialize_user(payload[&#34;inviter&#34;]) if &#34;inviter&#34; in payload else None,
            target_user=self.deserialize_user(payload[&#34;target_user&#34;]) if &#34;target_user&#34; in payload else None,
            target_user_type=target_user_type,
            approximate_active_member_count=approximate_active_member_count,
            approximate_member_count=approximate_member_count,
        )

    def deserialize_invite(self, payload: data_binding.JSONObject) -&gt; invite_models.Invite:
        invite_fields = self._set_invite_attributes(payload)
        return invite_models.Invite(
            app=self._app,
            code=invite_fields.code,
            guild=invite_fields.guild,
            guild_id=invite_fields.guild_id,
            channel=invite_fields.channel,
            channel_id=invite_fields.channel_id,
            inviter=invite_fields.inviter,
            target_user=invite_fields.target_user,
            target_user_type=invite_fields.target_user_type,
            approximate_member_count=invite_fields.approximate_member_count,
            approximate_active_member_count=invite_fields.approximate_active_member_count,
        )

    def deserialize_invite_with_metadata(self, payload: data_binding.JSONObject) -&gt; invite_models.InviteWithMetadata:
        invite_fields = self._set_invite_attributes(payload)
        max_age = payload[&#34;max_age&#34;]
        return invite_models.InviteWithMetadata(
            app=self._app,
            code=invite_fields.code,
            guild=invite_fields.guild,
            guild_id=invite_fields.guild_id,
            channel=invite_fields.channel,
            channel_id=invite_fields.channel_id,
            inviter=invite_fields.inviter,
            target_user=invite_fields.target_user,
            target_user_type=invite_fields.target_user_type,
            approximate_member_count=invite_fields.approximate_member_count,
            approximate_active_member_count=invite_fields.approximate_active_member_count,
            uses=int(payload[&#34;uses&#34;]),
            max_uses=int(payload[&#34;max_uses&#34;]),
            max_age=datetime.timedelta(seconds=max_age) if max_age &gt; 0 else None,
            is_temporary=payload[&#34;temporary&#34;],
            created_at=time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;]),
        )

    ##################
    # MESSAGE MODELS #
    ##################

    def deserialize_partial_message(self, payload: data_binding.JSONObject) -&gt; message_models.PartialMessage:
        author: typing.Optional[user_models.User] = None
        if author_pl := payload.get(&#34;author&#34;):
            author = self.deserialize_user(author_pl)

        guild_id: typing.Optional[snowflakes.Snowflake] = None
        member: typing.Optional[guild_models.Member] = None
        if &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

            if author is not None and (member_pl := payload.get(&#34;member&#34;)):
                member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)

        timestamp: undefined.UndefinedOr[datetime.datetime] = undefined.UNDEFINED
        if &#34;timestamp&#34; in payload:
            timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;])

        edited_timestamp: undefined.UndefinedNoneOr[datetime.datetime] = undefined.UNDEFINED
        if &#34;edited_timestamp&#34; in payload:
            if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
                edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)
            else:
                edited_timestamp = None

        is_mentioning_everyone = payload[&#34;mention_everyone&#34;] if &#34;mention_everyone&#34; in payload else undefined.UNDEFINED

        user_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
        if &#34;mentions&#34; in payload:
            user_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mentions&#34;]]

        role_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
        if &#34;mention_roles&#34; in payload:
            role_mentions = [snowflakes.Snowflake(mention) for mention in payload[&#34;mention_roles&#34;]]

        channel_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
        if &#34;mention_channels&#34; in payload:
            channel_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mention_channels&#34;]]

        attachments: undefined.UndefinedOr[typing.MutableSequence[message_models.Attachment]] = undefined.UNDEFINED
        if &#34;attachments&#34; in payload:
            attachments = []
            for attachment_payload in payload[&#34;attachments&#34;]:
                attachment = message_models.Attachment(
                    id=snowflakes.Snowflake(attachment_payload[&#34;id&#34;]),
                    filename=attachment_payload[&#34;filename&#34;],
                    size=int(attachment_payload[&#34;size&#34;]),
                    url=attachment_payload[&#34;url&#34;],
                    proxy_url=attachment_payload[&#34;proxy_url&#34;],
                    height=attachment_payload.get(&#34;height&#34;),
                    width=attachment_payload.get(&#34;width&#34;),
                )
                attachments.append(attachment)

        embeds: undefined.UndefinedOr[typing.Sequence[embed_models.Embed]] = undefined.UNDEFINED
        if &#34;embeds&#34; in payload:
            embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

        reactions: undefined.UndefinedOr[typing.MutableSequence[message_models.Reaction]] = undefined.UNDEFINED
        if &#34;reactions&#34; in payload:
            reactions = []
            for reaction_payload in payload[&#34;reactions&#34;]:
                reaction = message_models.Reaction(
                    count=int(reaction_payload[&#34;count&#34;]),
                    emoji=self.deserialize_emoji(reaction_payload[&#34;emoji&#34;]),
                    is_me=reaction_payload[&#34;me&#34;],
                )
                reactions.append(reaction)

        activity: undefined.UndefinedOr[message_models.MessageActivity] = undefined.UNDEFINED
        if &#34;activity&#34; in payload:
            activity_payload = payload[&#34;activity&#34;]
            activity = message_models.MessageActivity(
                type=message_models.MessageActivityType(activity_payload[&#34;type&#34;]),
                party_id=activity_payload.get(&#34;party_id&#34;),
            )

        application: undefined.UndefinedOr[application_models.Application] = undefined.UNDEFINED
        if &#34;application&#34; in payload:
            application = self.deserialize_application(payload[&#34;application&#34;])

        message_reference: undefined.UndefinedOr[message_models.MessageCrosspost] = undefined.UNDEFINED
        if &#34;message_reference&#34; in payload:
            crosspost_payload = payload[&#34;message_reference&#34;]
            message_reference = message_models.MessageCrosspost(
                app=self._app,
                id=snowflakes.Snowflake(crosspost_payload[&#34;message_id&#34;]) if &#34;message_id&#34; in crosspost_payload else None,
                channel_id=snowflakes.Snowflake(crosspost_payload[&#34;channel_id&#34;]),
                guild_id=snowflakes.Snowflake(crosspost_payload[&#34;guild_id&#34;])
                if &#34;guild_id&#34; in crosspost_payload
                else None,
            )

        return message_models.PartialMessage(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=guild_id,
            author=author,
            member=member,
            content=payload[&#34;content&#34;] if &#34;content&#34; in payload else undefined.UNDEFINED,
            timestamp=timestamp,
            edited_timestamp=edited_timestamp,
            is_tts=payload[&#34;tts&#34;] if &#34;tts&#34; in payload else undefined.UNDEFINED,
            is_mentioning_everyone=is_mentioning_everyone,
            user_mentions=user_mentions,
            role_mentions=role_mentions,
            channel_mentions=channel_mentions,
            attachments=attachments,
            embeds=embeds,
            reactions=reactions,
            is_pinned=payload[&#34;pinned&#34;] if &#34;pinned&#34; in payload else undefined.UNDEFINED,
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else undefined.UNDEFINED,
            type=message_models.MessageType(payload[&#34;type&#34;]) if &#34;type&#34; in payload else undefined.UNDEFINED,
            activity=activity,
            application=application,
            message_reference=message_reference,
            flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else undefined.UNDEFINED,
            nonce=payload[&#34;nonce&#34;] if &#34;nonce&#34; in payload else undefined.UNDEFINED,
        )

    def deserialize_message(self, payload: data_binding.JSONObject) -&gt; message_models.Message:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None
        author = self.deserialize_user(payload[&#34;author&#34;])

        member: typing.Optional[guild_models.Member] = None
        if &#34;member&#34; in payload:
            assert guild_id is not None
            member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id, user=author)

        edited_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
            edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)

        user_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mentions&#34;]]
        role_mentions = [snowflakes.Snowflake(mention) for mention in payload[&#34;mention_roles&#34;]]
        channel_mentions = (
            [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mention_channels&#34;]]
            if &#34;mention_channels&#34; in payload
            else []
        )

        attachments = []
        for attachment_payload in payload[&#34;attachments&#34;]:
            attachment = message_models.Attachment(
                id=snowflakes.Snowflake(attachment_payload[&#34;id&#34;]),
                filename=attachment_payload[&#34;filename&#34;],
                size=int(attachment_payload[&#34;size&#34;]),
                url=attachment_payload[&#34;url&#34;],
                proxy_url=attachment_payload[&#34;proxy_url&#34;],
                height=attachment_payload.get(&#34;height&#34;),
                width=attachment_payload.get(&#34;width&#34;),
            )
            attachments.append(attachment)

        embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

        reactions = []
        if &#34;reactions&#34; in payload:
            for reaction_payload in payload[&#34;reactions&#34;]:
                reaction = message_models.Reaction(
                    count=int(reaction_payload[&#34;count&#34;]),
                    emoji=self.deserialize_emoji(reaction_payload[&#34;emoji&#34;]),
                    is_me=reaction_payload[&#34;me&#34;],
                )
                reactions.append(reaction)

        activity: typing.Optional[message_models.MessageActivity] = None
        if &#34;activity&#34; in payload:
            activity_payload = payload[&#34;activity&#34;]
            activity = message_models.MessageActivity(
                type=message_models.MessageActivityType(activity_payload[&#34;type&#34;]),
                party_id=activity_payload.get(&#34;party_id&#34;),
            )

        crosspost: typing.Optional[message_models.MessageCrosspost] = None
        if &#34;message_reference&#34; in payload:
            crosspost_payload = payload[&#34;message_reference&#34;]
            crosspost_id = (
                snowflakes.Snowflake(crosspost_payload[&#34;message_id&#34;]) if &#34;message_id&#34; in crosspost_payload else None
            )
            crosspost = message_models.MessageCrosspost(
                app=self._app,
                id=crosspost_id,
                channel_id=snowflakes.Snowflake(crosspost_payload[&#34;channel_id&#34;]),
                guild_id=snowflakes.Snowflake(crosspost_payload[&#34;guild_id&#34;])
                if &#34;guild_id&#34; in crosspost_payload
                else None,
            )

        return message_models.Message(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=guild_id,
            author=author,
            member=member,
            content=payload[&#34;content&#34;],
            timestamp=time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]),
            edited_timestamp=edited_timestamp,
            is_tts=payload[&#34;tts&#34;],
            is_mentioning_everyone=payload[&#34;mention_everyone&#34;],
            user_mentions=user_mentions,
            role_mentions=role_mentions,
            channel_mentions=channel_mentions,
            attachments=attachments,
            embeds=embeds,
            reactions=reactions,
            is_pinned=payload[&#34;pinned&#34;],
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else None,
            type=message_models.MessageType(payload[&#34;type&#34;]),
            activity=activity,
            application=self.deserialize_application(payload[&#34;application&#34;]) if &#34;application&#34; in payload else None,
            message_reference=crosspost,
            flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else None,
            nonce=payload.get(&#34;nonce&#34;),
        )

    ###################
    # PRESENCE MODELS #
    ###################

    def deserialize_member_presence(  # noqa: CFQ001  # TODO: what&#39;s CFQ001?
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; presence_models.MemberPresence:
        activities = []
        for activity_payload in payload[&#34;activities&#34;]:
            timestamps: typing.Optional[presence_models.ActivityTimestamps] = None
            if &#34;timestamps&#34; in activity_payload:
                timestamps_payload = activity_payload[&#34;timestamps&#34;]
                start = (
                    time.unix_epoch_to_datetime(timestamps_payload[&#34;start&#34;]) if &#34;start&#34; in timestamps_payload else None
                )
                end = time.unix_epoch_to_datetime(timestamps_payload[&#34;end&#34;]) if &#34;end&#34; in timestamps_payload else None
                timestamps = presence_models.ActivityTimestamps(start=start, end=end)

            application_id = (
                snowflakes.Snowflake(activity_payload[&#34;application_id&#34;])
                if &#34;application_id&#34; in activity_payload
                else None
            )

            party: typing.Optional[presence_models.ActivityParty] = None
            if &#34;party&#34; in activity_payload:
                party_payload = activity_payload[&#34;party&#34;]

                current_size: typing.Optional[int]
                max_size: typing.Optional[int]
                if &#34;size&#34; in party_payload:
                    raw_current_size, raw_max_size = party_payload[&#34;size&#34;]
                    current_size = int(raw_current_size)
                    max_size = int(raw_max_size)
                else:
                    current_size = max_size = None

                party = presence_models.ActivityParty(
                    id=party_payload.get(&#34;id&#34;), current_size=current_size, max_size=max_size
                )

            assets: typing.Optional[presence_models.ActivityAssets] = None
            if &#34;assets&#34; in activity_payload:
                assets_payload = activity_payload[&#34;assets&#34;]
                assets = presence_models.ActivityAssets(
                    large_image=assets_payload.get(&#34;large_image&#34;),
                    large_text=assets_payload.get(&#34;large_text&#34;),
                    small_image=assets_payload.get(&#34;small_image&#34;),
                    small_text=assets_payload.get(&#34;small_text&#34;),
                )

            secrets: typing.Optional[presence_models.ActivitySecret] = None
            if &#34;secrets&#34; in activity_payload:
                secrets_payload = activity_payload[&#34;secrets&#34;]
                secrets = presence_models.ActivitySecret(
                    join=secrets_payload.get(&#34;join&#34;),
                    spectate=secrets_payload.get(&#34;spectate&#34;),
                    match=secrets_payload.get(&#34;match&#34;),
                )

            emoji: typing.Optional[emoji_models.Emoji] = None
            raw_emoji = activity_payload.get(&#34;emoji&#34;)
            if raw_emoji is not None:
                emoji = self.deserialize_emoji(raw_emoji)

            activity = presence_models.RichActivity(
                name=activity_payload[&#34;name&#34;],
                type=presence_models.ActivityType(activity_payload[&#34;type&#34;]),
                url=activity_payload.get(&#34;url&#34;),
                created_at=time.unix_epoch_to_datetime(activity_payload[&#34;created_at&#34;]),
                timestamps=timestamps,
                application_id=application_id,
                details=activity_payload.get(&#34;details&#34;),
                state=activity_payload.get(&#34;state&#34;),
                emoji=emoji,
                party=party,
                assets=assets,
                secrets=secrets,
                is_instance=activity_payload.get(&#34;instance&#34;),  # TODO: can we safely default this to False?
                flags=presence_models.ActivityFlag(activity_payload[&#34;flags&#34;]) if &#34;flags&#34; in activity_payload else None,
            )
            activities.append(activity)

        client_status_payload = payload[&#34;client_status&#34;]
        desktop = (
            presence_models.Status(client_status_payload[&#34;desktop&#34;])
            if &#34;desktop&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        mobile = (
            presence_models.Status(client_status_payload[&#34;mobile&#34;])
            if &#34;mobile&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        web = (
            presence_models.Status(client_status_payload[&#34;web&#34;])
            if &#34;web&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        client_status = presence_models.ClientStatus(desktop=desktop, mobile=mobile, web=web)

        return presence_models.MemberPresence(
            app=self._app,
            user_id=snowflakes.Snowflake(payload[&#34;user&#34;][&#34;id&#34;]),
            guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            visible_status=presence_models.Status(payload[&#34;status&#34;]),
            activities=activities,
            client_status=client_status,
        )

    ###############
    # USER MODELS #
    ###############

    @staticmethod
    def _set_user_attributes(payload: data_binding.JSONObject) -&gt; _UserFields:
        return _UserFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            discriminator=payload[&#34;discriminator&#34;],
            username=payload[&#34;username&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            is_bot=payload.get(&#34;bot&#34;, False),
            is_system=payload.get(&#34;system&#34;, False),
        )

    def deserialize_user(self, payload: data_binding.JSONObject) -&gt; user_models.User:
        user_fields = self._set_user_attributes(payload)
        flags = (
            user_models.UserFlag(payload[&#34;public_flags&#34;]) if &#34;public_flags&#34; in payload else user_models.UserFlag.NONE
        )
        return user_models.UserImpl(
            app=self._app,
            id=user_fields.id,
            discriminator=user_fields.discriminator,
            username=user_fields.username,
            avatar_hash=user_fields.avatar_hash,
            is_bot=user_fields.is_bot,
            is_system=user_fields.is_system,
            flags=flags,
        )

    def deserialize_my_user(self, payload: data_binding.JSONObject) -&gt; user_models.OwnUser:
        user_fields = self._set_user_attributes(payload)
        return user_models.OwnUser(
            app=self._app,
            id=user_fields.id,
            discriminator=user_fields.discriminator,
            username=user_fields.username,
            avatar_hash=user_fields.avatar_hash,
            is_bot=user_fields.is_bot,
            is_system=user_fields.is_system,
            is_mfa_enabled=payload[&#34;mfa_enabled&#34;],
            locale=payload.get(&#34;locale&#34;),
            is_verified=payload.get(&#34;verified&#34;),
            email=payload.get(&#34;email&#34;),
            flags=user_models.UserFlag(payload[&#34;flags&#34;]),
            premium_type=user_models.PremiumType(payload[&#34;premium_type&#34;]) if &#34;premium_type&#34; in payload else None,
        )

    ################
    # VOICE MODELS #
    ################

    def deserialize_voice_state(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
        member: undefined.UndefinedOr[guild_models.Member] = undefined.UNDEFINED,
    ) -&gt; voice_models.VoiceState:
        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        channel_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
            channel_id = snowflakes.Snowflake(raw_channel_id)

        if member is undefined.UNDEFINED:
            member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id)

        return voice_models.VoiceState(
            app=self._app,
            guild_id=guild_id,
            channel_id=channel_id,
            user_id=snowflakes.Snowflake(payload[&#34;user_id&#34;]),
            member=member,
            session_id=payload[&#34;session_id&#34;],
            is_guild_deafened=payload[&#34;deaf&#34;],
            is_guild_muted=payload[&#34;mute&#34;],
            is_self_deafened=payload[&#34;self_deaf&#34;],
            is_self_muted=payload[&#34;self_mute&#34;],
            is_streaming=payload.get(&#34;self_stream&#34;, False),
            is_video_enabled=payload[&#34;self_video&#34;],
            is_suppressed=payload[&#34;suppress&#34;],
        )

    def deserialize_voice_region(self, payload: data_binding.JSONObject) -&gt; voice_models.VoiceRegion:
        return voice_models.VoiceRegion(
            id=payload[&#34;id&#34;],
            name=payload[&#34;name&#34;],
            is_vip=payload[&#34;vip&#34;],
            is_optimal_location=payload[&#34;optimal&#34;],
            is_deprecated=payload[&#34;deprecated&#34;],
            is_custom=payload[&#34;custom&#34;],
        )

    ##################
    # WEBHOOK MODELS #
    ##################

    def deserialize_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.Webhook:
        return webhook_models.Webhook(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=webhook_models.WebhookType(payload[&#34;type&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
            name=payload[&#34;name&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            token=payload.get(&#34;token&#34;),
        )</code></pre>
</details>
<div class="sep"></div>
<h5>Method resolution order</h5>
<dl>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="EntityFactoryImpl -- Standard implementation for a serializer/deserializer …" href="#hikari.impl.entity_factory.EntityFactoryImpl"
>EntityFactoryImpl</a></dt>
<dd class="nested"><em class="text-muted">That's this class!</em></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='An abstract base class which may have abstract methods and abstract properties.'>abstract</abbr> <abbr title='A standard Python type.'>class</abbr></em></small> <a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></dt>
<dd class="nested"><p>Interface for components that serialize and deserialize JSON payloads.</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="abc.ABC -- Helper class that provides a standard way to create an ABC using
inheritance." href="https://docs.python.org/3/library/abc.html#abc.ABC"
>abc.ABC</a></dt>
<dd class="nested"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></dd>
</dl>
<div class="sep"></div>
<h5>Methods</h5>
<dl>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_application" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application">deserialize_application</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.Application'>Application</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_application -- Parse a raw payload from Discord into an application object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_application"
>deserialize_application</a></code>
</p>
<p>Parse a raw payload from Discord into an application object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.Application'>Application</a></code></dt>
<dd>The deserialized application object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L273-L314" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_application(self, payload: data_binding.JSONObject) -&gt; application_models.Application:
    team: typing.Optional[application_models.Team] = None
    if (team_payload := payload.get(&#34;team&#34;)) is not None:
        members = {}
        for member_payload in team_payload[&#34;members&#34;]:
            team_member = application_models.TeamMember(
                app=self._app,
                membership_state=application_models.TeamMembershipState(member_payload[&#34;membership_state&#34;]),
                permissions=member_payload[&#34;permissions&#34;],
                team_id=snowflakes.Snowflake(member_payload[&#34;team_id&#34;]),
                user=self.deserialize_user(member_payload[&#34;user&#34;]),
            )
            members[team_member.user.id] = team_member

        team = application_models.Team(
            app=self._app,
            id=snowflakes.Snowflake(team_payload[&#34;id&#34;]),
            icon_hash=team_payload[&#34;icon&#34;],
            members=members,
            owner_id=snowflakes.Snowflake(team_payload[&#34;owner_user_id&#34;]),
        )

    primary_sku_id = snowflakes.Snowflake(payload[&#34;primary_sku_id&#34;]) if &#34;primary_sku_id&#34; in payload else None

    return application_models.Application(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        description=payload[&#34;description&#34;],
        is_bot_public=payload.get(&#34;bot_public&#34;),
        is_bot_code_grant_required=payload.get(&#34;bot_require_code_grant&#34;),
        owner=self.deserialize_user(payload[&#34;owner&#34;]) if &#34;owner&#34; in payload else None,
        rpc_origins=payload[&#34;rpc_origins&#34;] if &#34;rpc_origins&#34; in payload else None,
        summary=payload[&#34;summary&#34;],
        verify_key=bytes(payload[&#34;verify_key&#34;], &#34;utf-8&#34;) if &#34;verify_key&#34; in payload else None,
        icon_hash=payload.get(&#34;icon&#34;),
        team=team,
        guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
        primary_sku_id=primary_sku_id,
        slug=payload.get(&#34;slug&#34;),
        cover_image_hash=payload.get(&#34;cover_image&#34;),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_audit_log" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_audit_log" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_audit_log" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_audit_log">deserialize_audit_log</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../audit_logs.html#hikari.audit_logs.AuditLog'>AuditLog</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_audit_log -- Parse a raw payload from Discord into an audit log object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_audit_log"
>deserialize_audit_log</a></code>
</p>
<p>Parse a raw payload from Discord into an audit log object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../audit_logs.html#hikari.audit_logs.AuditLog'>AuditLog</a></code></dt>
<dd>The deserialized audit log object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L396-L453" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_audit_log(self, payload: data_binding.JSONObject) -&gt; audit_log_models.AuditLog:
    entries = {}
    for entry_payload in payload[&#34;audit_log_entries&#34;]:
        entry_id = snowflakes.Snowflake(entry_payload[&#34;id&#34;])

        changes = []
        if (change_payloads := entry_payload.get(&#34;changes&#34;)) is not None:
            for change_payload in change_payloads:
                key: typing.Union[audit_log_models.AuditLogChangeKey, str]
                key = audit_log_models.AuditLogChangeKey(change_payload[&#34;key&#34;])

                new_value: typing.Any = change_payload.get(&#34;new_value&#34;)
                old_value: typing.Any = change_payload.get(&#34;old_value&#34;)
                if value_converter := self._audit_log_entry_converters.get(key):
                    new_value = value_converter(new_value) if new_value is not None else None
                    old_value = value_converter(old_value) if old_value is not None else None

                changes.append(audit_log_models.AuditLogChange(key=key, new_value=new_value, old_value=old_value))

        target_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_target_id := entry_payload[&#34;target_id&#34;]) is not None:
            target_id = snowflakes.Snowflake(raw_target_id)

        user_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_user_id := entry_payload[&#34;user_id&#34;]) is not None:
            user_id = snowflakes.Snowflake(raw_user_id)

        action_type: typing.Union[audit_log_models.AuditLogEventType, int]
        action_type = audit_log_models.AuditLogEventType(entry_payload[&#34;action_type&#34;])

        options: typing.Optional[audit_log_models.BaseAuditLogEntryInfo] = None
        if (raw_option := entry_payload.get(&#34;options&#34;)) is not None:
            option_converter = (
                self._audit_log_event_mapping.get(action_type)
                or self._deserialize_unrecognised_audit_log_entry_info  # noqa: W503
            )
            options = option_converter(raw_option)

        entries[entry_id] = audit_log_models.AuditLogEntry(
            app=self._app,
            id=entry_id,
            target_id=target_id,
            changes=changes,
            user_id=user_id,
            action_type=action_type,
            options=options,
            reason=entry_payload.get(&#34;reason&#34;),
        )

    integrations = {
        snowflakes.Snowflake(integration[&#34;id&#34;]): self.deserialize_partial_integration(integration)
        for integration in payload[&#34;integrations&#34;]
    }
    users = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;users&#34;]}
    webhooks = {
        snowflakes.Snowflake(webhook[&#34;id&#34;]): self.deserialize_webhook(webhook) for webhook in payload[&#34;webhooks&#34;]
    }
    return audit_log_models.AuditLog(entries=entries, integrations=integrations, users=users, webhooks=webhooks)</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel">deserialize_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.PartialChannel'>PartialChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_channel -- Parse a raw payload from Discord into a channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_channel"
>deserialize_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this channel belongs to. This will be ignored
for DM and group DM channels and will be prioritised over
<code>"guild_id"</code> in the payload when passed.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.PartialChannel'>PartialChannel</a></code></dt>
<dd>The deserialized partial channel-derived object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload of a guild
channel.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L687-L697" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.PartialChannel:
    channel_type = payload[&#34;type&#34;]
    if channel_model := self._guild_channel_type_mapping.get(channel_type):
        return channel_model(payload, guild_id=guild_id)

    return self._dm_channel_type_mapping[channel_type](payload)</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follow" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_channel_follow" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follow" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follow">deserialize_channel_follow</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.ChannelFollow'>ChannelFollow</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_channel_follow -- Parse a raw payload from Discord into a channel follow object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_channel_follow"
>deserialize_channel_follow</a></code>
</p>
<p>Parse a raw payload from Discord into a channel follow object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.ChannelFollow'>ChannelFollow</a></code></dt>
<dd>The deserialized channel follow object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L459-L464" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_channel_follow(self, payload: data_binding.JSONObject) -&gt; channel_models.ChannelFollow:
    return channel_models.ChannelFollow(
        app=self._app,
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_custom_emoji" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_custom_emoji" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_custom_emoji" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_custom_emoji">deserialize_custom_emoji</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../emojis.html#hikari.emojis.CustomEmoji'>CustomEmoji</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_custom_emoji -- Parse a raw payload from Discord into a custom emoji object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_custom_emoji"
>deserialize_custom_emoji</a></code>
</p>
<p>Parse a raw payload from Discord into a custom emoji object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../emojis.html#hikari.emojis.CustomEmoji'>CustomEmoji</a></code></dt>
<dd>The deserialized custom emoji object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L906-L911" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_custom_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.CustomEmoji:
    return emoji_models.CustomEmoji(
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        is_animated=payload.get(&#34;animated&#34;, False),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_dm" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_dm" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_dm" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_dm">deserialize_dm</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.DMChannel'>DMChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_dm -- Parse a raw payload from Discord into a DM channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_dm"
>deserialize_dm</a></code>
</p>
<p>Parse a raw payload from Discord into a DM channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.DMChannel'>DMChannel</a></code></dt>
<dd>The deserialized DM channel object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L492-L504" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.DMChannel:
    last_message_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
        last_message_id = snowflakes.Snowflake(raw_last_message_id)

    return channel_models.DMChannel(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload.get(&#34;name&#34;),
        type=channel_models.ChannelType(payload[&#34;type&#34;]),
        last_message_id=last_message_id,
        recipient=self.deserialize_user(payload[&#34;recipients&#34;][0]),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_embed" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_embed" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_embed" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_embed">deserialize_embed</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../embeds.html#hikari.embeds.Embed'>Embed</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_embed -- Parse a raw payload from Discord into an embed object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_embed"
>deserialize_embed</a></code>
</p>
<p>Parse a raw payload from Discord into an embed object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../embeds.html#hikari.embeds.Embed'>Embed</a></code></dt>
<dd>The deserialized embed object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L703-L792" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_embed(self, payload: data_binding.JSONObject) -&gt; embed_models.Embed:
    # Keep these separate to aid debugging later.
    title = payload.get(&#34;title&#34;)
    description = payload.get(&#34;description&#34;)
    url = payload.get(&#34;url&#34;)
    color = color_models.Color(payload[&#34;color&#34;]) if &#34;color&#34; in payload else None
    timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]) if &#34;timestamp&#34; in payload else None
    fields: typing.Optional[typing.MutableSequence[embed_models.EmbedField]] = None

    image: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
    if image_payload := payload.get(&#34;image&#34;):
        image = embed_models.EmbedImage(
            resource=files.ensure_resource(image_payload.get(&#34;url&#34;)),
            proxy_resource=files.ensure_resource(image_payload.get(&#34;proxy_url&#34;)),
            height=image_payload.get(&#34;height&#34;),
            width=image_payload.get(&#34;width&#34;),
        )

    thumbnail: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
    if thumbnail_payload := payload.get(&#34;thumbnail&#34;):
        thumbnail = embed_models.EmbedImage(
            resource=files.ensure_resource(thumbnail_payload.get(&#34;url&#34;)),
            proxy_resource=files.ensure_resource(thumbnail_payload.get(&#34;proxy_url&#34;)),
            height=thumbnail_payload.get(&#34;height&#34;),
            width=thumbnail_payload.get(&#34;width&#34;),
        )

    video: typing.Optional[embed_models.EmbedVideo[files.AsyncReader]] = None
    if video_payload := payload.get(&#34;video&#34;):
        video = embed_models.EmbedVideo(
            resource=files.ensure_resource(video_payload.get(&#34;url&#34;)),
            height=video_payload.get(&#34;height&#34;),
            width=video_payload.get(&#34;width&#34;),
        )

    provider: typing.Optional[embed_models.EmbedProvider] = None
    if provider_payload := payload.get(&#34;provider&#34;):
        provider = embed_models.EmbedProvider(name=provider_payload.get(&#34;name&#34;), url=provider_payload.get(&#34;url&#34;))

    icon: typing.Optional[embed_models.EmbedResourceWithProxy[files.AsyncReader]]
    author: typing.Optional[embed_models.EmbedAuthor] = None
    if author_payload := payload.get(&#34;author&#34;):
        icon = None
        if &#34;icon_url&#34; in author_payload:
            icon = embed_models.EmbedResourceWithProxy(
                resource=files.ensure_resource(author_payload.get(&#34;icon_url&#34;)),
                proxy_resource=files.ensure_resource(author_payload.get(&#34;proxy_icon_url&#34;)),
            )

        author = embed_models.EmbedAuthor(
            name=author_payload.get(&#34;name&#34;),
            url=author_payload.get(&#34;url&#34;),
            icon=icon,
        )

    footer: typing.Optional[embed_models.EmbedFooter] = None
    if footer_payload := payload.get(&#34;footer&#34;):
        icon = None
        if &#34;icon_url&#34; in footer_payload:
            icon = embed_models.EmbedResourceWithProxy(
                resource=files.ensure_resource(footer_payload.get(&#34;icon_url&#34;)),
                proxy_resource=files.ensure_resource(footer_payload.get(&#34;proxy_icon_url&#34;)),
            )

        footer = embed_models.EmbedFooter(text=footer_payload.get(&#34;text&#34;), icon=icon)

    if fields_array := payload.get(&#34;fields&#34;):
        fields = []
        for field_payload in fields_array:
            field = embed_models.EmbedField(
                name=field_payload[&#34;name&#34;],
                value=field_payload[&#34;value&#34;],
                inline=field_payload.get(&#34;inline&#34;, False),
            )
            fields.append(field)

    return embed_models.Embed.from_received_embed(
        title=title,
        description=description,
        url=url,
        color=color,
        timestamp=timestamp,
        image=image,
        thumbnail=thumbnail,
        video=video,
        provider=provider,
        author=author,
        footer=footer,
        fields=fields,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_emoji" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_emoji" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_emoji" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_emoji">deserialize_emoji</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> Union[<a href='../emojis.html#hikari.emojis.UnicodeEmoji'>UnicodeEmoji</a>, <a href='../emojis.html#hikari.emojis.CustomEmoji'>CustomEmoji</a>]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_emoji -- Parse a raw payload from Discord into an emoji object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_emoji"
>deserialize_emoji</a></code>
</p>
<p>Parse a raw payload from Discord into an emoji object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../emojis.html#hikari.emojis.UnicodeEmoji'>UnicodeEmoji</a></code> or <code><a href='../emojis.html#hikari.emojis.CustomEmoji'>CustomEmoji</a></code></dt>
<dd>The deserialized custom or unicode emoji object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L935-L941" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_emoji(
    self, payload: data_binding.JSONObject
) -&gt; typing.Union[emoji_models.UnicodeEmoji, emoji_models.CustomEmoji]:
    if payload.get(&#34;id&#34;) is not None:
        return self.deserialize_custom_emoji(payload)

    return self.deserialize_unicode_emoji(payload)</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_bot" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_gateway_bot" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_bot" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_bot">deserialize_gateway_bot</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../sessions.html#hikari.sessions.GatewayBot'>GatewayBot</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_gateway_bot -- Parse a raw payload from Discord into a gateway bot object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_gateway_bot"
>deserialize_gateway_bot</a></code>
</p>
<p>Parse a raw payload from Discord into a gateway bot object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../sessions.html#hikari.sessions.GatewayBot'>GatewayBot</a></code></dt>
<dd>The deserialized gateway bot object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L947-L961" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_gateway_bot(self, payload: data_binding.JSONObject) -&gt; gateway_models.GatewayBot:
    session_start_limit_payload = payload[&#34;session_start_limit&#34;]
    session_start_limit = gateway_models.SessionStartLimit(
        total=int(session_start_limit_payload[&#34;total&#34;]),
        remaining=int(session_start_limit_payload[&#34;remaining&#34;]),
        reset_after=datetime.timedelta(milliseconds=session_start_limit_payload[&#34;reset_after&#34;]),
        # I do not trust that this may never be zero for some unknown reason. If it was 0, it
        # would hang the application on start up, so I enforce it is at least 1.
        max_concurrency=max(session_start_limit_payload.get(&#34;max_concurrency&#34;, 0), 1),
    )
    return gateway_models.GatewayBot(
        url=payload[&#34;url&#34;],
        shard_count=int(payload[&#34;shards&#34;]),
        session_start_limit=session_start_limit,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_guild" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_gateway_guild" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_guild" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_guild">deserialize_gateway_guild</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../api/entity_factory.html#hikari.api.entity_factory.GatewayGuildDefinition'>GatewayGuildDefinition</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_gateway_guild -- Parse a raw payload from Discord into a guild object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_gateway_guild"
>deserialize_gateway_guild</a></code>
</p>
<p>Parse a raw payload from Discord into a guild object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>GatewayGuildDefinition</code></dt>
<dd>The deserialized guild object and the internal collections as
maps of <code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code> mapping to
<code><a href='../channels.html#hikari.channels.GuildChannel'>GuildChannel</a></code>,
<code><a href='../guilds.html#hikari.guilds.Member'>Member</a></code>,
<code><a href='../presences.html#hikari.presences.MemberPresence'>MemberPresence</a></code>,
<code><a href='../guilds.html#hikari.guilds.Role'>Role</a></code>, and
<code><a href='../emojis.html#hikari.emojis.KnownCustomEmoji'>KnownCustomEmoji</a></code>. This is provided in
several components to allow separate caching and linking
between entities in various relational cache implementations
internally.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1222-L1308" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_gateway_guild(self, payload: data_binding.JSONObject) -&gt; entity_factory.GatewayGuildDefinition:
    guild_fields = self._set_guild_attributes(payload)
    is_large = payload[&#34;large&#34;] if &#34;large&#34; in payload else None
    joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;]) if &#34;joined_at&#34; in payload else None
    member_count = int(payload[&#34;member_count&#34;]) if &#34;member_count&#34; in payload else None

    guild = guild_models.GatewayGuild(
        app=self._app,
        id=guild_fields.id,
        name=guild_fields.name,
        icon_hash=guild_fields.icon_hash,
        features=guild_fields.features,
        splash_hash=guild_fields.splash_hash,
        discovery_splash_hash=guild_fields.discovery_splash_hash,
        owner_id=guild_fields.owner_id,
        region=guild_fields.region,
        afk_channel_id=guild_fields.afk_channel_id,
        afk_timeout=guild_fields.afk_timeout,
        verification_level=guild_fields.verification_level,
        default_message_notifications=guild_fields.default_message_notifications,
        explicit_content_filter=guild_fields.explicit_content_filter,
        mfa_level=guild_fields.mfa_level,
        application_id=guild_fields.application_id,
        widget_channel_id=guild_fields.widget_channel_id,
        system_channel_id=guild_fields.system_channel_id,
        is_widget_enabled=guild_fields.is_widget_enabled,
        system_channel_flags=guild_fields.system_channel_flags,
        rules_channel_id=guild_fields.rules_channel_id,
        max_video_channel_users=guild_fields.max_video_channel_users,
        vanity_url_code=guild_fields.vanity_url_code,
        description=guild_fields.description,
        banner_hash=guild_fields.banner_hash,
        premium_tier=guild_fields.premium_tier,
        premium_subscription_count=guild_fields.premium_subscription_count,
        preferred_locale=guild_fields.preferred_locale,
        public_updates_channel_id=guild_fields.public_updates_channel_id,
        is_large=is_large,
        joined_at=joined_at,
        member_count=member_count,
    )

    members: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, guild_models.Member]] = None
    if &#34;members&#34; in payload:
        members = {}

        for member_payload in payload[&#34;members&#34;]:
            member = self.deserialize_member(member_payload, guild_id=guild.id)
            members[member.user.id] = member

    channels: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, channel_models.GuildChannel]] = None
    if &#34;channels&#34; in payload:
        channels = {}

        for channel_payload in payload[&#34;channels&#34;]:
            channel = typing.cast(
                &#34;channel_models.GuildChannel&#34;, self.deserialize_channel(channel_payload, guild_id=guild.id)
            )
            channels[channel.id] = channel

    presences: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, presence_models.MemberPresence]] = None
    if &#34;presences&#34; in payload:
        presences = {}

        for presence_payload in payload[&#34;presences&#34;]:
            presence = self.deserialize_member_presence(presence_payload, guild_id=guild.id)
            presences[presence.user_id] = presence

    voice_states: typing.Optional[typing.MutableMapping[snowflakes.Snowflake, voice_models.VoiceState]] = None
    if &#34;voice_states&#34; in payload:
        voice_states = {}
        assert members is not None

        for voice_state_payload in payload[&#34;voice_states&#34;]:
            member = members[snowflakes.Snowflake(voice_state_payload[&#34;user_id&#34;])]
            voice_state = self.deserialize_voice_state(voice_state_payload, guild_id=guild.id, member=member)
            voice_states[voice_state.user_id] = voice_state

    roles = {
        snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild.id)
        for role in payload[&#34;roles&#34;]
    }
    emojis = {
        snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild.id)
        for emoji in payload[&#34;emojis&#34;]
    }

    return entity_factory.GatewayGuildDefinition(guild, channels, members, presences, roles, emojis, voice_states)</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_group_dm" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_group_dm" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_group_dm" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_group_dm">deserialize_group_dm</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.GroupDMChannel'>GroupDMChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_group_dm -- Parse a raw payload from Discord into a group DM channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_group_dm"
>deserialize_group_dm</a></code>
</p>
<p>Parse a raw payload from Discord into a group DM channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GroupDMChannel'>GroupDMChannel</a></code></dt>
<dd>The deserialized group DM object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L506-L529" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_group_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.GroupDMChannel:
    last_message_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
        last_message_id = snowflakes.Snowflake(raw_last_message_id)

    if (raw_nicks := payload.get(&#34;nicks&#34;)) is not None:
        nicknames = {snowflakes.Snowflake(entry[&#34;id&#34;]): entry[&#34;nick&#34;] for entry in raw_nicks}
    else:
        nicknames = {}

    recipients = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;recipients&#34;]}

    return channel_models.GroupDMChannel(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload.get(&#34;name&#34;),
        type=channel_models.ChannelType(payload[&#34;type&#34;]),
        last_message_id=last_message_id,
        owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
        icon_hash=payload[&#34;icon&#34;],
        nicknames=nicknames,
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
        recipients=recipients,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_category" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_category" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_category" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_category">deserialize_guild_category</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildCategory'>GuildCategory</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_category -- Parse a raw payload from Discord into a guild category object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_category"
>deserialize_guild_category</a></code>
</p>
<p>Parse a raw payload from Discord into a guild category object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildCategory'>GuildCategory</a></code></dt>
<dd>The deserialized guild category object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L562-L579" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_category(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildCategory:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
    return channel_models.GuildCategory(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_member_ban" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_member_ban" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_member_ban" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_member_ban">deserialize_guild_member_ban</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.GuildMemberBan'>GuildMemberBan</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_member_ban -- Parse a raw payload from Discord into a guild member ban object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_member_ban"
>deserialize_guild_member_ban</a></code>
</p>
<p>Parse a raw payload from Discord into a guild member ban object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.GuildMemberBan'>GuildMemberBan</a></code></dt>
<dd>The deserialized guild member ban object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1076-L1077" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_member_ban(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildMemberBan:
    return guild_models.GuildMemberBan(reason=payload[&#34;reason&#34;], user=self.deserialize_user(payload[&#34;user&#34;]))</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_news_channel" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_news_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_news_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_news_channel">deserialize_guild_news_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildNewsChannel'>GuildNewsChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_news_channel -- Parse a raw payload from Discord into a guild news channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_news_channel"
>deserialize_guild_news_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild news channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildNewsChannel'>GuildNewsChannel</a></code></dt>
<dd>The deserialized guild news channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L616-L645" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_news_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildNewsChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

    last_message_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
        last_message_id = snowflakes.Snowflake(raw_last_message_id)

    last_pin_timestamp: typing.Optional[datetime.datetime] = None
    if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
        last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

    return channel_models.GuildNewsChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
        topic=payload[&#34;topic&#34;],
        last_message_id=last_message_id,
        last_pin_timestamp=last_pin_timestamp,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_preview" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_preview" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_preview" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_preview">deserialize_guild_preview</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.GuildPreview'>GuildPreview</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_preview -- Parse a raw payload from Discord into a guild preview object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_preview"
>deserialize_guild_preview</a></code>
</p>
<p>Parse a raw payload from Discord into a guild preview object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.GuildPreview'>GuildPreview</a></code></dt>
<dd>The deserialized guild preview object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1092-L1110" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_preview(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildPreview:
    guild_fields = self._set_partial_guild_attributes(payload)
    emojis = {
        snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
        for emoji in payload[&#34;emojis&#34;]
    }
    return guild_models.GuildPreview(
        app=self._app,
        id=guild_fields.id,
        name=guild_fields.name,
        icon_hash=guild_fields.icon_hash,
        features=guild_fields.features,
        splash_hash=payload[&#34;splash&#34;],
        discovery_splash_hash=payload[&#34;discovery_splash&#34;],
        emojis=emojis,
        approximate_active_member_count=int(payload[&#34;approximate_presence_count&#34;]),
        approximate_member_count=int(payload[&#34;approximate_member_count&#34;]),
        description=payload[&#34;description&#34;],
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_store_channel" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_store_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_store_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_store_channel">deserialize_guild_store_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildStoreChannel'>GuildStoreChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_store_channel -- Parse a raw payload from Discord into a guild store channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_store_channel"
>deserialize_guild_store_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild store channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildStoreChannel'>GuildStoreChannel</a></code></dt>
<dd>The deserialized guild store channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L647-L664" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_store_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildStoreChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
    return channel_models.GuildStoreChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_text_channel" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_text_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_text_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_text_channel">deserialize_guild_text_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildTextChannel'>GuildTextChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_text_channel -- Parse a raw payload from Discord into a guild text channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_text_channel"
>deserialize_guild_text_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild text channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildTextChannel'>GuildTextChannel</a></code></dt>
<dd>The deserialized guild text channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L581-L614" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_text_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildTextChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

    last_message_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_last_message_id := payload[&#34;last_message_id&#34;]) is not None:
        last_message_id = snowflakes.Snowflake(raw_last_message_id)

    last_pin_timestamp: typing.Optional[datetime.datetime] = None
    if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
        last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

    return channel_models.GuildTextChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
        topic=payload[&#34;topic&#34;],
        last_message_id=last_message_id,
        # Usually this is 0 if unset, but some old channels made before the
        # rate_limit_per_user field was implemented will not have this field
        # at all if they have never had the rate limit changed...
        rate_limit_per_user=datetime.timedelta(seconds=payload.get(&#34;rate_limit_per_user&#34;, 0)),
        last_pin_timestamp=last_pin_timestamp,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_voice_channel" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_voice_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_voice_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_voice_channel">deserialize_guild_voice_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildVoiceChannel'>GuildVoiceChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_voice_channel -- Parse a raw payload from Discord into a guild voice channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_voice_channel"
>deserialize_guild_voice_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild voice channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is npt included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildVoiceChannel'>GuildVoiceChannel</a></code></dt>
<dd>The deserialized guild voice channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L666-L685" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_voice_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildVoiceChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
    return channel_models.GuildVoiceChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
        bitrate=int(payload[&#34;bitrate&#34;]),
        user_limit=int(payload[&#34;user_limit&#34;]),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_widget" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_widget" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_widget" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_widget">deserialize_guild_widget</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.GuildWidget'>GuildWidget</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_widget -- Parse a raw payload from Discord into a guild widget object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_widget"
>deserialize_guild_widget</a></code>
</p>
<p>Parse a raw payload from Discord into a guild widget object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.GuildWidget'>GuildWidget</a></code></dt>
<dd>The deserialized guild widget object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L967-L972" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_widget(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildWidget:
    channel_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
        channel_id = snowflakes.Snowflake(raw_channel_id)

    return guild_models.GuildWidget(app=self._app, channel_id=channel_id, is_enabled=payload[&#34;enabled&#34;])</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_integration" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_integration" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_integration" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_integration">deserialize_integration</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.Integration'>Integration</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_integration -- Parse a raw payload from Discord into an integration object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_integration"
>deserialize_integration</a></code>
</p>
<p>Parse a raw payload from Discord into an integration object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.Integration'>Integration</a></code></dt>
<dd>The deserialized integration object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1050-L1074" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.Integration:
    integration_fields = self._set_partial_integration_attributes(payload)

    role_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_role_id := payload.get(&#34;role_id&#34;)) is not None:
        role_id = snowflakes.Snowflake(raw_role_id)

    last_synced_at: typing.Optional[datetime.datetime] = None
    if (raw_last_synced_at := payload.get(&#34;synced_at&#34;)) is not None:
        last_synced_at = time.iso8601_datetime_string_to_datetime(raw_last_synced_at)

    return guild_models.Integration(
        id=integration_fields.id,
        name=integration_fields.name,
        type=integration_fields.type,
        account=integration_fields.account,
        is_enabled=payload[&#34;enabled&#34;],
        is_syncing=payload[&#34;syncing&#34;],
        role_id=role_id,
        is_emojis_enabled=payload.get(&#34;enable_emoticons&#34;),
        expire_behavior=guild_models.IntegrationExpireBehaviour(payload[&#34;expire_behavior&#34;]),
        expire_grace_period=datetime.timedelta(days=payload[&#34;expire_grace_period&#34;]),
        user=self.deserialize_user(payload[&#34;user&#34;]),
        last_synced_at=last_synced_at,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_invite" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite">deserialize_invite</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../invites.html#hikari.invites.Invite'>Invite</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_invite -- Parse a raw payload from Discord into an invite object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_invite"
>deserialize_invite</a></code>
</p>
<p>Parse a raw payload from Discord into an invite object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../invites.html#hikari.invites.Invite'>Invite</a></code></dt>
<dd>The deserialized invite object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1368-L1382" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_invite(self, payload: data_binding.JSONObject) -&gt; invite_models.Invite:
    invite_fields = self._set_invite_attributes(payload)
    return invite_models.Invite(
        app=self._app,
        code=invite_fields.code,
        guild=invite_fields.guild,
        guild_id=invite_fields.guild_id,
        channel=invite_fields.channel,
        channel_id=invite_fields.channel_id,
        inviter=invite_fields.inviter,
        target_user=invite_fields.target_user,
        target_user_type=invite_fields.target_user_type,
        approximate_member_count=invite_fields.approximate_member_count,
        approximate_active_member_count=invite_fields.approximate_active_member_count,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite_with_metadata" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_invite_with_metadata" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite_with_metadata" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite_with_metadata">deserialize_invite_with_metadata</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../invites.html#hikari.invites.InviteWithMetadata'>InviteWithMetadata</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_invite_with_metadata -- Parse a raw payload from Discord into a invite with metadata object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_invite_with_metadata"
>deserialize_invite_with_metadata</a></code>
</p>
<p>Parse a raw payload from Discord into a invite with metadata object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../invites.html#hikari.invites.InviteWithMetadata'>InviteWithMetadata</a></code></dt>
<dd>The deserialized invite with metadata object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1384-L1404" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_invite_with_metadata(self, payload: data_binding.JSONObject) -&gt; invite_models.InviteWithMetadata:
    invite_fields = self._set_invite_attributes(payload)
    max_age = payload[&#34;max_age&#34;]
    return invite_models.InviteWithMetadata(
        app=self._app,
        code=invite_fields.code,
        guild=invite_fields.guild,
        guild_id=invite_fields.guild_id,
        channel=invite_fields.channel,
        channel_id=invite_fields.channel_id,
        inviter=invite_fields.inviter,
        target_user=invite_fields.target_user,
        target_user_type=invite_fields.target_user_type,
        approximate_member_count=invite_fields.approximate_member_count,
        approximate_active_member_count=invite_fields.approximate_active_member_count,
        uses=int(payload[&#34;uses&#34;]),
        max_uses=int(payload[&#34;max_uses&#34;]),
        max_age=datetime.timedelta(seconds=max_age) if max_age &gt; 0 else None,
        is_temporary=payload[&#34;temporary&#34;],
        created_at=time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;]),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_known_custom_emoji" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_known_custom_emoji" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_known_custom_emoji" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_known_custom_emoji">deserialize_known_custom_emoji</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>,
) -> <a href='../emojis.html#hikari.emojis.KnownCustomEmoji'>KnownCustomEmoji</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_known_custom_emoji -- Parse a raw payload from Discord into a known custom emoji object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_known_custom_emoji"
>deserialize_known_custom_emoji</a></code>
</p>
<p>Parse a raw payload from Discord into a known custom emoji object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this emoji belongs to. This is used to ensure
that the guild a known custom emoji belongs to is remembered by
allowing for a context based artificial <code>guild_id</code> attribute.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../emojis.html#hikari.emojis.KnownCustomEmoji'>KnownCustomEmoji</a></code></dt>
<dd>The deserialized "known custom emoji" object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L913-L933" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_known_custom_emoji(
    self, payload: data_binding.JSONObject, *, guild_id: snowflakes.Snowflake
) -&gt; emoji_models.KnownCustomEmoji:
    role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]] if &#34;roles&#34; in payload else []

    user: typing.Optional[user_models.User] = None
    if (raw_user := payload.get(&#34;user&#34;)) is not None:
        user = self.deserialize_user(raw_user)

    return emoji_models.KnownCustomEmoji(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        is_animated=payload.get(&#34;animated&#34;, False),
        guild_id=guild_id,
        role_ids=role_ids,
        user=user,
        is_colons_required=payload[&#34;require_colons&#34;],
        is_managed=payload[&#34;managed&#34;],
        is_available=payload[&#34;available&#34;],
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_member" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member">deserialize_member</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    user: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../users.html#hikari.users.User'>user_models.User</a>] = UNDEFINED,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../guilds.html#hikari.guilds.Member'>Member</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_member -- Parse a raw payload from Discord into a member object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_member"
>deserialize_member</a></code>
</p>
<p>Parse a raw payload from Discord into a member object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>user</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../users.html#hikari.users.User'>User</a>]</code></dt>
<dd>The user to attach to this member, should only be passed in
situations where "user" is not included in the payload.</dd>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this member belongs to. If this is specified
then this will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> covers cases such as the GUILD_CREATE gateway event and
GET Guild Member where <code>"guild_id"</code> is not included in the returned
payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.Member'>Member</a></code></dt>
<dd>The deserialized member object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L974-L1008" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_member(
    self,
    payload: data_binding.JSONObject,
    *,
    user: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; guild_models.Member:
    if user is undefined.UNDEFINED:
        user = self.deserialize_user(payload[&#34;user&#34;])

    if guild_id is undefined.UNDEFINED:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

    role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]]
    # If Discord ever does start including this here without warning we don&#39;t want to duplicate the entry.
    if guild_id not in role_ids:
        role_ids.append(guild_id)

    joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;])

    raw_premium_since = payload.get(&#34;premium_since&#34;)
    premium_since = (
        time.iso8601_datetime_string_to_datetime(raw_premium_since) if raw_premium_since is not None else None
    )

    return guild_models.Member(
        user=user,
        guild_id=guild_id,
        role_ids=role_ids,
        joined_at=joined_at,
        nickname=payload[&#34;nick&#34;] if &#34;nick&#34; in payload else undefined.UNDEFINED,
        premium_since=premium_since,
        is_deaf=payload[&#34;deaf&#34;] if &#34;deaf&#34; in payload else undefined.UNDEFINED,
        is_mute=payload[&#34;mute&#34;] if &#34;mute&#34; in payload else undefined.UNDEFINED,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member_presence" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_member_presence" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member_presence" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member_presence">deserialize_member_presence</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../presences.html#hikari.presences.MemberPresence'>MemberPresence</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_member_presence -- Parse a raw payload from Discord into a member presence object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_member_presence"
>deserialize_member_presence</a></code>
</p>
<p>Parse a raw payload from Discord into a member presence object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild the presence belongs to. If this is specified
then it is prioritised over <code>guild_id</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>At the time of writing, the only place where <code>guild_id</code> will be
mandatory is when parsing presences sent in a <code>GUILD_CREATE</code> event
from Discord, since the <code>guild_id</code> attribute in the payload will
have been omitted for redundancy.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../presences.html#hikari.presences.MemberPresence'>MemberPresence</a></code></dt>
<dd>The deserialized member presence object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>
<p>If <code>guild_id</code> is not an attribute of the <code>payload</code> dict, and no
guild ID was passed for the <code>guild_id</code> parameter.</p>
<p>If this is raised, no guild ID info was provided anywhere.</p>
</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1631-L1738" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_member_presence(  # noqa: CFQ001  # TODO: what&#39;s CFQ001?
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; presence_models.MemberPresence:
    activities = []
    for activity_payload in payload[&#34;activities&#34;]:
        timestamps: typing.Optional[presence_models.ActivityTimestamps] = None
        if &#34;timestamps&#34; in activity_payload:
            timestamps_payload = activity_payload[&#34;timestamps&#34;]
            start = (
                time.unix_epoch_to_datetime(timestamps_payload[&#34;start&#34;]) if &#34;start&#34; in timestamps_payload else None
            )
            end = time.unix_epoch_to_datetime(timestamps_payload[&#34;end&#34;]) if &#34;end&#34; in timestamps_payload else None
            timestamps = presence_models.ActivityTimestamps(start=start, end=end)

        application_id = (
            snowflakes.Snowflake(activity_payload[&#34;application_id&#34;])
            if &#34;application_id&#34; in activity_payload
            else None
        )

        party: typing.Optional[presence_models.ActivityParty] = None
        if &#34;party&#34; in activity_payload:
            party_payload = activity_payload[&#34;party&#34;]

            current_size: typing.Optional[int]
            max_size: typing.Optional[int]
            if &#34;size&#34; in party_payload:
                raw_current_size, raw_max_size = party_payload[&#34;size&#34;]
                current_size = int(raw_current_size)
                max_size = int(raw_max_size)
            else:
                current_size = max_size = None

            party = presence_models.ActivityParty(
                id=party_payload.get(&#34;id&#34;), current_size=current_size, max_size=max_size
            )

        assets: typing.Optional[presence_models.ActivityAssets] = None
        if &#34;assets&#34; in activity_payload:
            assets_payload = activity_payload[&#34;assets&#34;]
            assets = presence_models.ActivityAssets(
                large_image=assets_payload.get(&#34;large_image&#34;),
                large_text=assets_payload.get(&#34;large_text&#34;),
                small_image=assets_payload.get(&#34;small_image&#34;),
                small_text=assets_payload.get(&#34;small_text&#34;),
            )

        secrets: typing.Optional[presence_models.ActivitySecret] = None
        if &#34;secrets&#34; in activity_payload:
            secrets_payload = activity_payload[&#34;secrets&#34;]
            secrets = presence_models.ActivitySecret(
                join=secrets_payload.get(&#34;join&#34;),
                spectate=secrets_payload.get(&#34;spectate&#34;),
                match=secrets_payload.get(&#34;match&#34;),
            )

        emoji: typing.Optional[emoji_models.Emoji] = None
        raw_emoji = activity_payload.get(&#34;emoji&#34;)
        if raw_emoji is not None:
            emoji = self.deserialize_emoji(raw_emoji)

        activity = presence_models.RichActivity(
            name=activity_payload[&#34;name&#34;],
            type=presence_models.ActivityType(activity_payload[&#34;type&#34;]),
            url=activity_payload.get(&#34;url&#34;),
            created_at=time.unix_epoch_to_datetime(activity_payload[&#34;created_at&#34;]),
            timestamps=timestamps,
            application_id=application_id,
            details=activity_payload.get(&#34;details&#34;),
            state=activity_payload.get(&#34;state&#34;),
            emoji=emoji,
            party=party,
            assets=assets,
            secrets=secrets,
            is_instance=activity_payload.get(&#34;instance&#34;),  # TODO: can we safely default this to False?
            flags=presence_models.ActivityFlag(activity_payload[&#34;flags&#34;]) if &#34;flags&#34; in activity_payload else None,
        )
        activities.append(activity)

    client_status_payload = payload[&#34;client_status&#34;]
    desktop = (
        presence_models.Status(client_status_payload[&#34;desktop&#34;])
        if &#34;desktop&#34; in client_status_payload
        else presence_models.Status.OFFLINE
    )
    mobile = (
        presence_models.Status(client_status_payload[&#34;mobile&#34;])
        if &#34;mobile&#34; in client_status_payload
        else presence_models.Status.OFFLINE
    )
    web = (
        presence_models.Status(client_status_payload[&#34;web&#34;])
        if &#34;web&#34; in client_status_payload
        else presence_models.Status.OFFLINE
    )
    client_status = presence_models.ClientStatus(desktop=desktop, mobile=mobile, web=web)

    return presence_models.MemberPresence(
        app=self._app,
        user_id=snowflakes.Snowflake(payload[&#34;user&#34;][&#34;id&#34;]),
        guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
        visible_status=presence_models.Status(payload[&#34;status&#34;]),
        activities=activities,
        client_status=client_status,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_message" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_message" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_message" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_message">deserialize_message</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../messages.html#hikari.messages.Message'>Message</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_message -- Parse a raw payload from Discord into a message object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_message"
>deserialize_message</a></code>
</p>
<p>Parse a raw payload from Discord into a message object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../messages.html#hikari.messages.Message'>Message</a></code></dt>
<dd>The deserialized message object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1530-L1625" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_message(self, payload: data_binding.JSONObject) -&gt; message_models.Message:
    guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None
    author = self.deserialize_user(payload[&#34;author&#34;])

    member: typing.Optional[guild_models.Member] = None
    if &#34;member&#34; in payload:
        assert guild_id is not None
        member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id, user=author)

    edited_timestamp: typing.Optional[datetime.datetime] = None
    if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
        edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)

    user_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mentions&#34;]]
    role_mentions = [snowflakes.Snowflake(mention) for mention in payload[&#34;mention_roles&#34;]]
    channel_mentions = (
        [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mention_channels&#34;]]
        if &#34;mention_channels&#34; in payload
        else []
    )

    attachments = []
    for attachment_payload in payload[&#34;attachments&#34;]:
        attachment = message_models.Attachment(
            id=snowflakes.Snowflake(attachment_payload[&#34;id&#34;]),
            filename=attachment_payload[&#34;filename&#34;],
            size=int(attachment_payload[&#34;size&#34;]),
            url=attachment_payload[&#34;url&#34;],
            proxy_url=attachment_payload[&#34;proxy_url&#34;],
            height=attachment_payload.get(&#34;height&#34;),
            width=attachment_payload.get(&#34;width&#34;),
        )
        attachments.append(attachment)

    embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

    reactions = []
    if &#34;reactions&#34; in payload:
        for reaction_payload in payload[&#34;reactions&#34;]:
            reaction = message_models.Reaction(
                count=int(reaction_payload[&#34;count&#34;]),
                emoji=self.deserialize_emoji(reaction_payload[&#34;emoji&#34;]),
                is_me=reaction_payload[&#34;me&#34;],
            )
            reactions.append(reaction)

    activity: typing.Optional[message_models.MessageActivity] = None
    if &#34;activity&#34; in payload:
        activity_payload = payload[&#34;activity&#34;]
        activity = message_models.MessageActivity(
            type=message_models.MessageActivityType(activity_payload[&#34;type&#34;]),
            party_id=activity_payload.get(&#34;party_id&#34;),
        )

    crosspost: typing.Optional[message_models.MessageCrosspost] = None
    if &#34;message_reference&#34; in payload:
        crosspost_payload = payload[&#34;message_reference&#34;]
        crosspost_id = (
            snowflakes.Snowflake(crosspost_payload[&#34;message_id&#34;]) if &#34;message_id&#34; in crosspost_payload else None
        )
        crosspost = message_models.MessageCrosspost(
            app=self._app,
            id=crosspost_id,
            channel_id=snowflakes.Snowflake(crosspost_payload[&#34;channel_id&#34;]),
            guild_id=snowflakes.Snowflake(crosspost_payload[&#34;guild_id&#34;])
            if &#34;guild_id&#34; in crosspost_payload
            else None,
        )

    return message_models.Message(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        guild_id=guild_id,
        author=author,
        member=member,
        content=payload[&#34;content&#34;],
        timestamp=time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]),
        edited_timestamp=edited_timestamp,
        is_tts=payload[&#34;tts&#34;],
        is_mentioning_everyone=payload[&#34;mention_everyone&#34;],
        user_mentions=user_mentions,
        role_mentions=role_mentions,
        channel_mentions=channel_mentions,
        attachments=attachments,
        embeds=embeds,
        reactions=reactions,
        is_pinned=payload[&#34;pinned&#34;],
        webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else None,
        type=message_models.MessageType(payload[&#34;type&#34;]),
        activity=activity,
        application=self.deserialize_application(payload[&#34;application&#34;]) if &#34;application&#34; in payload else None,
        message_reference=crosspost,
        flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else None,
        nonce=payload.get(&#34;nonce&#34;),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_my_user" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_my_user" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_my_user" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_my_user">deserialize_my_user</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../users.html#hikari.users.OwnUser'>OwnUser</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_my_user -- Parse a raw payload from Discord into a user object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_my_user"
>deserialize_my_user</a></code>
</p>
<p>Parse a raw payload from Discord into a user object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../users.html#hikari.users.OwnUser'>OwnUser</a></code></dt>
<dd>The deserialized user object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1771-L1787" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_my_user(self, payload: data_binding.JSONObject) -&gt; user_models.OwnUser:
    user_fields = self._set_user_attributes(payload)
    return user_models.OwnUser(
        app=self._app,
        id=user_fields.id,
        discriminator=user_fields.discriminator,
        username=user_fields.username,
        avatar_hash=user_fields.avatar_hash,
        is_bot=user_fields.is_bot,
        is_system=user_fields.is_system,
        is_mfa_enabled=payload[&#34;mfa_enabled&#34;],
        locale=payload.get(&#34;locale&#34;),
        is_verified=payload.get(&#34;verified&#34;),
        email=payload.get(&#34;email&#34;),
        flags=user_models.UserFlag(payload[&#34;flags&#34;]),
        premium_type=user_models.PremiumType(payload[&#34;premium_type&#34;]) if &#34;premium_type&#34; in payload else None,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_connection" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_own_connection" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_connection" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_connection">deserialize_own_connection</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.OwnConnection'>OwnConnection</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_own_connection -- Parse a raw payload from Discord into an own connection object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_own_connection"
>deserialize_own_connection</a></code>
</p>
<p>Parse a raw payload from Discord into an own connection object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.OwnConnection'>OwnConnection</a></code></dt>
<dd>The deserialized "own connection" object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L243-L259" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_own_connection(self, payload: data_binding.JSONObject) -&gt; application_models.OwnConnection:
    if (integration_payloads := payload.get(&#34;integrations&#34;)) is not None:
        integrations = [self.deserialize_partial_integration(integration) for integration in integration_payloads]
    else:
        integrations = []

    return application_models.OwnConnection(
        id=payload[&#34;id&#34;],
        name=payload[&#34;name&#34;],
        type=payload[&#34;type&#34;],
        is_revoked=payload[&#34;revoked&#34;],
        integrations=integrations,
        is_verified=payload[&#34;verified&#34;],
        is_friend_sync_enabled=payload[&#34;friend_sync&#34;],
        is_activity_visible=payload[&#34;show_activity&#34;],
        visibility=application_models.ConnectionVisibility(payload[&#34;visibility&#34;]),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_guild" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_own_guild" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_guild" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_guild">deserialize_own_guild</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.OwnGuild'>OwnGuild</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_own_guild -- Parse a raw payload from Discord into an own guild object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_own_guild"
>deserialize_own_guild</a></code>
</p>
<p>Parse a raw payload from Discord into an own guild object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.OwnGuild'>OwnGuild</a></code></dt>
<dd>The deserialized "own guild" object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L261-L271" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_own_guild(self, payload: data_binding.JSONObject) -&gt; application_models.OwnGuild:
    guild_fields = self._set_partial_guild_attributes(payload)
    return application_models.OwnGuild(
        app=self._app,
        id=guild_fields.id,
        name=guild_fields.name,
        icon_hash=guild_fields.icon_hash,
        features=guild_fields.features,
        is_owner=bool(payload[&#34;owner&#34;]),
        my_permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_channel" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_channel">deserialize_partial_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.PartialChannel'>PartialChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_channel -- Parse a raw payload from Discord into a partial channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_channel"
>deserialize_partial_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a partial channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.PartialChannel'>PartialChannel</a></code></dt>
<dd>The deserialized "partial channel" object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L484-L490" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_channel(self, payload: data_binding.JSONObject) -&gt; channel_models.PartialChannel:
    return channel_models.PartialChannel(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload.get(&#34;name&#34;),
        type=channel_models.ChannelType(payload[&#34;type&#34;]),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_integration" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_integration" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_integration" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_integration">deserialize_partial_integration</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.PartialIntegration'>PartialIntegration</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_integration -- Parse a raw payload from Discord into a partial integration object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_integration"
>deserialize_partial_integration</a></code>
</p>
<p>Parse a raw payload from Discord into a partial integration object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.PartialIntegration'>PartialIntegration</a></code></dt>
<dd>The deserialized partial integration object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1041-L1048" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.PartialIntegration:
    integration_fields = self._set_partial_integration_attributes(payload)
    return guild_models.PartialIntegration(
        id=integration_fields.id,
        name=integration_fields.name,
        type=integration_fields.type,
        account=integration_fields.account,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_message" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_message" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_message" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_message">deserialize_partial_message</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../messages.html#hikari.messages.PartialMessage'>PartialMessage</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_message -- Parse a raw payload from Discord into a partial message object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_message"
>deserialize_partial_message</a></code>
</p>
<p>Parse a raw payload from Discord into a partial message object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../messages.html#hikari.messages.PartialMessage'>PartialMessage</a></code></dt>
<dd>The deserialized partial message object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1410-L1528" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_message(self, payload: data_binding.JSONObject) -&gt; message_models.PartialMessage:
    author: typing.Optional[user_models.User] = None
    if author_pl := payload.get(&#34;author&#34;):
        author = self.deserialize_user(author_pl)

    guild_id: typing.Optional[snowflakes.Snowflake] = None
    member: typing.Optional[guild_models.Member] = None
    if &#34;guild_id&#34; in payload:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        if author is not None and (member_pl := payload.get(&#34;member&#34;)):
            member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)

    timestamp: undefined.UndefinedOr[datetime.datetime] = undefined.UNDEFINED
    if &#34;timestamp&#34; in payload:
        timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;])

    edited_timestamp: undefined.UndefinedNoneOr[datetime.datetime] = undefined.UNDEFINED
    if &#34;edited_timestamp&#34; in payload:
        if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
            edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)
        else:
            edited_timestamp = None

    is_mentioning_everyone = payload[&#34;mention_everyone&#34;] if &#34;mention_everyone&#34; in payload else undefined.UNDEFINED

    user_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
    if &#34;mentions&#34; in payload:
        user_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mentions&#34;]]

    role_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
    if &#34;mention_roles&#34; in payload:
        role_mentions = [snowflakes.Snowflake(mention) for mention in payload[&#34;mention_roles&#34;]]

    channel_mentions: undefined.UndefinedOr[typing.Sequence[snowflakes.Snowflake]] = undefined.UNDEFINED
    if &#34;mention_channels&#34; in payload:
        channel_mentions = [snowflakes.Snowflake(mention[&#34;id&#34;]) for mention in payload[&#34;mention_channels&#34;]]

    attachments: undefined.UndefinedOr[typing.MutableSequence[message_models.Attachment]] = undefined.UNDEFINED
    if &#34;attachments&#34; in payload:
        attachments = []
        for attachment_payload in payload[&#34;attachments&#34;]:
            attachment = message_models.Attachment(
                id=snowflakes.Snowflake(attachment_payload[&#34;id&#34;]),
                filename=attachment_payload[&#34;filename&#34;],
                size=int(attachment_payload[&#34;size&#34;]),
                url=attachment_payload[&#34;url&#34;],
                proxy_url=attachment_payload[&#34;proxy_url&#34;],
                height=attachment_payload.get(&#34;height&#34;),
                width=attachment_payload.get(&#34;width&#34;),
            )
            attachments.append(attachment)

    embeds: undefined.UndefinedOr[typing.Sequence[embed_models.Embed]] = undefined.UNDEFINED
    if &#34;embeds&#34; in payload:
        embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

    reactions: undefined.UndefinedOr[typing.MutableSequence[message_models.Reaction]] = undefined.UNDEFINED
    if &#34;reactions&#34; in payload:
        reactions = []
        for reaction_payload in payload[&#34;reactions&#34;]:
            reaction = message_models.Reaction(
                count=int(reaction_payload[&#34;count&#34;]),
                emoji=self.deserialize_emoji(reaction_payload[&#34;emoji&#34;]),
                is_me=reaction_payload[&#34;me&#34;],
            )
            reactions.append(reaction)

    activity: undefined.UndefinedOr[message_models.MessageActivity] = undefined.UNDEFINED
    if &#34;activity&#34; in payload:
        activity_payload = payload[&#34;activity&#34;]
        activity = message_models.MessageActivity(
            type=message_models.MessageActivityType(activity_payload[&#34;type&#34;]),
            party_id=activity_payload.get(&#34;party_id&#34;),
        )

    application: undefined.UndefinedOr[application_models.Application] = undefined.UNDEFINED
    if &#34;application&#34; in payload:
        application = self.deserialize_application(payload[&#34;application&#34;])

    message_reference: undefined.UndefinedOr[message_models.MessageCrosspost] = undefined.UNDEFINED
    if &#34;message_reference&#34; in payload:
        crosspost_payload = payload[&#34;message_reference&#34;]
        message_reference = message_models.MessageCrosspost(
            app=self._app,
            id=snowflakes.Snowflake(crosspost_payload[&#34;message_id&#34;]) if &#34;message_id&#34; in crosspost_payload else None,
            channel_id=snowflakes.Snowflake(crosspost_payload[&#34;channel_id&#34;]),
            guild_id=snowflakes.Snowflake(crosspost_payload[&#34;guild_id&#34;])
            if &#34;guild_id&#34; in crosspost_payload
            else None,
        )

    return message_models.PartialMessage(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        guild_id=guild_id,
        author=author,
        member=member,
        content=payload[&#34;content&#34;] if &#34;content&#34; in payload else undefined.UNDEFINED,
        timestamp=timestamp,
        edited_timestamp=edited_timestamp,
        is_tts=payload[&#34;tts&#34;] if &#34;tts&#34; in payload else undefined.UNDEFINED,
        is_mentioning_everyone=is_mentioning_everyone,
        user_mentions=user_mentions,
        role_mentions=role_mentions,
        channel_mentions=channel_mentions,
        attachments=attachments,
        embeds=embeds,
        reactions=reactions,
        is_pinned=payload[&#34;pinned&#34;] if &#34;pinned&#34; in payload else undefined.UNDEFINED,
        webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else undefined.UNDEFINED,
        type=message_models.MessageType(payload[&#34;type&#34;]) if &#34;type&#34; in payload else undefined.UNDEFINED,
        activity=activity,
        application=application,
        message_reference=message_reference,
        flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else undefined.UNDEFINED,
        nonce=payload[&#34;nonce&#34;] if &#34;nonce&#34; in payload else undefined.UNDEFINED,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_permission_overwrite" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_permission_overwrite" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_permission_overwrite" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_permission_overwrite">deserialize_permission_overwrite</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.PermissionOverwrite'>PermissionOverwrite</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_permission_overwrite -- Parse a raw payload from Discord into a permission overwrite object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_permission_overwrite"
>deserialize_permission_overwrite</a></code>
</p>
<p>Parse a raw payload from Discord into a permission overwrite object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.PermissionOverwrite'>PermissionOverwrite</a></code></dt>
<dd>The deserialized permission overwrite object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L466-L472" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_permission_overwrite(self, payload: data_binding.JSONObject) -&gt; channel_models.PermissionOverwrite:
    return channel_models.PermissionOverwrite(
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        type=channel_models.PermissionOverwriteType(payload[&#34;type&#34;]),
        allow=permission_models.Permissions(int(payload[&#34;allow&#34;])),
        deny=permission_models.Permissions(int(payload[&#34;deny&#34;])),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_rest_guild" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_rest_guild" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_rest_guild" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_rest_guild">deserialize_rest_guild</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.RESTGuild'>RESTGuild</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_rest_guild -- Parse a raw payload from Discord into a guild object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_rest_guild"
>deserialize_rest_guild</a></code>
</p>
<p>Parse a raw payload from Discord into a guild object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.RESTGuild'>RESTGuild</a></code></dt>
<dd>The deserialized guild object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1163-L1220" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_rest_guild(self, payload: data_binding.JSONObject) -&gt; guild_models.RESTGuild:
    guild_fields = self._set_guild_attributes(payload)
    approximate_member_count = int(payload[&#34;approximate_member_count&#34;])
    approximate_active_member_count = int(payload[&#34;approximate_presence_count&#34;])
    max_members = int(payload[&#34;max_members&#34;])

    raw_max_presences = payload[&#34;max_presences&#34;]
    if raw_max_presences is None:
        max_presences = _DEFAULT_MAX_PRESENCES
    else:
        max_presences = int(raw_max_presences)

    roles = {
        snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild_fields.id)
        for role in payload[&#34;roles&#34;]
    }
    emojis = {
        snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
        for emoji in payload[&#34;emojis&#34;]
    }
    guild = guild_models.RESTGuild(
        app=self._app,
        id=guild_fields.id,
        name=guild_fields.name,
        icon_hash=guild_fields.icon_hash,
        features=guild_fields.features,
        splash_hash=guild_fields.splash_hash,
        discovery_splash_hash=guild_fields.discovery_splash_hash,
        owner_id=guild_fields.owner_id,
        region=guild_fields.region,
        afk_channel_id=guild_fields.afk_channel_id,
        afk_timeout=guild_fields.afk_timeout,
        verification_level=guild_fields.verification_level,
        default_message_notifications=guild_fields.default_message_notifications,
        explicit_content_filter=guild_fields.explicit_content_filter,
        mfa_level=guild_fields.mfa_level,
        application_id=guild_fields.application_id,
        widget_channel_id=guild_fields.widget_channel_id,
        system_channel_id=guild_fields.system_channel_id,
        is_widget_enabled=guild_fields.is_widget_enabled,
        system_channel_flags=guild_fields.system_channel_flags,
        rules_channel_id=guild_fields.rules_channel_id,
        max_presences=max_presences,
        max_members=max_members,
        max_video_channel_users=guild_fields.max_video_channel_users,
        vanity_url_code=guild_fields.vanity_url_code,
        description=guild_fields.description,
        banner_hash=guild_fields.banner_hash,
        premium_tier=guild_fields.premium_tier,
        premium_subscription_count=guild_fields.premium_subscription_count,
        preferred_locale=guild_fields.preferred_locale,
        public_updates_channel_id=guild_fields.public_updates_channel_id,
        approximate_member_count=approximate_member_count,
        approximate_active_member_count=approximate_active_member_count,
        roles=roles,
        emojis=emojis,
    )
    return guild</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_role" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_role" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_role" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_role">deserialize_role</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>,
) -> <a href='../guilds.html#hikari.guilds.Role'>Role</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_role -- Parse a raw payload from Discord into a role object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_role"
>deserialize_role</a></code>
</p>
<p>Parse a raw payload from Discord into a role object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this role belongs to. This is used to ensure
that the guild a role belongs to is remembered by allowing for a
context based artificial <code>guild_id</code> attribute.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.Role'>Role</a></code></dt>
<dd>The deserialized role object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1010-L1028" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_role(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: snowflakes.Snowflake,
) -&gt; guild_models.Role:
    return guild_models.Role(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        guild_id=guild_id,
        name=payload[&#34;name&#34;],
        color=color_models.Color(payload[&#34;color&#34;]),
        is_hoisted=payload[&#34;hoist&#34;],
        position=int(payload[&#34;position&#34;]),
        # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
        permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
        is_managed=payload[&#34;managed&#34;],
        is_mentionable=payload[&#34;mentionable&#34;],
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_unicode_emoji" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_unicode_emoji" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_unicode_emoji" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_unicode_emoji">deserialize_unicode_emoji</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../emojis.html#hikari.emojis.UnicodeEmoji'>UnicodeEmoji</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_unicode_emoji -- Parse a raw payload from Discord into a unicode emoji object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_unicode_emoji"
>deserialize_unicode_emoji</a></code>
</p>
<p>Parse a raw payload from Discord into a unicode emoji object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../emojis.html#hikari.emojis.UnicodeEmoji'>UnicodeEmoji</a></code></dt>
<dd>The deserialized unicode emoji object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L903-L904" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_unicode_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.UnicodeEmoji:
    return emoji_models.UnicodeEmoji(name=payload[&#34;name&#34;])</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_user" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_user" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_user" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_user">deserialize_user</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../users.html#hikari.users.User'>User</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_user -- Parse a raw payload from Discord into a user object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_user"
>deserialize_user</a></code>
</p>
<p>Parse a raw payload from Discord into a user object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../users.html#hikari.users.User'>User</a></code></dt>
<dd>The deserialized user object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1755-L1769" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_user(self, payload: data_binding.JSONObject) -&gt; user_models.User:
    user_fields = self._set_user_attributes(payload)
    flags = (
        user_models.UserFlag(payload[&#34;public_flags&#34;]) if &#34;public_flags&#34; in payload else user_models.UserFlag.NONE
    )
    return user_models.UserImpl(
        app=self._app,
        id=user_fields.id,
        discriminator=user_fields.discriminator,
        username=user_fields.username,
        avatar_hash=user_fields.avatar_hash,
        is_bot=user_fields.is_bot,
        is_system=user_fields.is_system,
        flags=flags,
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_vanity_url" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_vanity_url" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_vanity_url" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_vanity_url">deserialize_vanity_url</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../invites.html#hikari.invites.VanityURL'>VanityURL</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_vanity_url -- Parse a raw payload from Discord into a vanity url object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_vanity_url"
>deserialize_vanity_url</a></code>
</p>
<p>Parse a raw payload from Discord into a vanity url object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../invites.html#hikari.invites.VanityURL'>VanityURL</a></code></dt>
<dd>The deserialized vanity url object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1314-L1315" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_vanity_url(self, payload: data_binding.JSONObject) -&gt; invite_models.VanityURL:
    return invite_models.VanityURL(app=self._app, code=payload[&#34;code&#34;], uses=int(payload[&#34;uses&#34;]))</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_region" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_voice_region" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_region" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_region">deserialize_voice_region</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../voices.html#hikari.voices.VoiceRegion'>VoiceRegion</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_voice_region -- Parse a raw payload from Discord into a voice region object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_voice_region"
>deserialize_voice_region</a></code>
</p>
<p>Parse a raw payload from Discord into a voice region object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../voices.html#hikari.voices.VoiceRegion'>VoiceRegion</a></code></dt>
<dd>The deserialized voice region object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1826-L1834" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_voice_region(self, payload: data_binding.JSONObject) -&gt; voice_models.VoiceRegion:
    return voice_models.VoiceRegion(
        id=payload[&#34;id&#34;],
        name=payload[&#34;name&#34;],
        is_vip=payload[&#34;vip&#34;],
        is_optimal_location=payload[&#34;optimal&#34;],
        is_deprecated=payload[&#34;deprecated&#34;],
        is_custom=payload[&#34;custom&#34;],
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_state" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_voice_state" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_state" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_state">deserialize_voice_state</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
    member: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../guilds.html#hikari.guilds.Member'>guild_models.Member</a>] = UNDEFINED,
) -> <a href='../voices.html#hikari.voices.VoiceState'>VoiceState</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_voice_state -- Parse a raw payload from Discord into a voice state object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_voice_state"
>deserialize_voice_state</a></code>
</p>
<p>Parse a raw payload from Discord into a voice state object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this voice state belongs to. If this is specified
then this will be prioritised over <code>"guild_id"</code> in the payload.</dd>
<dt><strong><code>member</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../guilds.html#hikari.guilds.Member'>Member</a>]</code></dt>
<dd>The object of the member this voice state belongs to. If this is
specified then this will be prioritised over <code>"member"</code> in the
payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>At the time of writing, <code>GUILD_CREATE</code> events are the only known
place where neither <code>guild_id</code> nor <code>member</code> will be keys on the
payload. In this case, you will need to provide the former
parameters explicitly.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../voices.html#hikari.voices.VoiceState'>VoiceState</a></code></dt>
<dd>The deserialized voice state object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>
<p>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload for the payload of
the voice state.</p>
<p>This will also be raised if no <code>member</code> data was passed in any
acceptable place.</p>
</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1793-L1824" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_voice_state(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    member: undefined.UndefinedOr[guild_models.Member] = undefined.UNDEFINED,
) -&gt; voice_models.VoiceState:
    if guild_id is undefined.UNDEFINED:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

    channel_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
        channel_id = snowflakes.Snowflake(raw_channel_id)

    if member is undefined.UNDEFINED:
        member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id)

    return voice_models.VoiceState(
        app=self._app,
        guild_id=guild_id,
        channel_id=channel_id,
        user_id=snowflakes.Snowflake(payload[&#34;user_id&#34;]),
        member=member,
        session_id=payload[&#34;session_id&#34;],
        is_guild_deafened=payload[&#34;deaf&#34;],
        is_guild_muted=payload[&#34;mute&#34;],
        is_self_deafened=payload[&#34;self_deaf&#34;],
        is_self_muted=payload[&#34;self_mute&#34;],
        is_streaming=payload.get(&#34;self_stream&#34;, False),
        is_video_enabled=payload[&#34;self_video&#34;],
        is_suppressed=payload[&#34;suppress&#34;],
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_webhook" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_webhook" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_webhook" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_webhook">deserialize_webhook</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../webhooks.html#hikari.webhooks.Webhook'>Webhook</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_webhook -- Parse a raw payload from Discord into a webhook object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_webhook"
>deserialize_webhook</a></code>
</p>
<p>Parse a raw payload from Discord into a webhook object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../webhooks.html#hikari.webhooks.Webhook'>Webhook</a></code></dt>
<dd>The deserialized webhook object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L1840-L1851" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.Webhook:
    return webhook_models.Webhook(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        type=webhook_models.WebhookType(payload[&#34;type&#34;]),
        guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
        name=payload[&#34;name&#34;],
        avatar_hash=payload[&#34;avatar&#34;],
        token=payload.get(&#34;token&#34;),
    )</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_embed" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="serialize_embed" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_embed" id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_embed">serialize_embed</a>(
    embed: <a href='../embeds.html#hikari.embeds.Embed'>embed_models.Embed</a>,
) -> Tuple[Dict[<a href='https://docs.python.org/3/library/stdtypes.html#str'>str</a>, Any], List[<a href='../files.html#hikari.files.Resource'>Resource</a>[<a href='../files.html#hikari.files.AsyncReader'>AsyncReader</a>]]]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="serialize_embed -- Serialize an embed object to a json serializable dict …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.serialize_embed"
>serialize_embed</a></code>
</p>
<p>Serialize an embed object to a json serializable dict.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>embed</code></strong> :&ensp;<code><a href='../embeds.html#hikari.embeds.Embed'>Embed</a></code></dt>
<dd>The embed object to serialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/typing.html#typing.Tuple'>Tuple</a>[<a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a>, <a href='https://docs.python.org/3/library/typing.html#typing.List'>List</a>[<a href='../files.html#hikari.files.Resource'>Resource</a>]]</code></dt>
<dd>A tuple with two items in it. The first item will be the serialized
embed representation. The second item will be a list of resources
to upload with the embed.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L794-L897" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def serialize_embed(  # noqa: C901
    self,
    embed: embed_models.Embed,
) -&gt; typing.Tuple[data_binding.JSONObject, typing.List[files.Resource[files.AsyncReader]]]:

    payload: data_binding.JSONObject = {}
    uploads: typing.List[files.Resource[files.AsyncReader]] = []

    if embed.title is not None:
        payload[&#34;title&#34;] = embed.title

    if embed.description is not None:
        payload[&#34;description&#34;] = embed.description

    if embed.url is not None:
        payload[&#34;url&#34;] = embed.url

    if embed.timestamp is not None:
        payload[&#34;timestamp&#34;] = embed.timestamp.isoformat()

    if embed.color is not None:
        payload[&#34;color&#34;] = int(embed.color)

    if embed.footer is not None:
        footer_payload: data_binding.JSONObject = {}

        if embed.footer.text is not None:
            footer_payload[&#34;text&#34;] = embed.footer.text

        if embed.footer.icon is not None:
            if not isinstance(embed.footer.icon.resource, files.WebResource):
                uploads.append(embed.footer.icon.resource)

            footer_payload[&#34;icon_url&#34;] = embed.footer.icon.url

        payload[&#34;footer&#34;] = footer_payload

    if embed.image is not None:
        image_payload: data_binding.JSONObject = {}

        if not isinstance(embed.image.resource, files.WebResource):
            uploads.append(embed.image.resource)

        image_payload[&#34;url&#34;] = embed.image.url
        payload[&#34;image&#34;] = image_payload

    if embed.thumbnail is not None:
        thumbnail_payload: data_binding.JSONObject = {}

        if not isinstance(embed.thumbnail.resource, files.WebResource):
            uploads.append(embed.thumbnail.resource)

        thumbnail_payload[&#34;url&#34;] = embed.thumbnail.url
        payload[&#34;thumbnail&#34;] = thumbnail_payload

    if embed.author is not None:
        author_payload: data_binding.JSONObject = {}

        if embed.author.name is not None:
            author_payload[&#34;name&#34;] = embed.author.name

        if embed.author.url is not None:
            author_payload[&#34;url&#34;] = embed.author.url

        if embed.author.icon is not None:
            if not isinstance(embed.author.icon.resource, files.WebResource):
                uploads.append(embed.author.icon.resource)
            author_payload[&#34;icon_url&#34;] = embed.author.icon.url

        payload[&#34;author&#34;] = author_payload

    if embed.fields:
        field_payloads: data_binding.JSONArray = []
        for i, field in enumerate(embed.fields):

            # Yep, this is technically two unreachable branches. However, this is an incredibly
            # common mistake to make when working with embeds and not using a static type
            # checker, so I have added these as additional safeguards for UX and ease
            # of debugging. The case that there are `None` should be detected immediately by
            # static type checkers, regardless.

            name = str(field.name) if field.name is not None else None  # type: ignore[unreachable]
            value = str(field.value) if field.value is not None else None  # type: ignore[unreachable]

            if name is None:
                raise TypeError(f&#34;in embed.fields[{i}].name - cannot have `None`&#34;)
            if not name:
                raise TypeError(f&#34;in embed.fields[{i}].name - cannot have empty string&#34;)
            if not name.strip():
                raise TypeError(f&#34;in embed.fields[{i}].name - cannot have only whitespace&#34;)

            if value is None:
                raise TypeError(f&#34;in embed.fields[{i}].value - cannot have `None`&#34;)
            if not value:
                raise TypeError(f&#34;in embed.fields[{i}].value - cannot have empty string&#34;)
            if not value.strip():
                raise TypeError(f&#34;in embed.fields[{i}].value - cannot have only whitespace&#34;)

            # Name and value always have to be specified; we can always
            # send a default `inline` value also just to keep this simpler.
            field_payloads.append({&#34;name&#34;: name, &#34;value&#34;: value, &#34;inline&#34;: field.is_inline})
        payload[&#34;fields&#34;] = field_payloads

    return payload, uploads</code></pre>
</details>
</dd>
<div class="sep"></div>
<dt>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_permission_overwrite" class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="serialize_permission_overwrite" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_permission_overwrite" id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_permission_overwrite">serialize_permission_overwrite</a>(
    overwrite: <a href='../channels.html#hikari.channels.PermissionOverwrite'>channel_models.PermissionOverwrite</a>,
) -> Dict[<a href='https://docs.python.org/3/library/stdtypes.html#str'>str</a>, Any]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="serialize_permission_overwrite -- Serialize a permission overwrite object to a json serializable dict …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.serialize_permission_overwrite"
>serialize_permission_overwrite</a></code>
</p>
<p>Serialize a permission overwrite object to a json serializable dict.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>overwrite</code></strong> :&ensp;<code><a href='../channels.html#hikari.channels.PermissionOverwrite'>PermissionOverwrite</a></code></dt>
<dd>The permission overwrite object to serialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The serialized representation of the permission overwrite.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/c8d88c83b926f0874158593f8bc7ba0f580a97d8/hikari/impl/entity_factory.py#L474-L482" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def serialize_permission_overwrite(self, overwrite: channel_models.PermissionOverwrite) -&gt; data_binding.JSONObject:
    # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
    # allow and deny can be strings instead now.
    return {
        &#34;id&#34;: str(overwrite.id),
        &#34;type&#34;: overwrite.type,
        &#34;allow&#34;: str(int(overwrite.allow)),
        &#34;deny&#34;: str(int(overwrite.deny)),
    }</code></pre>
</details>
</dd>
<div class="sep"></div>
</dl>
<div class="sep"></div>
</dd>
</dl>
</section>
</div>
</div>
</div>
<!-- Search script and dependencies -->
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../search.html#' + encodeURIComponent(query);
window.location.href = url;
};
</script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>